<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>QTools: QCalc Programmer&#39;s Calculator</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="ql.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
  <a title="Quantum Leaps: Modern Embedded Software" href="https://www.state-machine.com">
    <img id="logo" src="img/logo_ql.png" alt="Quantum Leaps">
  </a>
  <span id="projectname">QTools</span>
  <span id="projectnumber">6.9.3</span>
           <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)"
               onblur="searchBox.OnSearchFieldFocus(false)"
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;"
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('qcalc.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0"
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">QCalc Programmer's Calculator </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#qcalc_usage">QCalc Usage</a><ul><li class="level2"><a href="#qcalc_win">QCalc on Windows</a></li>
</ul>
</li>
<li class="level1"><a href="#qcalc_features">QCalc Features</a><ul><li class="level2"><a href="#qcalc_expr">Expressions in C-Syntax</a></li>
<li class="level2"><a href="#qcalc_conv">Automatic Conversion to Hexadecimal and Binary</a></li>
<li class="level2"><a href="#qcalc_base">Hexadecimal and Binary Numbers</a></li>
<li class="level2"><a href="#qcalc_hist">History of Inputs</a></li>
<li class="level2"><a href="#qcalc_ans">The ans Variable</a></li>
<li class="level2"><a href="#qcalc_64bit">64-bit Range</a></li>
<li class="level2"><a href="#qcalc_error">Error handling</a></li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><p><b>QCalc</b> is a powerful, cross-platform calculator specifically designed for embedded systems programmers. The calculator accepts <em>whole expressions</em> in the <a class="el" href="qcalc.html#qcalc_expr">C-syntax</a> and displays results simultaneously in decimal, hexadecimal, and binary without the need to explicitly convert the result to these bases. </p>
<div class="image">
<img src="qcalc.png" alt=""/>
<div class="caption">
QCalc user interface</div></div>
<dl class="section note"><dt>Note</dt><dd>The calculator is a console application, where you can type <b>complete C expressions</b>. You can also <b>copy-and-paste</b> expressions into and from the calculator console to use them almost directly in <b>your C code</b>.</dd></dl>
<h1><a class="anchor" id="qcalc_usage"></a>
QCalc Usage</h1>
<p><b>QCalc</b> is included in the QTools Collection in the sub-directory <span class="img folder">qtools/qcalc/</span> and consists of a single file <b>qcalc.py</b>. To launch QCalc, you need to open this file with <span class="img file_py">python</span>.</p>
<p>You use QCalc by typing (or pasting) an expression at the <code>&gt;</code> prompt and pressing <span class="img key_ret">Enter</span> to evaluate the expression. You can conveniently edit any expression already inside the <em>user input</em> field, and you can recall the previous expressions by means of the <span class="img key_up">Up</span> and <span class="img key_down">Down</span> keys.</p>
<dl class="section note"><dt>Note</dt><dd>You <b>quit</b> the calculator by <span class="img key_ret">Enter</span> without entering an expression.</dd></dl>
<h2><a class="anchor" id="qcalc_win"></a>
QCalc on Windows</h2>
<p>The <span class="img file_py">python</span> interpreter is included in the QTools collection for Windows. The <code>QTOOLS%\bin</code> directory contains also the <code>qcalc.bat</code> batch file and a shortcut <span class="img file_py">qcalc</span>, which you can copy to your desktop:</p>
<div class="image">
<img src="qcalc_lnk.png" alt=""/>
<div class="caption">
Shortcut for launching QCalc</div></div>
<h1><a class="anchor" id="qcalc_features"></a>
QCalc Features</h1>
<h2><a class="anchor" id="qcalc_expr"></a>
Expressions in C-Syntax</h2>
<p>The most important feature of QCalc is that it accepts expressions in the <b>C-syntax</b> &ndash; with the same operands and precedence rules as in the C or C++ source code. Among others, the expressions can contain all bit-wise operators (<code>&lt;&lt;</code>, <code>&gt;&gt;</code>, <code>|</code>, <code>&amp;</code>, <code>^</code>, <code>~</code>) as well as mixed decimal, <b>hexadecimal</b> and even binary constants. QCalc is also a powerful floating-point scientific calculator and supports all mathematical functions (<code>sin()</code>, <code>cos()</code>, <code>tan()</code>, <code>exp()</code>, <code>ln()</code>, ...). Some examples of acceptable expressions are:</p>
<p><code>((0xBEEF &lt;&lt; 16) | 1280) &amp; ~0xFF</code> &ndash; binary operators, mixed hex and decimal numbers<br  />
<code>($1011 &lt;&lt; 24) | (1280 &gt;&gt; 8) ^ 0xFFF0</code> &ndash; mixed binary, dec and hex numbers<br  />
<code>(1234 % 55) + 4321//33</code> &ndash; remainder, integer division (note the <code>//</code> integer division operator<br  />
<code>pi/6</code> &ndash; pi-constant<br  />
<code>pow(sin(ans),2) + pow(cos(ans),2)</code> &ndash; scientific floating-point calculations, <a class="el" href="qcalc.html#qcalc_ans">ans-variable</a><br  />
</p>
<dl class="section note"><dt>Note</dt><dd>QCalc internally uses the Python command <b>eval</b> to evaluate the expressions. Please refer to the documentation of the <a href="https://en.wikibooks.org/wiki/Python_Programming/Basic_Math" target="_blank" class="extern">Python math expressions</a> for more details of supported syntax and features.</dd></dl>
<h2><a class="anchor" id="qcalc_conv"></a>
Automatic Conversion to Hexadecimal and Binary</h2>
<p>If the result of expression evaluation is integer (as opposed to floating point), QCalc automatically displays the result in hexadecimal and binary formats (see QCalc screenshot). For better readability the hex display shows an apostrophe between the two 16-bit half-words (e.g., <code>0xDEAD'BEEF</code>). Similarly, the binary output shows an apostrophe between the four 8-bit bytes (e.g., <code>0b11011110'10101101'10111110'11101111</code>).</p>
<h2><a class="anchor" id="qcalc_base"></a>
Hexadecimal and Binary Numbers</h2>
<p>As the extension to the C-syntax, QCalc supports both <b>hexadecimal numbers</b> and <b>binary numbers</b>. These numbers are represented as <code>0x...</code> and<code>0b...</code>, respectively, and can be mixed into expressions. Here are a few examples of such expressions:</p>
<pre class="fragment">(0b0110011 &lt;&lt; 14) &amp; 0xDEADBEEF
(0b0010 | 0b10000) * 123
</pre><h2><a class="anchor" id="qcalc_hist"></a>
History of Inputs</h2>
<p>As a console application QCalc "remembers" the history of the recently entered expressions. You can recall and navigate the history of previously entered expressions by pressing the <span class="img key_up">Up</span> / <span class="img key_down">Down</span> keys.</p>
<h2><a class="anchor" id="qcalc_ans"></a>
The ans Variable</h2>
<p>QCalc stores the result of the last computation in the <code>ans</code> variable. Here are some examples of expressions with the <code>ans</code> variable:</p>
<p><code>1/ans</code> &ndash; find the inverse of the last computation<br  />
<code>log(ans)/log(2)</code> &ndash; find log-base-2 of the last computation<br  />
</p>
<h2><a class="anchor" id="qcalc_64bit"></a>
64-bit Range</h2>
<p>QCalc supports the 64-bit range and switches to 64-bit arithmetic automatically when an <b>integer</b> result of a computation exceeds the 32-bit range. Here are some examples of the 64-bit output:</p>
<pre class="fragment">&gt; 0xDEADBEEF &lt;&lt; 27
= 501427843159293952 | 0x06F5'6DF7'7800'0000
= 0b00000110'11110101'01101101'11110111'01111000'00000000'00000000'00000000
&gt; 0xDEADBEEF &lt;&lt; 24
= 62678480394911744 | 0x00DE'ADBE'EF00'0000
= 0b00000000'11011110'10101101'10111110'11101111'00000000'00000000'00000000
&gt; 0xDEADBEEF &lt;&lt; 34
! out of range
&gt;
</pre><h2><a class="anchor" id="qcalc_error"></a>
Error handling</h2>
<p>Expressions that you enter into QCalc might have all kinds of errors: syntax errors, computation errors (e.g., division by zero), etc. In all these cases, QCalc responds with the <code>Error</code> message and the explanation of the error:</p>
<pre class="fragment">&gt; (2*4) + )
Traceback (most recent call last):
  File "C:\qp\qtools\qcalc\qcalc.py", line 54, in _main
    result = eval(expr)
  File "&lt;string&gt;", line 1
    (2*4) + )
            ^
SyntaxError: unmatched ')'
&gt;
</pre><hr  />
<p><b>Next:</b> <a class="el" href="qfsgen.html">QFSGen ROM File-System Generator</a></p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
    <div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
      <ul>
        <li class="footer">
<a title="Quantum Leaps: Modern Embedded Software" href="https://www.state-machine.com">&copy; 2005-2021 Quantum Leaps</a> &nbsp;| &nbsp; <a title="help" href="help.html">Using Online Help</a>&nbsp;| &nbsp;<a title="Doxygen" href="http://www.doxygen.nl">Generated with Doxygen</a>&nbsp; | &nbsp;<b>QTools 6.9.3</b>
<hr class="footer"/><address class="footer"><small>
<a title="Quantum Leaps: Modern Embedded Software" href="https://www.state-machine.com">&copy; Quantum Leaps 2020</a> &nbsp;| &nbsp; <a title="help" href="help.html">Using Online Help</a>&nbsp;| &nbsp;<a title="Doxygen" href="http://www.doxygen.nl">Generated with Doxygen</a>&nbsp; | &nbsp;<b>QTools 6.9.3</b>
</small></address>
        </li>
      </ul>
    </div>
    <script src="custom.js"></script>
  </body>
</html>
