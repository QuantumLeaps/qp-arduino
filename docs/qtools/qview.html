<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>QTools: QView&trade; Visualization &amp; Monitoring</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="ql.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
  <a title="Quantum Leaps: Modern Embedded Software" href="https://www.state-machine.com">
    <img id="logo" src="img/logo_ql.png" alt="Quantum Leaps">
  </a>
  <span id="projectname">QTools</span>
  <span id="projectnumber">6.9.3</span>
           <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)"
               onblur="searchBox.OnSearchFieldFocus(false)"
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;"
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('qview.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0"
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">QView&trade; Visualization &amp; Monitoring </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><img src="qview_banner.jpg" alt="" class="inline"/></p>
<p><a class="el" href="qview_ui.html">&#160;</a> <a class="el" href="qview_cust.html">&#160;</a></p>
<h1><a class="anchor" id="qview_about"></a>
About QView™</h1>
<p>
<img style="float:right; margin:10px 8px 8px 15px; clear:right;" src="img/logo_python3.gif" title="Python3">
</p>
<p>QView&trade; is a powerful <b>Visualization and Monitoring</b> facility, which allows embedded developers to rapidly create <b>remote graphical user-interfaces</b> to monitor and control their embedded devices from a host (desktop) computer. The interfaces created by QView&trade; can visualize the tracing data produced by <a class="el" href="qpspy.html">QP/Spy</a> and can also <b>interact with the target</b> by sending commands and injecting events to the embedded target. </p>
<p>As you can see in the screen shots below, a QView&trade; user interface consists of the text box with extensible menus plus a <b>customizable canvas</b> that can serve as a remote graphical user-interface to your embedded device. The canvas can contain various "widgets", such as buttons, sliders, guages, graphs, animations etc. The actual functionality of the <em>virtual GUI</em> obviously depends on the target system and the embedded code it is running. Therefore, the QView&trade; provides only a skeleton, which is then <a class="el" href="qview_cust.html">customized</a> by user-supplied scripts written in <a href="https://www.python.org" class="extern"><b>Python</b></a> (version 3).</p>
<div style="clear:both;"></div><div class="image">
<img src="qview_ex.gif" alt=""/>
<div class="caption">
Example of a QView&trade; session on an embedded board (Windows host)</div></div>
<p><br  />
</p><div class="image">
<img src="qview_dpp-fedora.gif" alt=""/>
<div class="caption">
Example of a QView&trade; session (Linux host)</div></div>
<h2><a class="anchor" id="qview_special"></a>
What's Special About It?</h2>
<p>QView&trade; has been specifically designed for extensibility, so that you can quickly <a class="el" href="qview_cust.html">customize its GUI and behavior</a> to your specific embedded project, so that you can use QView&trade; as a powerful custom Human-Machine Interface (HMI) for your projects. The cusomization is accomplished in <a href="https://www.python.org" class="extern"><b>Python</b></a> (version 3), which means that it is naturally platform-neutral and runs without any changes on Windows, Linux, or macOS.</p>
<p>Out of the box, QView&trade; supports the following <a class="el" href="qview_ui.html">commands</a> (<b>NOTE:</b> This basic functionality can be extended in the <a class="el" href="qview_cust.html">QView&trade; customization</a>):</p>
<ul>
<li>Set <a class="el" href="qs.html#qs_global">global QS filters</a> inside the Target</li>
<li>Set <a class="el" href="qs.html#qs_local">local QS filters</a> inside the Target</li>
<li>Inject an arbitrary event to the Target (direct post or publish)</li>
<li>Execute a user-defined command function inside the Target with arguments supplied from QView&trade;</li>
<li>Peek data inside the Target and send to QView&trade;</li>
<li>Poke data (supplied from QView&trade;) into the Target</li>
<li>Execute clock tick inside the Target</li>
<li>Remotely reset the Target</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>A visualization and monitoring system like QView&trade; can be used in all stages of development, manufacturing, and after the deployment, for in-field servicing of embedded devices.</dd></dl>
<h1><a class="anchor" id="qview_struct"></a>
QView™ Structure</h1>
<p>The sequence diagram below shows the general structure of QView&trade;. The embedded Target is running an instrumented code that communicates with the <a class="el" href="qspy.html">QSPY Host application</a> over the <a class="el" href="qspy.html#qspy_link">Target data link</a> (<span style="color:red"><b>red arrows</b></span>). This communication is based on the <a class="el" href="qpspy_proto.html">QP/Spy Protocol</a>.</p>
<dl class="section attention"><dt>Attention</dt><dd>The Target must be running the "Spy" build configuration, in which the <a class="el" href="qpspy.html">QP/Spy&trade; Software Tracing</a> is enabled. Additionally, the QP/Spy implementation in the Target must support the <a class="el" href="qpspy.html#qpspy_rx">bi-directional</a> communication with <a class="el" href="qspy.html">QSPY</a>.</dd></dl>
<p>The QView&trade; (Python script) attaches to the QSPY host application by means of the <a class="el" href="qspy_udp.html">UDP socket</a> that QSPY opens specifically for attaching various "front-ends". This communication (<span style="color:blue"><b>blue arrows</b></span>) uses the same packet structure as the <a class="el" href="qpspy_proto.html">QP/Spy Protocol</a>, but without the HDLC framing, without transparency (escaping), and without the checksum.</p>
<div class="image">
<img src="qspy_qview.gif" alt=""/>
<div class="caption">
Communication between Target, QSPY, and QView</div></div>
<dl class="tag">
<dt>A</dt>
<dd><p class="startdd">A Target produces QS trace records, which the <a class="el" href="qspy.html">QSPY Back-End</a> forwards to the <a class="el" href="qpspy.html#qpspy_udp">UDP Socket</a>, so that any attached Front-End (such as QView&trade;) receives all this data. </p>
<p class="enddd"></p>
</dd>
<dt>B</dt>
<dd><p class="startdd">The Front-End (QView&trade;) sends commands as <a class="el" href="qpspy.html#qpspy_udp">UDP packets to QSPY</a>. For some of those packets, the <a class="el" href="qspy.html">QSPY Back-End</a> supplies additional information (e.g., translation between symbolic names and binary addresses according to the <a class="el" href="qs.html#qs_dict">QS dictionaries</a> collected from the Target). </p>
<p class="enddd"></p>
</dd>
<dt>C</dt>
<dd>The <a class="el" href="qspy.html">QSPY Back-End</a> then forwards the modified packets to the Target.  </dd>
</dl>
<div style="clear:both;"></div><dl class="section remark"><dt>Remarks</dt><dd><b>Why UDP?</b> The <a class="el" href="qspy_udp.html">communication between QSPY and QView</a> is based on UDP, because UDP is inherently packet-oriented (as opposed to TCP, which is stream-oriented) and preserves the <em>packet boundaries</em>.</dd></dl>
<h1><a class="anchor" id="qview_use"></a>
Installation &amp; Use</h1>
<p>The <span class="img file_py"><a class="el" href="qview_8py.html">qview.py</a></span> script can be used standalone, without any installation in your Python system (see <a class="el" href="qview.html#qview_run">Running QView&trade;</a> below).</p>
<dl class="section note"><dt>Note</dt><dd>The <span class="img file_py"><a class="el" href="qview_8py.html">qview.py</a></span> script is included in the <a class="el" href="index.html#qtools_about">QTools&trade; collection</a>. Also, the <a class="el" href="index.html#qtools_win">QTools&trade; collection for Windows</a> already includes Python (3.8), so you don't need to install anything extra.</dd></dl>
<p>Alternatively, you can use *your own Python** installation, into which you can install the latest QView&trade; with <code>pip</code> from the <a href="https://pypi.org/project/qview/"><b>PyPi index</b></a> by executing the following command:</p>
<pre class="fragment">pip install qview
</pre><h2><a class="anchor" id="qview_run"></a>
Running QView™</h2>
<p>If you are using QView&trade; as a standalone Python script, you invoke it as follows:</p>
<pre class="fragment">python3 &lt;path-to-qview-script&gt;/qview.py [&lt;cust_script&gt; [&lt;qspy_host&gt; [&lt;qspy_port&gt;]]]
</pre><p>Alternatively, if you've installed QView&trade; with <code>pip</code>, you invoke it as follows:</p>
<pre class="fragment">qview [cust_script] [qspy_host[:udp_port]] [local_port]
</pre><h2><a class="anchor" id="qview_command"></a>
Command-line Options</h2>
<ul>
<li><code>cust_script</code> - optional <a class="el" href="qview_cust.html">customization Python script</a> for your specific target system. If not specified, qview will provide only the <a class="el" href="qview_ui.html">generic user interface</a> for interacting with the target (e.g., reset, setting QS filters, posting events, etc.)</li>
<li><code>qspy_host[:udp_port]</code> - optional host-name/IP-address:port for the host running the QSPY host utility. If not specified, the default is 'localhost:7701'.</li>
<li><code>local_port</code> - optional the local UDP port to be used by "qview". If not specified, the default is '0', which means that the operating system will choose an open port.</li>
</ul>
<h2><a class="anchor" id="qview_exa"></a>
Examples</h2>
<p><span class="logo logo_win">Windows Hosts</span></p>
<pre class="fragment">python3 %QTOOLS%\qview\qview.py
</pre><p>opens the generic (not customized) "qview".</p>
<pre class="fragment">python3 %QTOOLS%\qview\qview.py dpp.py
</pre><p>opens "qview" with the customization provided in the dpp.py script located in the current directory.</p>
<pre class="fragment">qview ..\qview\dpp.py localhost:7701
</pre><p>opens "qview" (<b>installed with pip</b>) with the customization provided in the dpp.py script located in the directory ..\qview. The "qview" will attach to the QSPY utility running at localhost:7701.</p>
<pre class="fragment">qview dpp.py 192.168.1.100:7705
</pre><p>opens "qview" (<b>installed with pip</b>) with the customization provided in the dpp.py script located in the current directory. The "qview" will attach to the QSPY utility running remotely at IP address 192.168.1.100:7705.</p>
<p><span class="logo logo_linux"></span><span class="logo logo_macos">Linux/MacOS Hosts</span></p>
<pre class="fragment">python3 $(QTOOLS)/qview/qview.py
</pre><p>opens the generic (not customized) "qview".</p>
<pre class="fragment">python3 $(QTOOLS)/qview/qview.py dpp.py
</pre><p>opens "qview" with the customization provided in the dpp.py script located in the current directory.</p>
<pre class="fragment">qview *.py ../qview/dpp.py localhost:7701
</pre><p>opens "qview" (<b>installed with pip</b>) with the customization provided in the dpp.py script located in the directory ../qview. The "qview" will attach to the QSPY utility running at localhost:7701.</p>
<pre class="fragment">qview dpp.py 192.168.1.100:7705
</pre><p>opens "qview" (<b>installed with pip</b>) with the customization provided in the dpp.py script located in the current directory. The "qview" will attach to the QSPY utility running remotely at IP address 192.168.1.100:7705.</p>
<dl class="section note"><dt>Note</dt><dd>In practice, the easiest way to launch QView&trade; is to define a <b>shortcut</b>, like the one provided with the DPP example:<br  />
<br  />
<div class="image">
<img src="qview_shortcut.gif" alt=""/>
<div class="caption">
qview shortcut properties</div></div>
</dd></dl>
<h1><a class="anchor" id="qview_attaching"></a>
Attaching QView to QSPY</h1>
<p>In contrast to TCP, which is stream-oriented, UDP is packet-oriented, so the only way to "attach" two ends of communication is to exchange packets. Consequently, immediately after QView&trade; is launched, it tries to <b>attach</b> by sending the <a class="el" href="qspy_udp.html#udp_ATTACH">ATTACH</a> packet to QSPY. If QSPY responds with the ATTACH response, QView&trade; considers that it is "attached".</p>
<p>However, if the ATTACH response does not arrive within a second or two (because perhaps QSPY is not running), QView&trade; opens a modal dialog box that reminds you to run QSPY, as shown in the screen-shot below:</p>
<div class="image">
<img src="qview_attach.gif" alt=""/>
<div class="caption">
Attach to QSPY dialog box</div></div>
<p> qview_before.gif Depending how you start <a class="el" href="qspy.html">QSPY</a>, the dialog box might close automatically, which means that QView has successfully <b>attached</b> to QSPY. However, if the dialog box does not close, you need to click the <b>Attach</b> button to send <a class="el" href="qspy_udp.html#udp_ATTACH">ATTACH</a> packet to QSPY, until QView&trade; receives the ATTACH response from QSPY. If you can't "attach", you can click the <b>Close</b> button to close QView&trade;.</p>
<dl class="section note"><dt>Note</dt><dd>Because UDP works over networks, the QSPY Back-End can run on a <b>different machine</b> (e.g., a lab computer) that the the QView&trade; Front-End (e.g., office computer). These two machines can even run different operating systems, for example Linux on the lab computer and Windows in the office, or vice versa. All you need to do is to provide the host-name parameter as the <em>third</em> command-line argument to the <span class="img file_py"><a class="el" href="qview_8py.html">qview.py</a></span> script (e.g., <code>python3 <a class="el" href="qview_8py.html">qview.py</a> dpp.py 192.168.1.101</code>).</dd></dl>
<h2><a class="anchor" id="qview_tstamp"></a>
Recognizing the Target</h2>
<p>Before QView&trade; can correctly interpret any data from the Target, it needs to obtain certain information about the Target, such as the sizes of object pointers, function pointers, event signals, etc. This information is provided in the <a class="el" href="qs__copy_8h.html#acdb495c1e5524b5d95aaff82c47f6db5a6a73ed1da89600585ca91b5572941ea4" title="reports the Target information">QS_TARGET_INFO</a> trace record coming from the Target.</p>
<p>To inform you about the Target status, QView&trade; displays the <b>Target: UNKNOWN</b> in the status bar when the target is "unknown":</p>
<div class="image">
<img src="qview_unknown.gif" alt=""/>
<div class="caption">
Target UNKNOWN status</div></div>
<p>If this happens, you can explicitly request the Target information by means of the "Commands-&gt;Query Target Info" menu:</p>
<div class="image">
<img src="qview_known.gif" alt=""/>
<div class="caption">
Target KNOWN status (build time-stamp)</div></div>
<p>After the Target information is received, the QView&trade; status bar shows the build time-stamp of the Target image.</p>
<hr  />
<p><b>Next:</b> <a class="el" href="qview_ui.html">QView User Interface</a></p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
    <div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
      <ul>
        <li class="footer">
<a title="Quantum Leaps: Modern Embedded Software" href="https://www.state-machine.com">&copy; 2005-2021 Quantum Leaps</a> &nbsp;| &nbsp; <a title="help" href="help.html">Using Online Help</a>&nbsp;| &nbsp;<a title="Doxygen" href="http://www.doxygen.nl">Generated with Doxygen</a>&nbsp; | &nbsp;<b>QTools 6.9.3</b>
<hr class="footer"/><address class="footer"><small>
<a title="Quantum Leaps: Modern Embedded Software" href="https://www.state-machine.com">&copy; Quantum Leaps 2020</a> &nbsp;| &nbsp; <a title="help" href="help.html">Using Online Help</a>&nbsp;| &nbsp;<a title="Doxygen" href="http://www.doxygen.nl">Generated with Doxygen</a>&nbsp; | &nbsp;<b>QTools 6.9.3</b>
</small></address>
        </li>
      </ul>
    </div>
    <script src="custom.js"></script>
  </body>
</html>
