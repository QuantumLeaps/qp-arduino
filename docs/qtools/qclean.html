<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>QTools: QClean Code Whitespace Cleanup</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="ql.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
  <a title="Quantum Leaps: Modern Embedded Software" href="https://www.state-machine.com">
    <img id="logo" src="img/logo_ql.png" alt="Quantum Leaps">
  </a>
  <span id="projectname">QTools</span>
  <span id="projectnumber">6.9.3</span>
           <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)"
               onblur="searchBox.OnSearchFieldFocus(false)"
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;"
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('qclean.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0"
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">QClean Code Whitespace Cleanup </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#qclean_usage">QClean Usage</a><ul><li class="level2"><a href="#qclean_command">QClean Command-Line Parameters</a></li>
</ul>
</li>
<li class="level1"><a href="#qclean_features">QClean Features</a><ul><li class="level2"><a href="#qclean_files">QClean File Types</a></li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><p>Many programmers pay little attention to the <b>whitespace</b> in their source code, such as spaces, tabs, new-lines, etc. The common thinking is that compilers (C, C++, etc.) ignore whitespace anyway, so why bother? But, as a <em>professional</em> software developer you should not ignore whitespace, because it can cause all sorts of problems, some of them illustrated in the figure below: </p>
<div class="image">
<img src="qclean_dirty.png" alt=""/>
<div class="caption">
Examples of problematic whitespace in source code</div></div>
<ul class="tag">
<li>
<span class="tag" style="background-color:#f00;">1</span> Trailing whitespace after the last printable character in line can cause <b>bugs</b>. For example, trailing whitespace after the C/C++ macro-continuation character <b>'\'</b> can confuse the C pre-processor and can result in a <b>program error</b>, as indicated by the <span class="img bug">bug icons</span>.  </li>
<li>
<span class="tag" style="background-color:#f40;">2</span> Similarly, inconsistent use of <a href="https://en.wikipedia.org/wiki/Newline" target="_blank" class="extern">End-Of-Line (EOL) convention</a> can cause <b>bugs</b>. For example, mixing the DOS EOL Convention (0x0D,0x0A) with Unix EOL Convention (0x0A) can confuse the C pre-processor and can result in a <b>program error</b>, as indicated by the <span class="img bug">bug icons</span>.  </li>
<li>
<span class="tag" style="background-color:#00f;">3</span> Inconsistent use of tabs and spaces can cause unnecessary churn in the version control system (VCS) in source files that otherwise should be identical. Also inconsistent use of whitespace can lead to different rendering of the source code by different editors and printers.  </li>
</ul>
<dl class="section attention"><dt>Attention</dt><dd>The problems caused by whitespace in the source code are particularly insidious, because you <b>don't see</b> the culprit. By using an <b>automated</b> whitespace cleanup utility you can save yourself hours of frustration and significantly improve your code quality.</dd></dl>
<h1>QClean Source Code Cleanup Utility</h1>
<p><b>QClean</b> is a simple and blazingly fast command-line utility to <b>automatically clean whitespace</b> in your source code. QClean is deployed as natively compiled executable and is located in the sub-directory <span class="img folder">qtools/bin/</span>. QClean is available in portable source code and can be compiled on all desktop platforms (Windows and POSIX &ndash; Linux, macOS...).</p>
<dl class="section attention"><dt>Attention</dt><dd>QClean is very simple to use (no parameters are needed in most cases) and is blazingly fast (it can easily cleanup hundreds of files per second). All this is designed so that you can use QClean frequently. In fact, the use of QClean after editing your code should become part of your <b>basic hygiene</b>&ndash;like washing hands after going to the bathroom.</dd></dl>
<h1><a class="anchor" id="qclean_usage"></a>
QClean Usage</h1>
<p>Typically, you invoke QClean from a command-line prompt without any parameters. In that case, QClean will cleanup white space in the current directory and <b>recursively</b> in all its sub-directories.</p>
<dl class="section note"><dt>Note</dt><dd>If you have added the <span class="img folder">qtools/bin/</span> directory to your <code>PATH</code> environment variable (see Installing QTools), you can run <code>qclean</code> directly from your terminal window.</dd></dl>
<div class="image">
<img src="qclean_run.png" alt=""/>
<div class="caption">
Example run of the QClean utility</div></div>
<p>As you can see in the screen shot above, QClean processes the files and prints out the names of the cleaned up files. Also, you get information as to what has been cleaned, for example, "Trail-WS" means that trailing whitespace has been cleaned up. Other possibilities are: "CR" (cleaned up DOS/Windows (CR) end-of-lines), "LF" (cleaned up Unix (LF) end-of-lines), and "Tabs" (replaced Tabs with spaces).</p>
<h2><a class="anchor" id="qclean_command"></a>
QClean Command-Line Parameters</h2>
<p>QClean takes the following command-line parameters:</p>
<center> <table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">PARAMETER   </th><th class="markdownTableHeadLeft">DEFAULT   </th><th class="markdownTableHeadLeft">COMMENT    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>[root-dir]</code>   </td><td class="markdownTableBodyLeft"><code>.</code>   </td><td class="markdownTableBodyLeft">root directory to clean (relative or absolute)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">OPTIONS   </td><td class="markdownTableBodyLeft">&#160;   </td><td class="markdownTableBodyLeft">&#160;    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>-h</code>   </td><td class="markdownTableBodyLeft">&#160;   </td><td class="markdownTableBodyLeft">help (show help message and exit)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>-q</code>   </td><td class="markdownTableBodyLeft">&#160;   </td><td class="markdownTableBodyLeft">query only (no cleanup when -q present)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>-r</code>   </td><td class="markdownTableBodyLeft">&#160;   </td><td class="markdownTableBodyLeft">check also read-only files    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>-l[limit]</code>   </td><td class="markdownTableBodyLeft">80   </td><td class="markdownTableBodyLeft">line length limit (not checked when -l absent)   </td></tr>
</table>
</center><h1><a class="anchor" id="qclean_features"></a>
QClean Features</h1>
<p>QClean fixes the following whitespace problems:</p>
<ul>
<li>removing of all trailing whitespace (see figure above <span class="ref" style="background-color:#f00;">1</span>)</li>
<li>applying consistent End-Of-Line convention (either Unix (LF) or DOS (CRLF) see figure above <span class="ref" style="background-color:#f40;">2</span>)</li>
<li>replacing Tabs with spaces (untabify, see figure above <span class="ref" style="background-color:#00f;">2</span>)</li>
<li>optionally, scan the source code for long lines exceeding the specified limit (<code>-l</code> option, default 80 characters per line).</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>QClean can optionally check the code for <b>long lines of code</b> that exceed a specified limit (80 characters by default) to reduce the need to either wrap the long lines (which destroys indentation), or the need to scroll the text horizontally. (All GUI usability guidelines universally agree that horizontal scrolling of text is always a bad idea.) In practice, the source code is very often copied-and-pasted and then modified, rather than created from scratch. For this style of editing, it’s very advantageous to see simultaneously and side-by-side both the original and the modified copy. Also, differencing the code is a routinely performed action of any VCS (Version Control System) whenever you check-in or merge the code. Limiting the line length allows to use the horizontal screen real estate much more efficiently for side-by-side-oriented text windows instead of much less convenient and error-prone top-to-bottom differencing.</dd></dl>
<h2><a class="anchor" id="qclean_files"></a>
QClean File Types</h2>
<p>QClean applies the following rules for cleaning the whitespace depending on the file types:</p>
<center> <table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">FILE TYPE   </th><th class="markdownTableHeadLeft">END-OF-LINE   </th><th class="markdownTableHeadCenter">TRAILING WS   </th><th class="markdownTableHeadCenter">TABS   </th><th class="markdownTableHeadCenter">LONG-LINES    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>.c</code>   </td><td class="markdownTableBodyLeft">Unix (LF)   </td><td class="markdownTableBodyCenter">remove   </td><td class="markdownTableBodyCenter">remove   </td><td class="markdownTableBodyCenter">check    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>.h</code>   </td><td class="markdownTableBodyLeft">Unix (LF)   </td><td class="markdownTableBodyCenter">remove   </td><td class="markdownTableBodyCenter">remove   </td><td class="markdownTableBodyCenter">check    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>.cpp</code>   </td><td class="markdownTableBodyLeft">Unix (LF)   </td><td class="markdownTableBodyCenter">remove   </td><td class="markdownTableBodyCenter">remove   </td><td class="markdownTableBodyCenter">check    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>.hpp</code>   </td><td class="markdownTableBodyLeft">Unix (LF)   </td><td class="markdownTableBodyCenter">remove   </td><td class="markdownTableBodyCenter">remove   </td><td class="markdownTableBodyCenter">check    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>.s</code>   </td><td class="markdownTableBodyLeft">Unix (LF)   </td><td class="markdownTableBodyCenter">remove   </td><td class="markdownTableBodyCenter">remove   </td><td class="markdownTableBodyCenter">check    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>.asm</code>   </td><td class="markdownTableBodyLeft">Unix (LF)   </td><td class="markdownTableBodyCenter">remove   </td><td class="markdownTableBodyCenter">remove   </td><td class="markdownTableBodyCenter">check    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>.lnt</code>   </td><td class="markdownTableBodyLeft">Unix (LF)   </td><td class="markdownTableBodyCenter">remove   </td><td class="markdownTableBodyCenter">remove   </td><td class="markdownTableBodyCenter">check    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>.txt</code>   </td><td class="markdownTableBodyLeft">DOS (CR,LF)   </td><td class="markdownTableBodyCenter">remove   </td><td class="markdownTableBodyCenter">remove   </td><td class="markdownTableBodyCenter">don't check    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>.md</code>   </td><td class="markdownTableBodyLeft">DOS (CR,LF)   </td><td class="markdownTableBodyCenter">remove   </td><td class="markdownTableBodyCenter">remove   </td><td class="markdownTableBodyCenter">don't check    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>.bat</code>   </td><td class="markdownTableBodyLeft">DOS (CR,LF)   </td><td class="markdownTableBodyCenter">remove   </td><td class="markdownTableBodyCenter">remove   </td><td class="markdownTableBodyCenter">don't check    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>.ld</code>   </td><td class="markdownTableBodyLeft">Unix (LF)   </td><td class="markdownTableBodyCenter">remove   </td><td class="markdownTableBodyCenter">remove   </td><td class="markdownTableBodyCenter">check    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>.py</code>   </td><td class="markdownTableBodyLeft">Unix (LF)   </td><td class="markdownTableBodyCenter">remove   </td><td class="markdownTableBodyCenter">remove   </td><td class="markdownTableBodyCenter">check    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>.pyw</code>   </td><td class="markdownTableBodyLeft">Unix (LF)   </td><td class="markdownTableBodyCenter">remove   </td><td class="markdownTableBodyCenter">remove   </td><td class="markdownTableBodyCenter">check    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>.tcl</code>   </td><td class="markdownTableBodyLeft">Unix (LF)   </td><td class="markdownTableBodyCenter">remove   </td><td class="markdownTableBodyCenter">remove   </td><td class="markdownTableBodyCenter">check    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>.java</code>   </td><td class="markdownTableBodyLeft">Unix (LF)   </td><td class="markdownTableBodyCenter">remove   </td><td class="markdownTableBodyCenter">remove   </td><td class="markdownTableBodyCenter">check    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>Makefile</code>   </td><td class="markdownTableBodyLeft">Unix (LF)   </td><td class="markdownTableBodyCenter">remove   </td><td class="markdownTableBodyCenter">leave   </td><td class="markdownTableBodyCenter">check    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>.mak</code>   </td><td class="markdownTableBodyLeft">Unix (LF)   </td><td class="markdownTableBodyCenter">remove   </td><td class="markdownTableBodyCenter">leave   </td><td class="markdownTableBodyCenter">check    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>.html</code>   </td><td class="markdownTableBodyLeft">Unix (LF)   </td><td class="markdownTableBodyCenter">remove   </td><td class="markdownTableBodyCenter">remove   </td><td class="markdownTableBodyCenter">don't check    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>.htm</code>   </td><td class="markdownTableBodyLeft">Unix (LF)   </td><td class="markdownTableBodyCenter">remove   </td><td class="markdownTableBodyCenter">remove   </td><td class="markdownTableBodyCenter">don't check    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>.php</code>   </td><td class="markdownTableBodyLeft">Unix (LF)   </td><td class="markdownTableBodyCenter">remove   </td><td class="markdownTableBodyCenter">remove   </td><td class="markdownTableBodyCenter">don't check    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>.dox</code>   </td><td class="markdownTableBodyLeft">Unix (LF)   </td><td class="markdownTableBodyCenter">remove   </td><td class="markdownTableBodyCenter">remove   </td><td class="markdownTableBodyCenter">don't check    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>.m</code>   </td><td class="markdownTableBodyLeft">Unix (LF)   </td><td class="markdownTableBodyCenter">remove   </td><td class="markdownTableBodyCenter">remove   </td><td class="markdownTableBodyCenter">check   </td></tr>
</table>
</center><p><br  />
</p><dl class="section note"><dt>Note</dt><dd>The cleanup rules specified in the table above can be easily customized by editing the array <code>l_fileTypes</code> in the <code>qclean/source/main.c</code> file. Also, you can change the <b>Tab size</b> by modifying the <code>TAB_SIZE</code> constant (currently set to 4) as well as the default <b>line-limit</b> by modifying the <code>LINE_LIMIT</code> constant (currently set to 80) at the top of the the <code>qclean/source/main.c</code> file. Of course, after any such modification, you need to re-build the QClean executable and copy it into the qtools/bin directory.</dd></dl>
<p><br  />
</p><dl class="section attention"><dt>Attention</dt><dd>For best code portability, QClean enforces the consistent use of the specified End-Of-Line convention (typically Unix (LF)), <b>regardless of the native EOL of the platform</b>. The DOS/Windows EOL convention (CR,LF) is typically not applied because it causes compilation problems on Unix-like systems (Specifically, the C preprocessor doesn't correctly parse the multi-line macros.) On the other hand, most DOS/Windows compilers seem to tolerate the Unix EOL convention without problems.</dd></dl>
<hr  />
<p><b>Next:</b> <a class="el" href="qfsgen.html">QFSGen ROM File-System Generator</a></p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
    <div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
      <ul>
        <li class="footer">
<a title="Quantum Leaps: Modern Embedded Software" href="https://www.state-machine.com">&copy; 2005-2021 Quantum Leaps</a> &nbsp;| &nbsp; <a title="help" href="help.html">Using Online Help</a>&nbsp;| &nbsp;<a title="Doxygen" href="http://www.doxygen.nl">Generated with Doxygen</a>&nbsp; | &nbsp;<b>QTools 6.9.3</b>
<hr class="footer"/><address class="footer"><small>
<a title="Quantum Leaps: Modern Embedded Software" href="https://www.state-machine.com">&copy; Quantum Leaps 2020</a> &nbsp;| &nbsp; <a title="help" href="help.html">Using Online Help</a>&nbsp;| &nbsp;<a title="Doxygen" href="http://www.doxygen.nl">Generated with Doxygen</a>&nbsp; | &nbsp;<b>QTools 6.9.3</b>
</small></address>
        </li>
      </ul>
    </div>
    <script src="custom.js"></script>
  </body>
</html>
