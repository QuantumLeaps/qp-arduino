<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>QP/C++: Revision History</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="ql.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
  <a title="Quantum Leaps: Modern Embedded Software" href="https://www.state-machine.com">
    <img id="logo" src="img/logo_ql.png" alt="Quantum Leaps">
  </a>
  <span id="projectname">QP/C++</span>
  <span id="projectnumber">6.9.3</span>
           <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)"
               onblur="searchBox.OnSearchFieldFocus(false)"
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;"
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('history.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0"
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Revision History </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="qpcpp_6_9_3"></a>
Version 6.9.3, 2021-04-12</h1>
<p><b>Feature Requests:</b></p><ul>
<li><a href="https://sourceforge.net/p/qpc/feature-requests/191/">feature#191 "Add QS local filtering to QF_PUBLISH()"</a></li>
</ul>
<p>The feature has been implemented by means of the "sender" parameter of the <code><a class="el" href="qf_8hpp.html#ac809aab93c0c4cb303ecc39b8e3825e2" title="Invoke the event publishing facility QP::QF::publish_(). This macro.">PUBLISH()</a></code> macro, which must now be a pointer to a struct that has the <code>prio</code> member. This design enables applying <a class="el" href="class_q_p_1_1_q_s.html" title="QS logging facilities.">QS</a> local filter to the <code>prio</code> as the QS-Id. This works for publishing events from active objects. For publishing events outside active objects (e.g., from ISRs), the header file <code>qs.h</code> provides a type <code><a class="el" href="struct_q_p_1_1_q_spy_id.html" title="QS ID type for applying local filtering.">QP::QSpyId</a></code>, which should be used to define <a class="el" href="class_q_p_1_1_q_s.html" title="QS logging facilities.">QS</a> ID variables to be used as "sender" in <code><a class="el" href="qf_8hpp.html#ac809aab93c0c4cb303ecc39b8e3825e2" title="Invoke the event publishing facility QP::QF::publish_(). This macro.">PUBLISH()</a></code>.</p>
<dl class="section note"><dt>Note</dt><dd>This change only affects the Spy build configuration, where the <a class="el" href="class_q_p_1_1_q_s.html" title="QS logging facilities.">QS</a> software tracing instrumentation is enabled.</dd></dl>
<ul>
<li><a href="https://sourceforge.net/p/qpc/feature-requests/185/">feature#185 "Add possibility of assigning name to AO threads in QP-RTOS ports"</a></li>
</ul>
<p>This feature request is now implemented uniformely in all QP-ports to 3rd-party RTOSes by means of the generic <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> API <a class="el" href="class_q_p_1_1_q_active.html#a095312061d7fdd412b019495c93c3dd9" title="Generic setting of additional attributes (useful in QP ports)">QP::QActive::setAttr()</a>. Specifically, the <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> port will allow you to set the thread name by calling <a class="el" href="class_q_p_1_1_q_active.html#a095312061d7fdd412b019495c93c3dd9" title="Generic setting of additional attributes (useful in QP ports)">QP::QActive::setAttr()</a> before calling QACTIVE_START().</p>
<p><b>Bug Fixes:</b></p><ul>
<li><a href="https://sourceforge.net/p/qpc/bugs/292/">bug#292 "QP-C-C++ on 64 Bit Linux - Setting of Current-Obj - AO_Obj from QView raises segmentation fault"</a></li>
<li><a href="https://sourceforge.net/p/qpc/bugs/293/">bug#293 "[Qpccp 6.9.2] test of assertion fail now"</a></li>
<li><a href="https://sourceforge.net/p/qpc/bugs/298/">bug#298 "ARM Cortex-M Erratum 838869 Handled Inconsistently in Ports"</a></li>
</ul>
<p><b>Source code changes:</b></p><ul>
<li><code><a class="el" href="qf_8hpp.html" title="QF/C++ platform-independent public interface.">qpcpp/include/qf.hpp</a></code> - feature#191</li>
<li><code><a class="el" href="qs_8hpp.html" title="QS/C++ platform-independent public interface.">qpcpp/include/qs.hpp</a></code> - feature#191</li>
<li><code><a class="el" href="qf__ps_8cpp.html" title="QF/C++ Publish-Subscribe services definitions.">qpcpp/src/qf/qf_ps.cpp</a></code> - feature#191</li>
<li><code><a class="el" href="qs__rx_8cpp.html" title="QS receive channel services.">qpcpp/src/qs/qs_rx.cpp</a></code> - feature#191 and bug#292</li>
</ul>
<p><b>Modified QP/C ports:</b></p><ul>
<li><code>qpcpp/ports/arm-cm/</code> - fixed <a href="https://sourceforge.net/p/qpc/bugs/298/">bug#298</a></li>
<li><code>qpcpp/ports/embos/</code> - implemented <a href="https://sourceforge.net/p/qpc/feature-requests/185/">feature#185</a></li>
<li><code>qpcpp/ports/threadx/</code> - implemented <a href="https://sourceforge.net/p/qpc/feature-requests/185/">feature#185</a></li>
<li><code>qpcpp/ports/ucos2/</code> - implemented <a href="https://sourceforge.net/p/qpc/feature-requests/185/">feature#185</a></li>
<li><code>qpcpp/ports/win32/</code> - added QSpy64 (64-bit) build configuration to the Visual Studio project</li>
<li><code>qpcpp/ports/win32-qv/</code> - added QSpy64 (64-bit) build configuration to the Visual Studio project</li>
<li><code>qpcpp/ports/win32-quit/</code> - added "port" used for "QP Unit Internal Testing" (QUIT)</li>
</ul>
<p><b>Updated examples:</b></p><ul>
<li>all examples using <code><a class="el" href="qf_8hpp.html#ac809aab93c0c4cb303ecc39b8e3825e2" title="Invoke the event publishing facility QP::QF::publish_(). This macro.">PUBLISH()</a></code> - adjusted the <code>sender</code> parameter of the macro to have the <code>prio</code> member</li>
<li><code>qpcpp/examples/arm-cm/</code> - fixed <a href="https://sourceforge.net/p/qpc/bugs/298/">bug#298</a> (added calls to <code>QV|QK|QXK_ARM_ERRATUM_838869()</code>)</li>
<li><code>qpcpp/examples/qutest/self_test/test/</code> - added examples of the Python include files (<code>*.pyi</code>) for the new <a href="https://www.state-machine.com/qtools/namespacequtest__dsl.html">include command</a>.</li>
<li><code>qpcpp/examples/arm-cm/dpp_efm32-slstk3401a/win32-gui/</code> - corrected handling of user-drawn buttons in <code>bsp.cpp</code></li>
<li><code>qpcpp/examples/arm-cm/game_efm32-slstk3401a/win32-gui/</code> - corrected handling of user-drawn buttons in <code>bsp.cpp</code></li>
</ul>
<p><b>Updated 3rd-Party Components:</b></p><ul>
<li><code>qpcpp/3rd_party/threadx</code> to version 6.1.6 (latest open source version from <a href="https://github.com/azure-rtos/threadx">GitHub</a> )</li>
</ul>
<h1><a class="anchor" id="qpcpp_6_9_2"></a>
Version 6.9.2, 2021-01-18</h1>
<p>The main purpose of this release is a redesign of the QS-RX (software tracing input) to implement the feature request #187:</p>
<ul>
<li><a href="https://sourceforge.net/p/qpc/feature-requests/187/">feature#187 "Make the byte order in QS-RX buffer compatible with DMA"</a></li>
</ul>
<p>Additionally, as part of the re-design of the internal QS-RX implementation, this release fixes the bug #287 ("QP::QS::rxGetNfree() returns too low value", see the "Bug Fixes" section)</p>
<p>Additionally, this release introduces a new virtual function <code>getStateHandler()</code> in the <code><a class="el" href="class_q_p_1_1_q_hsm.html" title="Hierarchical State Machine base class.">QHsm</a></code> base class. This is part of the fix for bug #290 ("QView query object state reports wrong state with QMsm strategy", see the "Bug Fixes" section)</p>
<p><b>Source code changes:</b></p>
<p>The introduction of the <code><a class="el" href="class_q_p_1_1_q_hsm.html#a83afb50f27f001dfb73df6e30947e7a7" title="Get the current state handler of the HSM.">QHsm::getStateHandler()</a></code> virtual function involves the following code changes:</p><ul>
<li><code><a class="el" href="qep_8hpp.html" title="QEP/C++ platform-independent public interface.">qpcpp/include/qep.hpp</a></code></li>
<li><code><a class="el" href="qf_8hpp.html" title="QF/C++ platform-independent public interface.">qpcpp/include/qf.hpp</a></code></li>
<li><code><a class="el" href="qep__hsm_8cpp.html" title="QP::QHsm implementation.">qpcpp/src/qf/qep_hsm.cpp</a></code></li>
<li><code><a class="el" href="qep__msm_8cpp.html" title="QP::QMsm implementation.">qpcpp/src/qf/qep_msm.cpp</a></code></li>
<li><code><a class="el" href="qf__qmact_8cpp.html" title="QMActive::QMActive() and virtual functions.">qpcpp/src/qf/qf_qmact.cpp</a></code></li>
<li><code><a class="el" href="qs__rx_8cpp.html" title="QS receive channel services.">qpcpp/src/qs/qs_rx.cpp</a></code></li>
<li><code><a class="el" href="qs_8hpp.html" title="QS/C++ platform-independent public interface.">qpcpp/include/qs.hpp</a></code> file &ndash; added new API <a class="el" href="class_q_p_1_1_q_s.html#ad21c96eb85d33c64a23c3560f0b63cca" title="Query the &quot;current object&quot; in the Target.">QS::queryCurrObj()</a></li>
</ul>
<p>The redesign of QS-RX implementation involves the following code changes:</p><ul>
<li><code><a class="el" href="qs_8hpp.html" title="QS/C++ platform-independent public interface.">qpcpp/include/qs.hpp</a></code> &ndash; inline function <code><a class="el" href="class_q_p_1_1_q_s.html#a4f4b53d7de15843549f8a451b56ec7b1" title="Put one byte into the QS RX lock-free buffer.">QS::rxPut()</a></code> now returns <code>bool</code> (true if the byte was inserted into the QS-RX buffer and false otherwise)</li>
<li><code><a class="el" href="qs__rx_8cpp.html" title="QS receive channel services.">qpcpp/src/qs/qs_rx.cpp</a></code> - changed several functions</li>
<li><code><a class="el" href="qs__fp_8cpp.html" title="QS floating point output implementation.">qpcpp/src/qs/qs_fp.cpp</a></code> - improved implementation</li>
</ul>
<p><b>Modified QP/C++ ports:</b></p><ul>
<li><code>qpcpp/ports/embos/</code> - added missing <code>noexcept</code> specifiers</li>
<li><code>qpcpp/ports/freertos/</code> - added missing <code>noexcept</code> specifiers</li>
<li><code>qpcpp/ports/threadx/</code> - added missing <code>noexcept</code> specifiers</li>
<li><code>qpcpp/ports/ucos-ii/</code> - added missing <code>noexcept</code> specifiers</li>
<li><code>qpcpp/ports/qt/</code> - added missing <code>noexcept</code> specifiers</li>
<li><code>qpcpp/ports/posix/</code> - modified to take advantage of the QS-RX direct byte ordering</li>
<li><code>qpcpp/ports/posix-qutest/</code> - modified to take advantage of the QS-RX direct byte ordering</li>
<li><code>qpcpp/ports/posix-qv/</code> - modified to take advantage of the QS-RX direct byte ordering</li>
<li><code>qpcpp/ports/win32/</code> - modified to take advantage of the QS-RX direct byte ordering</li>
<li><code>qpcpp/ports/win32-qutest/</code> - modified to take advantage of the QS-RX direct byte ordering</li>
<li><code>qpcpp/ports/win32-qv/</code> - modified to take advantage of the QS-RX direct byte ordering</li>
</ul>
<p><b>Updated examples:</b></p><ul>
<li><code>qpcpp/examples/performance/dpp_efm32-slstk3401a</code> - adjusted <code>app_cfg.h</code> file for uC/OS-II</li>
<li><code>qpcpp/examples/workstation/calc</code> fixed minor bug in the calculator</li>
</ul>
<p><b>Bug Fixes:</b></p><ul>
<li><a href="https://sourceforge.net/p/qpc/bugs/291/">bug#291 "QP/C++ ports fail to compile due to missing noexcept specifiers"</a></li>
<li><a href="https://sourceforge.net/p/qpc/bugs/289/">bug#289 "QS_OBJ_PTR() macro does not compile on 64-bit machine"</a></li>
<li><a href="https://sourceforge.net/p/qpc/bugs/288/">bug#288 "POSIX port does not compile in Spy build configuration"</a></li>
<li><a href="https://sourceforge.net/p/qpc/bugs/287/">bug#287 "QS_rxGetNfree() returns too low value"</a></li>
<li><a href="https://sourceforge.net/p/qpc/bugs/285/">bug#285 "QView bug with querying the state of QMsm-type state machines"</a></li>
<li><a href="https://sourceforge.net/p/qpc/bugs/284/">bug#284 "Typo in QM generated headers"</a></li>
</ul>
<p><b>Updated 3rd-Party Components:</b></p><ul>
<li><code>qpcpp/3rd_party/CMSIS</code> to version 5.7.0</li>
<li><code>qpcpp/3rd_party/FreeRTOS</code> to version 10.4.3 (202012LTS released December 2020)</li>
</ul>
<h1><a class="anchor" id="qpcpp_6_9_1"></a>
Version 6.9.1, 2020-09-28</h1>
<p>The main purpose of this release is a redesign of the <a href="https://www.state-machine.com/qtools/qs.html#qs_local"><b>QS Local Filter</b></a> (see also <a href="https://sourceforge.net/p/qpc/feature-requests/127">feature request #127</a>). This new design supports filtering on <b>multiple</b> active objects (as well as other objects in the Target memory), as opposed to filtering just one such object at a time. The main use case for this redesign of <a class="el" href="class_q_p_1_1_q_s.html" title="QS logging facilities.">QS</a> Local Filter is an application, where some active objects are very "noisy", and would overwhelm your trace. The new <a class="el" href="class_q_p_1_1_q_s.html" title="QS logging facilities.">QS</a> Local Filter allows you to selectively silence the "noisy" active objects and let all the others through.</p>
<p>The new <a class="el" href="class_q_p_1_1_q_s.html" title="QS logging facilities.">QS</a> Local Filter is based on "QS-IDs" associated with various objects in the Target memory. The QS-IDs are small integer numbers, such as the unique priorities assigned to <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> Active Objects, but there are more such QS-IDs, which you can assign to various other objects through the macro <a class="el" href="qs_8hpp.html#a43a3e7f568e445f82c0be2ebf924654c" title="Begin a user QS record with entering critical section.">QS_BEGIN_ID()</a>. Then, you can setup the <a class="el" href="class_q_p_1_1_q_s.html" title="QS logging facilities.">QS</a> Local Filter to trace only a specific QS-IDs or whole groups of QS-IDs by means of the macro <a class="el" href="qs_8hpp.html#a06c87e154257122417b40cf3d2dd7107" title="Local Filter for a given state machine object qs_id.">QS_LOC_FILTER()</a> or remotely via the QS-RX channel.</p>
<p><b>Source code changes:</b></p>
<p>The redesign of the <a class="el" href="class_q_p_1_1_q_s.html" title="QS logging facilities.">QS</a> Local Filter impacts the <a class="el" href="class_q_p_1_1_q_s.html" title="QS logging facilities.">QS</a> trace instrumentation in QP/C++: both the <a href="https://www.state-machine.com/qtools/qs.html#qs_pre"><b>pre-defined QS trace records</b></a> and the <a href="https://www.state-machine.com/qtools/qs.html#qs_app"><b>application-specific trace records</b></a>. The changes to the pre-defined records are confided to the QP/C++ source code and are transparent to the application developers. However, the changes to the application-specific trace records require adjusting existing applications as follows:</p>
<ul>
<li>use the new macro <a class="el" href="qs_8hpp.html#a06c87e154257122417b40cf3d2dd7107" title="Local Filter for a given state machine object qs_id.">QS_LOC_FILTER()</a> to set/clear the <a class="el" href="class_q_p_1_1_q_s.html" title="QS logging facilities.">QS</a> Local Filter</li>
<li>use the new macro <a class="el" href="qs_8hpp.html#a43a3e7f568e445f82c0be2ebf924654c" title="Begin a user QS record with entering critical section.">QS_BEGIN_ID()</a> to define <a href="https://www.state-machine.com/qtools/qs.html#qs_app"><b>application-specific trace records</b></a>.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>The macro <a class="el" href="qs_8hpp.html#a43a3e7f568e445f82c0be2ebf924654c" title="Begin a user QS record with entering critical section.">QS_BEGIN_ID()</a> assigns the specified QS-ID number to the app-specific record, which can be subsequently filtered by the new <a class="el" href="class_q_p_1_1_q_s.html" title="QS logging facilities.">QS</a> Local Filter. The old macro <a class="el" href="qpcpp_8hpp.html#ad99a023424e53db53e3a0bd6befe3f8e">QS_BEGIN()</a>, with the old Local Filter interface, is still available, but is <a class="el" href="deprecated.html">deprecated</a> and not recommended.</dd></dl>
<p>The following macros are <b>deprecated</b>:</p>
<ul>
<li>macro <a class="el" href="qpcpp_8hpp.html#a17b622a80eec603c8cd1d81f3b319a42">QS_FILTER_SM_OBJ()</a> does nothing in QP/C++ 6.9.1</li>
<li>macro <a class="el" href="qpcpp_8hpp.html#a2b49bf6045b1294330455dd0b4fcab88">QS_FILTER_AO_OBJ()</a> does nothing in QP/C++ 6.9.1</li>
<li>macro <a class="el" href="qpcpp_8hpp.html#a454d7a3704c3c4e88d0a75fc476b22f3">QS_FILTER_MP_OBJ()</a> does nothing in QP/C++ 6.9.1</li>
<li>macro <a class="el" href="qpcpp_8hpp.html#a7f5219a0712d857d7f6f7fded97bdf00">QS_FILTER_EQ_OBJ()</a> does nothing in QP/C++ 6.9.1</li>
<li>macro <a class="el" href="qpcpp_8hpp.html#acb795d05dcf49796febfcb6d30ab7969">QS_FILTER_TE_OBJ()</a> does nothing in QP/C++ 6.9.1</li>
<li>macro <a class="el" href="qpcpp_8hpp.html#aa6a82e6fda0dd1bb27a1ea0ca485a8a1">QS_FILTER_AP_OBJ()</a> still works for <a class="el" href="qpcpp_8hpp.html#ad99a023424e53db53e3a0bd6befe3f8e">QS_BEGIN()</a></li>
<li>macro <a class="el" href="qpcpp_8hpp.html#ab1daab0f67adda321cd13b42c6042023">QS_FILTER_ON()</a> still works, but uses <a class="el" href="qs_8hpp.html#aa42d8bbc70e6069f9c55d87f76ec15b0" title="Global Filter ON for a given record type rec.">QS_GLB_FILTER()</a> internally</li>
<li>macro <a class="el" href="qpcpp_8hpp.html#ae3d7888f95ecf7b24005a618ebc0ef89">QS_FILTER_OFF()</a> still works, but uses <a class="el" href="qs_8hpp.html#aa42d8bbc70e6069f9c55d87f76ec15b0" title="Global Filter ON for a given record type rec.">QS_GLB_FILTER()</a> internally</li>
<li>macro <a class="el" href="qpcpp_8hpp.html#ad99a023424e53db53e3a0bd6befe3f8e">QS_BEGIN()</a> still works, but uses the old "AP-OBJ" pointer</li>
</ul>
<p>The following APIs have been <b>changed</b>:</p>
<ul>
<li><a class="el" href="class_q_p_1_1_q_hsm.html#a8eaa1eb21e68e8dd26f080624cad83cd" title="executes the top-most initial transition in QP::QHsm">QHsm::init()</a> now takes extra <code>qs_id</code> parameter</li>
<li>QHSM::dispatch() now takes extra <code>qs_id</code> parameter</li>
<li><a class="el" href="class_q_p_1_1_q_m_pool.html#a84c87743569aa2a26a2b5d7fbbef9d42" title="Obtains a memory block from a memory pool.">QMPool::get()</a> now takes extra <code>qs_id</code> parameter</li>
<li><a class="el" href="class_q_p_1_1_q_m_pool.html#a1eefaa351313ea39462395eb58a584eb" title="Returns a memory block back to a memory pool.">QMPool::put()</a> now takes extra <code>qs_id</code> parameter</li>
<li><a class="el" href="class_q_p_1_1_q_e_queue.html#ab7faed14a4cde24461001219cf38dca1" title="&quot;raw&quot; thread-safe QF event queue implementation for the event posting (FIFO). You can call this funct...">QEQueue::post()</a> now takes extra <code>qs_id</code> parameter</li>
<li><a class="el" href="class_q_p_1_1_q_e_queue.html#a99fe8c234ef5275b0cd35b6c46a915f2" title="&quot;raw&quot; thread-safe QF event queue implementation for the First-In-First-Out (FIFO) event posting....">QEQueue::postLIFO()</a> now takes extra <code>qs_id</code> parameter</li>
<li><a class="el" href="class_q_p_1_1_q_e_queue.html#a75617b7aeb5634cbb858c27c7c7a2281" title="&quot;raw&quot; thread-safe QF event queue implementation for the Last-In-First-Out (LIFO) event posting.">QEQueue::get()</a> now takes extra <code>qs_id</code> parameter</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>The API changes are <b>not backwards-compatible</b> and require adjusting existing QP/C++ applications.</dd></dl>
<p>Additionally, this release introduces the new pre-defined <a class="el" href="class_q_p_1_1_q_s.html" title="QS logging facilities.">QS</a> record <a class="el" href="namespace_q_p.html#a2ee815d414fbd802853c730489f13f45a98bf159085064a8c12e9a64b225fa45b" title="an attempt to allocate an event failed">QS_QF_NEW_ATTEMPT</a>, which is generated when <a class="el" href="qf_8hpp.html#aa52b4d3c43a262022392c6e11be06436" title="Allocate a dynamic event (non-asserting version).">Q_NEW_X()</a> fails to allocate a dynamic event. Also, this release <b>reverses the order</b> of the pre-defined <a class="el" href="class_q_p_1_1_q_s.html" title="QS logging facilities.">QS</a> records <a class="el" href="namespace_q_p.html#a2ee815d414fbd802853c730489f13f45adfe3bc0c4afd40b4e6da539605f8216e" title="new event was created">QS_QF_NEW</a> and <a class="el" href="namespace_q_p.html#a2ee815d414fbd802853c730489f13f45a61c82b1714be13cb91871eafb9a51dd7" title="a memory block was removed from memory pool">QS_QF_MPOOL_GET</a>. This was necessary if the dynamic allocation is allowed to fail, because only <em>after</em> attempting to allocate a memory block, the <a class="el" href="class_q_p_1_1_q_f.html#a96f78ae7178a02a2bb60889d413c6df4" title="Internal QF implementation of creating new dynamic event.">QF::newX_()</a> function can generate either <a class="el" href="namespace_q_p.html#a2ee815d414fbd802853c730489f13f45adfe3bc0c4afd40b4e6da539605f8216e" title="new event was created">QS_QF_NEW</a> or <a class="el" href="namespace_q_p.html#a2ee815d414fbd802853c730489f13f45a98bf159085064a8c12e9a64b225fa45b" title="an attempt to allocate an event failed">QS_QF_NEW_ATTEMPT</a>.</p>
<dl class="section note"><dt>Note</dt><dd>The reversal of <a class="el" href="namespace_q_p.html#a2ee815d414fbd802853c730489f13f45adfe3bc0c4afd40b4e6da539605f8216e" title="new event was created">QS_QF_NEW</a> and <a class="el" href="namespace_q_p.html#a2ee815d414fbd802853c730489f13f45a61c82b1714be13cb91871eafb9a51dd7" title="a memory block was removed from memory pool">QS_QF_MPOOL_GET</a> trace records has implications for the existing <a href="https://www.state-machine.com/qtools/qutest_script.html"><b>QUTest test scripts</b></a>, where the order of expectations for "QF-New" and "MP-Get" needs to be reversed as well.</dd></dl>
<p>Additionally, this release modifies the <a class="el" href="group__qxk.html">QXK</a> source code, so that the <code><a class="el" href="class_q_p_1_1_q_active.html#a03e2db9120e649bddd69e025c1b45f68" title="QF priority (1..QF_MAX_ACTIVE) of this active object.">QActive.m_prio</a></code> attribute is the fixed priority assigned in <a class="el" href="class_q_p_1_1_q_active.html#ad30cc525bc2eb71b4821409bfddd45c3" title="Starts execution of an active object and registers the object with the framework.">QP::QActive::start()</a>, while <code>QActive.m_dynPrio</code> is the "dynamic" priority that can be changed when a <a class="el" href="group__qxk.html#qxk_extended">QXK extended thread</a> acquires a <a class="el" href="class_q_p_1_1_q_x_mutex.html">mutex</a>.</p>
<p><b>Updated Ports:</b></p>
<ul>
<li>all ARM Cortex-M ports (added workaround for the <a href="https://www.state-machine.com/doc/Cortex-M4_Software_Developers_Errata_Notice_v3.pdf"><b>ARM Erratum 838869</b></a>)</li>
<li>all <a class="el" href="class_q_p_1_1_q_k.html" title="QK services.">QK</a> ports (because of the changed <a class="el" href="class_q_p_1_1_q_m_pool.html#a84c87743569aa2a26a2b5d7fbbef9d42" title="Obtains a memory block from a memory pool.">QMPool::get()</a> / <a class="el" href="class_q_p_1_1_q_m_pool.html#a1eefaa351313ea39462395eb58a584eb" title="Returns a memory block back to a memory pool.">QMPool::put()</a> interface)</li>
<li>all <a class="el" href="class_q_p_1_1_q_x_k.html" title="QXK services.">QXK</a> ports (because of the changed <a class="el" href="class_q_p_1_1_q_m_pool.html#a84c87743569aa2a26a2b5d7fbbef9d42" title="Obtains a memory block from a memory pool.">QMPool::get()</a> / <a class="el" href="class_q_p_1_1_q_m_pool.html#a1eefaa351313ea39462395eb58a584eb" title="Returns a memory block back to a memory pool.">QMPool::put()</a> interface)</li>
<li>embOS port (because of the changed <a class="el" href="class_q_p_1_1_q_m_pool.html#a84c87743569aa2a26a2b5d7fbbef9d42" title="Obtains a memory block from a memory pool.">QMPool::get()</a> / <a class="el" href="class_q_p_1_1_q_m_pool.html#a1eefaa351313ea39462395eb58a584eb" title="Returns a memory block back to a memory pool.">QMPool::put()</a> interface)</li>
<li>FreeRTOS port (because of the changed <a class="el" href="class_q_p_1_1_q_m_pool.html#a84c87743569aa2a26a2b5d7fbbef9d42" title="Obtains a memory block from a memory pool.">QMPool::get()</a> / <a class="el" href="class_q_p_1_1_q_m_pool.html#a1eefaa351313ea39462395eb58a584eb" title="Returns a memory block back to a memory pool.">QMPool::put()</a> interface)</li>
<li>ThreadX port (because of the changed <a class="el" href="class_q_p_1_1_q_m_pool.html#a84c87743569aa2a26a2b5d7fbbef9d42" title="Obtains a memory block from a memory pool.">QMPool::get()</a> / <a class="el" href="class_q_p_1_1_q_m_pool.html#a1eefaa351313ea39462395eb58a584eb" title="Returns a memory block back to a memory pool.">QMPool::put()</a> interface)</li>
<li>uC/OS-II port (because of the changed <a class="el" href="class_q_p_1_1_q_m_pool.html#a84c87743569aa2a26a2b5d7fbbef9d42" title="Obtains a memory block from a memory pool.">QMPool::get()</a> / <a class="el" href="class_q_p_1_1_q_m_pool.html#a1eefaa351313ea39462395eb58a584eb" title="Returns a memory block back to a memory pool.">QMPool::put()</a> interface)</li>
<li>posix, posix-qv (because of the changed <a class="el" href="class_q_p_1_1_q_m_pool.html#a84c87743569aa2a26a2b5d7fbbef9d42" title="Obtains a memory block from a memory pool.">QMPool::get()</a> / <a class="el" href="class_q_p_1_1_q_m_pool.html#a1eefaa351313ea39462395eb58a584eb" title="Returns a memory block back to a memory pool.">QMPool::put()</a> interface)</li>
<li>win32, win32-qv (because of the changed <a class="el" href="class_q_p_1_1_q_m_pool.html#a84c87743569aa2a26a2b5d7fbbef9d42" title="Obtains a memory block from a memory pool.">QMPool::get()</a> / <a class="el" href="class_q_p_1_1_q_m_pool.html#a1eefaa351313ea39462395eb58a584eb" title="Returns a memory block back to a memory pool.">QMPool::put()</a> interface)</li>
</ul>
<p><b>Feature Requests:</b></p>
<ul>
<li><a href="https://sourceforge.net/p/qpc/feature-requests/181">feature#181 "Use of QS_U64()) on 32 bit machine"</a></li>
</ul>
<p><b>Bug Fixes:</b></p>
<ul>
<li><a href="https://sourceforge.net/p/qpc/bugs/279">bug#279 "Confusing documentation of QF_newX_()"</a></li>
<li><a href="https://sourceforge.net/p/qpc/bugs/280">bug#280 "QXK_onContextSw() not called at the end of QXK_activate_()"</a></li>
</ul>
<h1><a class="anchor" id="qpcpp_6_9_0"></a>
Version 6.9.0, 2020-08-21</h1>
<p>The main purpose of this release is to adjust the QP/C++ RTEF to the changes and improvements introduced in <a href="https://www.state-machine.com/qtools/history.html">QTools 6.9.0</a>. Specifically, QP/C++ now includes examples for the new <a href="https://www.state-machine.com/qtools/qview.html">QView Visualization &amp; Monitoring</a> as well as adjustments for the new version of <a href="https://www.state-machine.com/qtools/qutest.html">QUTest Unit Testing</a>.</p>
<p><b>Source code changes:</b></p>
<p>Added new <a class="el" href="namespace_q_p.html#a2ee815d414fbd802853c730489f13f45a0f0e239627aea4a7387f03c6e5178584" title="QF_run() was entered.">QS_QF_RUN</a> trace record to <a href="https://www.state-machine.com/qtools/qs.html">QS software tracing</a>, which is now generated in all QP/C++ ports upon the entry to <a class="el" href="class_q_p_1_1_q_f.html#a55052cc4c69d89ac25491bd744b3f5cc" title="Transfers control to QF to run the application.">QF::run()</a>. This trace record marks the end of the application startup, at which time all the <a href="https://www.state-machine.com/qtools/qs.html#qs_dict">QS dictionaries</a> are typically produced.</p>
<p>Also, added the information about the target <b>endianness</b> to the <a class="el" href="namespace_q_p.html#a2ee815d414fbd802853c730489f13f45a6a73ed1da89600585ca91b5572941ea4" title="reports the Target information">QS_TARGET_INFO</a> <a class="el" href="class_q_p_1_1_q_s.html" title="QS logging facilities.">QS</a> trace record.</p>
<dl class="section note"><dt>Note</dt><dd>The addition of the <a class="el" href="namespace_q_p.html#a2ee815d414fbd802853c730489f13f45a0f0e239627aea4a7387f03c6e5178584" title="QF_run() was entered.">QS_QF_RUN</a> trace record affects only the <a href="https://www.state-machine.com/qpc/struct.html#comp_qs">Spy build configuration</a> and is has <b>no impact</b> on the Release or Debug build configurations.</dd></dl>
<p><b>Updated Ports:</b></p>
<ul>
<li>All QP/C++ ports to 3rd-party RTOSes (embOS, FreeRTOS, ThreadX, uC/OS-II) and OSes (POSIX, POSIX-QV, WIN32, WIN32-QV) have been updated to generate the <a class="el" href="namespace_q_p.html#a2ee815d414fbd802853c730489f13f45a0f0e239627aea4a7387f03c6e5178584" title="QF_run() was entered.">QS_QF_RUN</a> trace record.</li>
<li>The POSIX and POSIX-QV ports have been updated to add the call to <code>pthread_attr_setinheritsched(&amp;attr, PTHREAD_EXPLICIT_SCHED)</code> (see also <a href="https://sourceforge.net/p/qpc/bugs/276">bug#276</a>)</li>
<li>The MSP430 ports have been extended for the GNU-MSP430 compiler, so that they now work with IAR-MSP40, TI-MSP40 and GNU-MSP430 toolchains.</li>
</ul>
<p><b>Updated Examples:</b></p>
<ul>
<li>All <a href="https://www.state-machine.com/qtools/qutest.html">QUTest</a> examples (<code>qpcpp\examples\qutest</code> directory) have been modified to use the new location of the <code>qutest.py</code> Python module. Also, all QUTest examples that use the <code>on_reset()</code> callback have been modified to call <code>expect_run()</code>.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>The <a class="el" href="namespace_q_p.html#a2ee815d414fbd802853c730489f13f45a0f0e239627aea4a7387f03c6e5178584" title="QF_run() was entered.">QS_QF_RUN</a> record is now generated in <a href="https://www.state-machine.com/qtools/qutest.html">QUTest unit testing</a>, which requires adjustments in the existing <a href="https://www.state-machine.com/qtools/qutest_script.html">test scripts</a>. Specifically, the test scripts that provide their own <a href="https://www.state-machine.com/qtools/namespacequtest__dsl.html#aa40735b0e2865f928331d30798090ee2">on_reset() callback</a> must now also call <a href="https://www.state-machine.com/qtools/namespacequtest__dsl.html#a6a958064a793bd7edd6ecc39e03c356a">expect_run()</a>.</dd></dl>
<ul>
<li>ARM Cortex-M examples for STM32 NUCLEO-L053RE (<code>qpcpp\examples\arm-cm\dpp_nucleo-l053r8</code>) and NUCLEO-L152RE (<code>qpcpp\examples\arm-cm\dpp_nucleo-l152re</code>) have been modified to support bi-directional QSPY communication. These examples now include the QView demos.</li>
<li>Added examples of new <a href="https://www.state-machine.com/qtools/html/qspy_seq.html">Sequence Diagram Generation</a> in QSPY 6.9.0</li>
<li>The example projects for MSP430 now contain the <code>ccs-ti</code> and <code>ccs-gnu</code> directories, for the TI-MSP430 and GNU-MSP430 toolchains, respectively.</li>
</ul>
<p><b>Bug Fixes:</b></p>
<ul>
<li><a href="https://sourceforge.net/p/qpc/bugs/276">bug#276 "QP/C/C++ POSIX port doesn't set thread priorities correctly"</a></li>
<li><a href="https://sourceforge.net/p/qpc/bugs/277">bug#277 "QP/â€‹C++6.8.2 game-gui and dpp-gui examples fail to compile with Visual Studio"</a></li>
</ul>
<h1><a class="anchor" id="qpcpp_6_8_2"></a>
Version 6.8.2, 2020-07-17</h1>
<p><b>Source code changes:</b></p>
<ul>
<li>Cleaned up the code to remove violations of AUTOSAR-C++ rules<ul>
<li>Changed casts of type <code>(void)xxx</code> into <code>static_cast&lt;void&gt;(xxx)</code>. This is done to avoid static analysis warnings about "C-style casts"</li>
<li>Added suffixes 'U' to unsigned integer literals</li>
<li>Changed <a class="el" href="qxk__xthr_8cpp.html" title="QXK/C++ preemptive kernel extended (blocking) thread implementation.">qxk_xthr.cpp</a> to use the <a class="el" href="namespace_q_p.html#a8d851266d53e464af6b2e8810f8c86b5">QP::TE_IS_LINKED</a> constant instead of a "magic" number 0x80U.</li>
</ul>
</li>
<li>Fixed errors in the Doxygen documentation, such as: missing documentation for parameters, wrong parameter names, unresolved references, etc.</li>
<li>Applied new, clearer styling to the Doxygen documentation.</li>
<li>Changed the <a class="el" href="class_q_p_1_1_q_s.html" title="QS logging facilities.">QS</a> trace record name QS_QF_ACTIVE_POST_FIFO to <a class="el" href="namespace_q_p.html#a2ee815d414fbd802853c730489f13f45acde7735acd22b2c9a09e929581c19d39" title="an event was posted (FIFO) directly to AO">QP::QS_QF_ACTIVE_POST</a> and QS_QF_EQUEUE_POST_FIFO to <a class="el" href="namespace_q_p.html#a2ee815d414fbd802853c730489f13f45ae3935bfaa5e22dd55c397b3f5327e0b4" title="an event was posted (FIFO) to a raw queue">QP::QS_QF_EQUEUE_POST</a>. This refactoring now better matches the QP/C++ API <a class="el" href="qf_8hpp.html#a46e898fd379bdf4753e803b10d2c6f8f" title="Invoke the direct event posting facility QP::QActive::post_().">POST()</a> and <a class="el" href="class_q_p_1_1_q_e_queue.html#ab7faed14a4cde24461001219cf38dca1" title="&quot;raw&quot; thread-safe QF event queue implementation for the event posting (FIFO). You can call this funct...">QEQueue::post()</a>.</li>
</ul>
<p><b>Updated Ports:</b></p><ul>
<li>enabled <a class="el" href="qxk_2qf__port_8hpp.html#a32bac1f13b13ac4f8d8be9688aa7c7f2" title="Enable the QActive::stop() API in the QF port.">QF_ACTIVE_STOP</a> in the ports: Win32, Win32-QV, Win32-QUTEST, POSIX, POSIX-QV, and POSIX-QUTEST.</li>
<li><a class="el" href="ucos-ii.html">port to uC/OS-II</a> has been adapted to the new uC/OS-II v2.93.00 (recently released by Silicon Labs under the open source Apache 2.0 license).</li>
</ul>
<p><b>Updated Examples:</b></p>
<ul>
<li>Modidfied <code>Makefile</code>s for the workstation examples to add the <code>-no-pie</code> linker option only when <code>GCC_OLD</code> environment variable is NOT defined. This is to accommodates older POSIX platforms with older GCC distribution.</li>
<li>Modified all ARM-KEIL uVision projects for ARM-CLANG to use the startup code in the ARM-ASM syntax.</li>
<li>New uC/OS-II example <a class="el" href="ucos-ii_dpp_nucleo-l053r8.html">DPP on STM32-NUCLEO-L053R8</a> (Cortex-M0+)</li>
<li>Removed uC/OS-II example for the STM32-NUCLEO-L152RE (Cortex-M3)</li>
<li>Added QM model files: <code>workstation/defer/defer.qm</code> and <code>workstation/reminder2/reminder2.qm</code></li>
</ul>
<p><b>Updated QUTest examples to generate code-coverage information:</b></p><ul>
<li>Modified <code>Makefile</code>s in QUTest examples (directory <code>examples\qutest</code>) to generate <b>code-coverage information</b>. Specifically, when the <code>GCOV</code> environment variable is defined, the <code>Makefile</code>s generate code-coverage information for <a href="https://en.wikipedia.org/wiki/Gcov">GCOV</a>.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>The GCOV code-coverage generation is currently available only on the hosts.</dd></dl>
<p><b>Updated 3rd-Party Components:</b></p>
<ul>
<li>CMSIS from 5.6.0 to 5.7.0</li>
<li>uC/OS-II from 2.92.10 to 2.93.00 (open source Apache 2.0 license)</li>
</ul>
<p><b>Bug Fixes:</b></p>
<ul>
<li><a href="https://sourceforge.net/p/qpc/bugs/268/">bug#268 QP/C++ Spy build configuration fails on 64-bit target</a></li>
<li><a href="https://sourceforge.net/p/qpc/bugs/269/">bug#269 Protect QSPY TX Buffer During QSPY RX</a></li>
<li><a href="https://sourceforge.net/p/qpc/bugs/271/">bug#271 Assert 250 upon semaphone wait timeout</a></li>
</ul>
<h1><a class="anchor" id="qpcpp_6_8_1"></a>
Version 6.8.1, 2020-04-04</h1>
<p><b>Bug Fixes:</b></p>
<ul>
<li><a href="https://sourceforge.net/p/qpc/bugs/261/">bug#261 QTime::disarm() clears the wrong flag</a></li>
</ul>
<p>Also, this release updates the QP/C++ ports and examples for workstations (Windows and POSIX) by consistently applying the "safe" versions of services from <code>&lt;stdio.h&gt;</code> and <code>&lt;string.h&gt;</code>. The "portable" versions of these services are defined as macros in the <code>safe_std.h</code> header file and include the following services:</p>
<ul>
<li><code>MEMMOVE_S()</code> -&gt; <code>memmove_s()</code></li>
<li><code>STRCPY_S()</code> -&gt; <code>strcpy_s()</code></li>
<li><code>STRCPY_S()</code> -&gt; <code>strcpy_s()</code></li>
<li><code>STRCAT_S()</code> -&gt; <code>strcat_s()</code></li>
<li><code>SNPRINTF_S()</code> -&gt; <code>_snprintf_s()</code></li>
<li><code>PRINTF_S()</code> -&gt; <code>printf_s()</code></li>
<li><code>FPRINTF_S()</code> -&gt;<code>fprintf_s()</code></li>
<li><code>FREAD_S()</code> -&gt; <code>fread_s()</code></li>
<li><code>FOPEN_S()</code> -&gt; <code>fopen_s()</code></li>
<li><code>LOCALTIME_S()</code> -&gt; <code>localtime_s()</code></li>
</ul>
<p>These "safe" functions are mapped to the best approximation of these services available on a given platform. For example, <code>STRCPY_S()</code> is mapped to <code>strcpy_s()</code> on Windows and <code>strcpy()</code> on POSIX (Linux/MacOS/etc.).</p>
<p>Finally, this release improves the comments in the <a class="el" href="class_q_p_1_1_q_f.html#aacf6bf8e121fea8b0a92d7197b73fe27" title="Function invoked by the application layer to stop the QF application and return control to the OS/Ker...">QF::stop()</a> function. The comments now make it very clear that after calling QF_stop() the application must terminate and cannot continue. In particular, <a class="el" href="class_q_p_1_1_q_f.html#aacf6bf8e121fea8b0a92d7197b73fe27" title="Function invoked by the application layer to stop the QF application and return control to the OS/Ker...">QF::stop()</a> is <b>not</b> intended to be followed by a call to <a class="el" href="class_q_p_1_1_q_f.html#a2858154e2009b0e6e616f313177762bc" title="QF initialization.">QF::init()</a> to "resurrect" the application. The previous comments apparently were confusing and some developers attempted to "restart" a running application, which led to system crashes.</p>
<h1><a class="anchor" id="qpcpp_6_8_0"></a>
Version 6.8.0, 2020-03-21</h1>
<p>This release updates the QP/C++ source code from C++98/03 to the <b>C++11 Standard</b>. Specifically, the following C++11 features are now used.</p>
<p><b>Source Code Changes:</b></p>
<ul>
<li>C++11 function specifiers: <code>noexcept</code>, <code>override</code>, <code>=delete</code></li>
<li><code>constexpr</code> for compile-time constants</li>
<li>typed enums</li>
<li><code>using</code> instead of <code>typedef</code></li>
<li>new style initializers <code>{...}</code></li>
<li><code>#include &lt;cstdint&gt;</code> instead of <code>&lt;stdint.h&gt;</code></li>
<li><code>std::uint8_t</code>, etc. for integer types defined in <code>&lt;cstdint&gt;</code></li>
<li><code>nullptr</code> instead of <code>static_cast&lt;void *&gt;(0)</code> or similar</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>This switch to the newer C++11 Standard requires compiling QP/C++ and the application-level code according to C++11 or newer standards.</dd></dl>
<p>Also, the PC-Lint-Plus "port" (<code>qpcpp\ports\lint-plus</code>) in this QP/C++ release has been changed to check the <b>AUTOSAR:C++14</b> rules, instead of MISRA:C++08. This is because the older MISRA:C++ rule checker assumes C++03 standard, which is inadequate for checking C++11 or newer C++ standards.</p>
<p><b>Other changes in QP/C++ source code:</b></p>
<ul>
<li>Deprecated macros for coding state machines the "old" way with the <code>me-&gt;</code> pointer, such as <code><a class="el" href="qpcpp_8hpp.html#a8f06cd90ba5060780fc61a4810e3eb50">Q_TRAN()</a></code>, <code><a class="el" href="qpcpp_8hpp.html#a7a348bc187076a0e9cdb7fc780c3831e">Q_SUPER()</a></code>, <code><a class="el" href="qpcpp_8hpp.html#af7e90f8b99a650f0550bfb45c5a99cdb">QM_TRAN()</a></code>, <code><a class="el" href="qep_8hpp.html#a94c192e5d5d8576eac408836e5bdc39d" title="Macro for a QM action-handler when it passes the event to the superstate.">QM_SUPER()</a></code>, etc. These macros have been moved to the backward-compatibility layer in the <a class="el" href="qpcpp_8hpp.html" title="QP/C++ public interface including backwards-compatibility layer.">qpcpp.hpp</a> header file (compatibility before version 6.8.0).</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>The only recommended way of coding state machines with QP/C++ is the "new" method, where state-handler functions are members of the state machine class, so the <code>me-&gt;</code> pointer is not needed (see also <a class="el" href="history.html#qpcpp_6_5_0">Version 6.5.0, 2019-03-30</a>).</dd></dl>
<ul>
<li>Fixed inconsistencies between <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> API declarations in the <code>.hpp</code> files and definitions in the <code>.cpp</code> files, such as different parameter names in declarations and definitions.</li>
<li>Removed a lot of excessive type casting of compile-time constants, such as <code>static_cast&lt;uint8_t&gt;(0)</code>, which is now coded simply as <code>0U</code></li>
<li>Introduced <a class="el" href="qep__port_8hpp.html#a3c9a47863f0f4254858b3387335869cb" title="no-return function specifier (C11/C++11 Standard)">Q_NORETURN</a> macro for <a class="el" href="qassert_8h.html#a641001e43708d975152996c9229a7afc" title="Callback function invoked in case of any assertion failure.">Q_onAssert()</a>, which can (if defined) inform the compiler that <a class="el" href="qassert_8h.html#a641001e43708d975152996c9229a7afc" title="Callback function invoked in case of any assertion failure.">Q_onAssert()</a> does not return. This can potentially improve the code generation and can improve diagnostics generated by the compiler.</li>
<li>Moved many <a class="el" href="class_q_p_1_1_q_s.html">QS</a> facilities for internal use from <a class="el" href="qs_8hpp.html" title="QS/C++ platform-independent public interface.">qs.hpp</a> to <a class="el" href="qs__pkg_8hpp.html" title="Internal (package scope) QS/C++ interface.">qs_pkg.hpp</a>. These are mostly facilities related to internal <a class="el" href="class_q_p_1_1_q_s.html" title="QS logging facilities.">QS</a> implementation as well as pre-defined <a class="el" href="class_q_p_1_1_q_s.html" title="QS logging facilities.">QS</a> trace records, which are only used inside <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> and are not needed in the <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> applications.</li>
<li>Removed all pre-conditions from <a class="el" href="class_q_p_1_1_q_active_dummy.html#a1fea8d85fabfe07b934f8a7c396b365b" title="Starts execution of an active object and registers the object with the framework.">QP::QActiveDummy::start()</a> function in <a class="el" href="qutest_8cpp.html" title="QF/C++ stub for QUTEST unit testing.">qutest.cpp</a>. This is to allow starting dummy AOs the exact same way as the real counterparts (e.g., with stack storage, which <a class="el" href="class_q_p_1_1_q_active_dummy.html" title="Dummy Active Object class.">QP::QActiveDummy</a> does not really need).</li>
</ul>
<p><b>Updated 3rd-Party Components:</b></p>
<ul>
<li>FreeRTOS from 10.2.1 to 10.3.0</li>
<li>SEGGER embOS from 4.34.1 to 5.06.1</li>
<li>SEGGER emWin from 5.32 to 6.10</li>
<li>Removed TI-RTOS</li>
</ul>
<p><b>Updated Examples:</b></p>
<p>Converted all the examples for ARM-MDK from compiler-5 (RVDS) to the new ARM Compiler-6 (ARM-clang). The examples for ARM Compiler-6 are located in the <code>armclang</code> sub-directories.</p>
<dl class="section note"><dt>Note</dt><dd>The older ARM Compiler-5 does not support the C++11 standard, and consequently it cannot compile QP/C++ code.</dd></dl>
<ul>
<li>Removed the ports and examples for ARM Compiler-5.</li>
<li>Removed support for the TI-RTOS, both in the ports and examples.</li>
</ul>
<p><b>Bugs Fixes:</b></p>
<ul>
<li><a href="https://sourceforge.net/p/qpc/bugs/256/">bug#256 Programming error in QP/C++ posix port</a></li>
</ul>
<h1><a class="anchor" id="qpcpp_6_7_0"></a>
Version 6.7.0, 2019-12-30</h1>
<p>The main purpose of this release is providing support for the <a href="https://www.gimpel.com/"><b>PC-Lint-Plus</b></a> static analysis tool and improved compliance with MISRA-C++:2008 (see also feature request <a href="https://sourceforge.net/p/qpc/feature-requests/169/">#169</a>). Specifically, the QP/C++ source code and some examples have been adjusted to comply with MISRA-C++:2008 rules, with all deviations captured in the PC-Lint-Plus configuration files. These PC-Lint-Plus configuration files have been provided in the new "port" to PC-Lint-Plus in the directory qpcpp/ports/lint-plus/.</p>
<dl class="section note"><dt>Note</dt><dd>The support for the older PC-Lint 9.x and the older MISRA-C:2004 has been dropped to avoid confusion and conflicts with the newer PC-Lint-Plus.</dd></dl>
<p>This release also includes the offline documentation for <b>this</b> particular version of QP/C++ (in the <code>html/</code> folder). To view the offline documentation, open the file <code>html/index.html</code> in your web browser. (The online HTML documention for the <b>latest</b> version of QP/C++ remains located at: <a href="https://www.state-machine.com/qpcpp/">https://www.state-machine.com/qpcpp/</a> )</p>
<p>The backwards-compatiblity layer for <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> 4.x has been removed. Among others, the macros Q_ROM and Q_ROM_VAR are no longer defined.</p>
<p>Also, this release updates the Windows-GUI examples with the QWIN Prototyping Toolkit to work with the latest Visual Studio 2019 and specifically with the Resource Editor now available. Specifically here, the Game-GUI example (<code>qpcpp\examples\arm-cm\game_efm32-slstk3401a\win32-gui</code>) and the DPP-GUI example (<code>qpcpp\examples\arm-cm\dpp_efm32-slstk3401a\win32-gui</code>) have been updated to build with the Visual Studio 2019.</p>
<p><b>Bugs Fixes:</b></p>
<ul>
<li><a href="https://sourceforge.net/p/qpc/bugs/255/">bug#255 "IAR-ARM "Multi-file Compilation" fails for QK and QXK applications"</a></li>
</ul>
<h1><a class="anchor" id="qpcpp_6_6_0"></a>
Version 6.6.0, 2019-10-31</h1>
<p>The main purpose of this release is the change in distribution of the QP/C++ framework, which is now bundled together with the other <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> frameworks (QP/C and QP-nano) as well as QM, and the QTools collection into "QP-bundle". This "QP-bundle" provides a single, streamlined and simplified download and installation of all <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> frameworks and all the accompanying tools.</p>
<p>This release brings also the following changes:</p>
<ul>
<li>changed all C++ header file names from "*.h" to "*.hpp"</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>The change means that the QP/C++ applications now should include "qpcpp.hpp" instead of "qpcpp.h". The latter file is still provided for backwards-compatibility, but it will be phased out in the future.</dd></dl>
<ul>
<li>changed inclusion guards in header files from "..._h" to "..._HPP" in all uppercase</li>
<li>removed "//" (double slash) from all comments for compliance with the MISRA-C:2012 required Rule 3.1. (The "//" sequence was used in the URLs, such as "http://...").</li>
<li>changed the type of the last parameter in <a class="el" href="class_q_p_1_1_q_hsm.html#a8eaa1eb21e68e8dd26f080624cad83cd" title="executes the top-most initial transition in QP::QHsm">QHsm::init()</a> from "QP::QEvt const *" to "void const *"</li>
<li>shifted <a class="el" href="namespace_q_p.html#a2ee815d414fbd802853c730489f13f45a48cec974671d01f280b2b1a33225d176" title="the first record available to QS users">QP::QS_USER</a> from 70 to 100 and made the freed-up records reserved</li>
<li>changed the QS_Ux_RECORDS groups to partition user records 100-124.</li>
<li>removed Tcl test scripts from QUTest examples</li>
<li>fixed <a href="https://sourceforge.net/p/qpc/bugs/248/">bug#248 Compilation error for the Q_EVT_CTOR configuration with QXK</a></li>
</ul>
<h1><a class="anchor" id="qpcpp_6_5_1"></a>
Version 6.5.1, 2019-05-24</h1>
<p>This release fixes the following bugs in the QP/C++ code supporting <a href="https://www.state-machine.com/qtools/qutest.html">QUTest unit testing</a>:</p>
<ul>
<li><a href="https://sourceforge.net/p/qpc/bugs/241/">bug#241 "QUTest produces superfluous â€œTrg-Done QS_RX_EVENTâ€ after publish"</a>.</li>
<li><a href="https://sourceforge.net/p/qpc/bugs/242/">bug#242 "QUTest fails to process events posted/â€‹published from user commands"</a>.</li>
</ul>
<p>Also, this release extends the <code>Makefiles</code> in the <code>qpcpp\examples\qutest</code> directory to provide the <code>debug</code> target. Also, this release extends the <code>qpcpp\examples\qutest\blinky</code> example with projects to build/debug this example with Visual C++ (on the host) and with ARM-KEIL on embedded target (EK-TM4C123).</p>
<p>Finally, this release adds ports and examples for PIC32 with MPLAB-X/XC32 toolchain.</p>
<h1><a class="anchor" id="qpcpp_6_5_0"></a>
Version 6.5.0, 2019-03-30</h1>
<p>This release brings new, much more natural and convenient way of <a class="el" href="sm.html">implementing state machines</a> in QP/C++, in which state-handler functions are regular <b>members</b> of the state machine class. This means that state-handlers have direct access to all class members via the implicit <code>this</code> pointer, <b>without the need to use the "me-&gt;" pointer</b>.</p>
<dl class="section note"><dt>Note</dt><dd>The previous "me-&gt; pointer" state machine implementation style is still supported in QP/C++ for backwards compatibility with the existing code, but it is <b>not</b> recommended for new designs.</dd></dl>
<dl class="section remark"><dt>Remarks</dt><dd>This "no me-&gt; pointer" state machine implementation is supported in the <a href="https://www.state-machine.com/products/qm/">QM model-based design tool</a> starting from <b>QM 4.5.0</b>.</dd></dl>
<p>This release comes with several models for <b>QM 4.5.0</b>, which demonstrate how to use this state-machine implementation style from QM.</p>
<p>Additionally, this release changes the API <code>QTimeEvt::ctr()</code> to <a class="el" href="class_q_p_1_1_q_time_evt.html#a19b5bc01ce83824bdd5b5a643f5e51a6" title="Get the current value of the down-counter of a time event.">QP::QTimeEvt::currCtr()</a>. This is to avoid name shadowing with the <code>ctr</code> variables, which is not compliant with MISRA.</p>
<p>Additionally, the examples for <code>calc1</code> and <code>calc1_sub</code> (with QM 4.5.0 models) have been extended to properly handle the operator precedence (multiplication and division have higher precedence than addition and subtraction).</p>
<p>Finally, this release adds the example <code>start-stop</code> located in the directory <code>qpcpp/examples/freertos/arm-cm/start-stop_nucleo-h743zi/</code> for the <a class="el" href="freertos.html">QP port to FreeRTOS</a>, which demonstrates how to dynamically start and stop active objects multiple times during the lifetime of the application. (NOTE: Starting and stopping active objects dynamically is generally not recommended, but the example has been requested by a commercial customer.)</p>
<h1><a class="anchor" id="qpcpp_6_4_0"></a>
Version 6.4.0, 2019-02-10</h1>
<p>This release brings the following changes:</p>
<ul>
<li>removed <a class="el" href="class_q_p_1_1_q_active.html#aacf6bf8e121fea8b0a92d7197b73fe27" title="Stops execution of an active object and removes it from the framework&#39;s supervision.">QActive::stop()</a></li>
<li>modified examples for ThreadX to define BSP_TICKS_PER_SEC as TX_TIMER_TICKS_PER_SECOND instead of a hardcoded value</li>
<li>modified examples for uC/OS-II to define BSP_TICKS_PER_SEC as OS_TICKS_PER_SEC instead of a hardcoded value</li>
<li>modified <a class="el" href="qassert_8h.html" title="Customizable and memory-efficient assertions for embedded systems.">qassert.h</a> to work correctly when assertions are disabled with <a class="el" href="macros_8hpp.html#a156525ce4ed9349b22aca5274d7cc432" title="The preprocessor switch to disable checking assertions.">Q_NASSERT</a> and also updated the QP/C++ source code to build correctly without assertions</li>
<li>improved the <a class="el" href="class_q_p_1_1_q_x_k.html" title="QXK services.">QXK</a> semaphores to handle correctly the maximum number of tokens</li>
<li>reduced the size of <a class="el" href="struct_q_p_1_1_q_p_set.html" title="Priority Set of up to 32 elements *â€/.">QPSet</a> in case <a class="el" href="qxk_2qf__port_8hpp.html#a776d2a032974db4bf9bcfde01ace1389" title="The maximum number of active objects in the application.">QF_MAX_ACTIVE</a> does not exceed 8 or 16.</li>
<li>improved performance of the QF_qlog2() algorithm when <a class="el" href="qxk_2qf__port_8hpp.html#a776d2a032974db4bf9bcfde01ace1389" title="The maximum number of active objects in the application.">QF_MAX_ACTIVE</a> does not exceed 8 or 16.</li>
<li>modified Makefiles for workstations (Windows and POSIX) to use compiler options -std=c99 for C and -std=c++11 for C++ as well as -pedantic option.</li>
<li>fixed examples for MSP430 with CCS and added QUTest support for MSP430.</li>
</ul>
<h1><a class="anchor" id="qpcpp_6_3_8"></a>
Version 6.3.8, 2018-12-31</h1>
<p>The main purpose of this release is the update the <code>Makefiles</code> that use the <a href="https://developer.arm.com/open-source/gnu-toolchain/gnu-rm">GNU-ARM Embedded Toolchain</a> to match the recent update in <a href="https://sourceforge.net/projects/qpc/files/QTools/">QTools for Windows 6.3.8</a>. Specifically, all <code>Makefiles</code> in the <code>examples</code> directory have been updated to use the GNU-ARM toolchain located in <code>qtools\gnu_arm-none-eabi</code> and use the tools prefix <b>arm-none-eabi-</b>.</p>
<dl class="section note"><dt>Note</dt><dd>The <code>Makefiles</code> that use the GNU-ARM included in this release require <a href="https://sourceforge.net/projects/qpc/files/QTools/">QTools for Windows version 6.3.8 or newer</a> and will <b>NOT</b> work with the older QTools collection.</dd></dl>
<h1><a class="anchor" id="qpcpp_6_3_7"></a>
Version 6.3.7, 2018-11-20</h1>
<p>The main goal of this release is to provide Python test scripts that match the newly re-designed Python support for the <a href="https://www.state-machine.com/qtools/qutest.html">QUTest unit testing harness</a> (see QTools <b>6.3.7</b>). Specifically, the Python tests scripts (*.py files) in the <code>qpcpp/examples/qutest</code> directory) have been all upgraded to the new syntax and format. Also, all the makefiles in that directory have been modified to execute Python test scripts by default, and Tcl test scripts only when the argument <code>SCRIPTS=tcl</code> is specified.</p>
<dl class="section note"><dt>Note</dt><dd>The new scripting interface <a href="https://www.state-machine.com/qtools/qutest_script.html">qutest.py</a> is now the primary supported QUTest scripting interface. The older interfaces, such as TCL ("qutest.tcl") and "qspypy" are considered <em>obsolete</em> and are <b>not recommended</b> for writing new test scripts.</dd></dl>
<p>The second change in this release is updating the <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> ports to Win32 and POSIX to eliminate the obsolete function <code>gethostbyname()</code> and replacing it with <code>getaddrinfo()</code>. This change has ripple effects on Windows, because it requires linking with "ws2_32" library, instead of "wsock2". All affected <code>Makefiles</code> in the <code>qpcpp\examples</code> directory have been updated to link the newer "ws2_32" library.</p>
<p>Finally, this release updates the internal implementation of <a class="el" href="class_q_p_1_1_q_x_k.html" title="QXK services.">QXK</a> function <code><a class="el" href="class_q_p_1_1_q_x_thread.html#ab03fb9b1827063e6095bcff049afac13">QXThread::post_()</a></code> for software tracing and testing with QUTest.</p>
<h1><a class="anchor" id="qpcpp_6_3_6"></a>
Version 6.3.6, 2018-10-20</h1>
<p>This release brings important changes and improvements to the unit-testing support for <a href="https://www.state-machine.com/qtools/qutest.html">QUTest</a>. Specifically, a new "dummy" active object class <a class="el" href="class_q_p_1_1_q_active_dummy.html" title="Dummy Active Object class.">QP::QActiveDummy</a> for testing has been added. Instances of this "dummy" AO can be now used as test-doubles for active objects that are recipients of events directly posted by the active object under test (AOUT). This, in turn, eliminates the need to alter the existing event-posting implementation, so that more of the actual <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> code can be used in the <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> test-stub (qutest.c).</p>
<dl class="section note"><dt>Note</dt><dd>The QUTest projects that are built <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> from sources need to include the <a class="el" href="qf__time_8cpp.html" title="QF/C++ time events and time management services.">qf_time.cpp</a> file.</dd></dl>
<p>As a consequence of the changes in the <a href="https://www.state-machine.com/qtools/qutest.html">QUTest</a> support, the <a class="el" href="exa_qutest.html">QUTest examples</a> have been re-designed and improved. Here, the most important changes include the new code organization, which reflects the customary separation of the code-under-test (CUT) from the code for testing. Also, the tests based on the <a href="https://www.amazon.com/Driven-Development-Embedded-Pragmatic-Programmers/dp/193435662X">"TDD book" by James Grenning</a> have been replaced with fully functional tests based on the <a href="http://www.throwtheswitch.org/unity/">Unity testing framework</a>. This is to directly compare the traditional approach (Unity) with QUTest.</p>
<p>The next change related to unit testing is adding <a class="el" href="namespace_q_p.html#ad3a766c33b9c3111cdf3c2a09ce17ea0af5162774ff0604672307aca598fda61c" title="query the &quot;current object&quot; in the Target">QP::QS_RX_QUERY_CURR</a> facility to QS-RX (software tracing input channel) and the reply <a class="el" href="namespace_q_p.html#a2ee815d414fbd802853c730489f13f45ad6bf3f7eceb7c0b063082d25f22ee994" title="reports the data from &quot;current object&quot; query">QP::QS_QUERY_DATA</a> to the <a class="el" href="class_q_p_1_1_q_s.html" title="QS logging facilities.">QS</a> output channel. These two extensions allow you to query the status of the "current object" inside the target. The most important example is querying the current state-machine object (QP::SM_OBJ), which returns the <b>current state</b>.</p>
<dl class="section note"><dt>Note</dt><dd>The new "query" facilities in QP/C++ match the latest additions to the <a href="https://www.state-machine.com/qtools/qspy.html">QSPY host application</a>.</dd></dl>
<p>Also this release adds <a href="https://www.state-machine.com/qtools/qs.html#qs_dict">QS dictionary</a> generation for all registered event pools. The generated object dictionaries are <code>EvtPool1</code> for pool-1, <code>EvtPool2</code> for pool-2, etc.</p>
<dl class="section note"><dt>Note</dt><dd>Applications no longer need to generate <a class="el" href="class_q_p_1_1_q_s.html" title="QS logging facilities.">QS</a> object dictionaries for the event pool storage buffers, such as <code>smlPoolSto[]</code>, etc.</dd></dl>
<p>Another big change in this release is re-designing of the <a class="el" href="exa_os.html">examples for workstations</a> (previously <code>win32</code>, <code>win32-qv</code>, <code>posix</code> and <code>posix-qv</code>). All these types of examples have been consolidated in the <a class="el" href="exa_os.html">exampes/workstation</a> folder, where the provided <code>Makefiles</code> have been extended to be cross-platform so that they work on Windows, Linux, and MacOS without changes.</p>
<p>To facilitate the creation of truly portable, cross-platform examples, the existing <a class="el" href="ports_os.html">QP ports to Windows/POSIX</a> have been augmented with abstractions for portable console access. Also, the <a href="https://www.state-machine.com/qtools/qs.html">QS software tracing</a> support via TCP/IP has been now added to the ports themselves. This means that applications no longer need to repeat the code for <a class="el" href="class_q_p_1_1_q_s.html" title="QS logging facilities.">QS</a> callbacks in the BSP implementation.</p>
<p>Finally, this release fixes a bug in the <a class="el" href="posix-qv.html">POSIX-QV port</a>, where the internal condition variable <code>QV_condVar_</code> has not been initialized.</p>
<h1><a class="anchor" id="qpcpp_6_3_4"></a>
Version 6.3.4, 2018-08-10</h1>
<p>This release adds new API <a class="el" href="class_q_p_1_1_q_time_evt.html#ab9ffd67adb412fe57812270dc4ce5a2b" title="Check the &quot;was disarmed&quot; status of a time event.">QP::QTimeEvt::wasDisarmed()</a> for checking the status of a <a class="el" href="class_q_p_1_1_q_time_evt.html" title="Time Event class.">QP::QTimeEvt</a> object after it has been disarmed. Specifically, the status of the last call to <a class="el" href="class_q_p_1_1_q_time_evt.html#ab90f9368f80d3d78fc717bb1d66d5af4" title="Disarm a time event.">QP::QTimeEvt::disarm()</a> is kept inside the time event object and can be subsequently checked with the <a class="el" href="class_q_p_1_1_q_time_evt.html#ab9ffd67adb412fe57812270dc4ce5a2b" title="Check the &quot;was disarmed&quot; status of a time event.">QP::QTimeEvt::wasDisarmed()</a> API. This new function is designed to be used directly as a guard condition on the timeout event, as described in the <a href="/psicc2">PSiCC2 book</a>, Section 7.7.3 "Arming and Disarming a Time Event" on page 359. The <a class="el" href="class_q_p_1_1_q_time_evt.html#ab9ffd67adb412fe57812270dc4ce5a2b" title="Check the &quot;was disarmed&quot; status of a time event.">QP::QTimeEvt::wasDisarmed()</a> has a side effect of setting the "was disabled" status, so the guard evaluates to 'true' the next time it is checked.</p>
<h1><a class="anchor" id="qpcpp_6_3_3a"></a>
Version 6.3.3a, 2018-07-16</h1>
<p>This release adds Python test scripts to the QUTest examples (folder <code>qpcpp/examples/qutest</code>). Specifically, the makefiles have been augmented to accept symbol <code>SCRIPT=py</code>, in which case the Python test scripts (<code>*.py</code>) are used instead of the default Tcl test scripts (<code>*.tcl</code>).</p>
<dl class="section remark"><dt>Remarks</dt><dd>This release does not change any QP/C++ APIs, QP/C++ implementation, ports, or other examples.</dd></dl>
<h1><a class="anchor" id="qpcpp_6_3_3"></a>
Version 6.3.3, 2018-06-22</h1>
<p>This release fixes the following bugs:</p>
<ul>
<li><a href="https://sourceforge.net/p/qpc/bugs/216/">bug#216 "Generated code for QP version check violates MISRA-C Rule 10.1"</a>.</li>
<li><a href="https://sourceforge.net/p/qpc/bugs/217/">bug#217 "GNU-ARM -fstack-protector incompatible with the QP ports to GNU-ARM"</a>.</li>
</ul>
<p>Also, this release demonstrates the new features of QM 4.3.0 in several example models (qpcpp/examples/ directory).</p>
<p>Finally, this release updates <code>3rd_party/CMSIS/Include</code> to the latest version from GitHub.</p>
<h1><a class="anchor" id="qpcpp_6_3_2"></a>
Version 6.3.2, 2018-06-20</h1>
<p>This release fixes the following bugs:</p>
<ul>
<li><a href="https://sourceforge.net/p/qpc/bugs/215/">bug#215 "QP is internally inconsistent in calling assertion macros"</a>.</li>
</ul>
<p>Also, this release improves the QUTest DPP example (directory <code>qpcpp/examples/qutest/dpp</code>) by demonstrating the proper use of <a class="el" href="qs_8hpp.html#ae5841714b4f420c33df0a5132cc3f2c7" title="QS macro to pause test execution and enter the test event loop.">QS_TEST_PAUSE()</a> and the corresponding test scripts. This example now matches the <a href="https://www.state-machine.com/qtools/qutest_rtc.html#qutest_pause">QUTest documentation of this feature</a>.</p>
<p>Finally, this release modifies the QP/C++ ports to POSIX and POSIX-QV by allowing to configure the p-thread priority of the ticker thread. This is achieved by adding a <code>tickPrio</code> parameter to the <code>QF_setTickRate()</code> function. (<b>NOTE</b> this modification will require changing existing <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> applications for POSIX or POSIX-QV that call <code>QF_setTickRate()</code>.</p>
<h1><a class="anchor" id="qpcpp_6_3_1"></a>
Version 6.3.1, 2018-05-24</h1>
<p>This release migrates the <a href="https://www.state-machine.com/qtools/qutest.html">QUTest</a> examples to <a href="https://www.state-machine.com/qm/history.html#qm_4_2_1">QM 4.2.1</a>, which now can generate <a class="el" href="qs_8hpp.html#a3b1ab21c174f2bec448edec8865a8529" title="Output function dictionary record.">QS_FUN_DICTIONARY()</a> records automatically. This release also adds a generic, simple blinky example for QUTest located in <code>examples/qutest/blinky</code>. Also, this release fixes the <a class="el" href="qk_2qf__port_8hpp.html#a88df5203e3a9716327b58923f5aaac80">QF_INT_DISABLE()</a> / <a class="el" href="qk_2qf__port_8hpp.html#ad2d11956704ad838c9c954368d3d37d5">QF_INT_ENABLE()</a> macros in the QUTest ports to use the <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> namespace. Without this fix, the code fails to compile when the directive "using namespace QP" is not used.</p>
<p>Also, this release adds the missing <a class="el" href="class_q_p_1_1_q_s.html" title="QS logging facilities.">QS</a> macro <a class="el" href="qs_8hpp.html#aa4ef1e418c7b9680bf2242f6354490ee" title="Output formatted event signal (of type QP::QSignal) and the state machine object to the user QS recor...">QS_SIG()</a> to produce symbolic signal output from <a href="https://www.state-machine.com/qtools/qs.html#qs_app">application specific QS records</a>.</p>
<p>Finally, this release adjusts the code in <a class="el" href="qs__rx_8cpp.html" title="QS receive channel services.">qs_rx.cpp</a> to use <a class="el" href="namespace_q_p.html#a3c9be482940206cefe3bb140ff02ebfc" title="increment the refCtr_ of an event e">QF_EVT_REF_CTR_INC_()</a> instead of accessing the event's reference counter directly. This direct access fails in case, when event constructors are configured (Q_EVT_CTOR is defined). In that case, the <a class="el" href="struct_q_p_1_1_q_evt.html" title="QEvt base class.">QP::QEvt</a> class protects the reference counter, so it cannot be accessed directly. This option is currently used only in the QP/C++ port to Qt.</p>
<h1><a class="anchor" id="qpcpp_6_3_0"></a>
Version 6.3.0, 2018-05-10</h1>
<p>The main purpose of this release is fixing the sub-machine support in the QP/Spy build configuration. Specifically, this release fixes the following bug:</p>
<ul>
<li><a href="https://sourceforge.net/p/qpc/bugs/213/">bug#213 "QP/C/C++ applications with submachines occasionally crash in Spy build configuration"</a></li>
</ul>
<dl class="section attention"><dt>Attention</dt><dd>This release matches <a href="https://www.state-machine.com/qm/history.html#qm_4_2_0">QM 4.2.0</a>.</dd></dl>
<p>Additionally, the release contains some re-factoring of the QS-RX input channel.</p>
<h1><a class="anchor" id="qpcpp_6_2_2"></a>
Version 6.2.0, 2018-03-16</h1>
<p>The main purpose of this release is extednding the functionality of the <a href="https://www.state-machine.com/qtools/qutest.html">QUTest unit testing</a> for QP/C++ applications. Specifically, this release adds support for testing of <b>self-posting</b> of events in active objects, which is an essential element in the <a href="https://www.state-machine.com/doc/Pattern_Reminder.pdf">Reminder</a> and <a href="https://www.state-machine.com/doc/Pattern_DeferredEvent.pdf">Deferred Event</a> design patterns. To implement this new feature, the QS-RX (<a class="el" href="class_q_p_1_1_q_s.html" title="QS logging facilities.">QS</a> receive channel) has been extened by a small scheduler that processes all secondary events gnenerated by dispatching, posting, or publishing events (only active when the <a class="el" href="macros_8hpp.html#a40cfa12d85dac9acf81031dbbc6ab03c" title="The preprocessor switch to activate the QUTest unit testing instrumentation in the code.">Q_UTEST</a> macro is defined). Also, the implementation of the target resident QUTest components (file <code><a class="el" href="qutest_8cpp.html" title="QF/C++ stub for QUTEST unit testing.">src/qs/qutest.cpp</a></code> and <code><a class="el" href="qf__actq_8cpp.html" title="QP::QActive native queue operations (based on QP::QEQueue)">src/qf/qf_actq.cpp</a></code>) have been modified to allow posting of events during unit testing.</p>
<p>Additionally, the release adds standard <a class="el" href="class_q_p_1_1_q_s.html" title="QS logging facilities.">QS</a> trace records (the <code>qs.h</code> header file) for event deferring and recalling (<a class="el" href="namespace_q_p.html#a2ee815d414fbd802853c730489f13f45a9cb7bde5f9a6515f7c26ba07e3cd68cc" title="AO deferred an event.">QS_QF_ACTIVE_DEFER</a> and <a class="el" href="namespace_q_p.html#a2ee815d414fbd802853c730489f13f45a1198b3e69f04119875431eda396d38f5" title="AO recalled an event.">QP::QS_QF_ACTIVE_RECALL</a>) as well as recall-attempt (<a class="el" href="namespace_q_p.html#a2ee815d414fbd802853c730489f13f45a65da04cff745a01de7661006869d2792" title="AO attempted to recall an event.">QS_QF_ACTIVE_RECALL_ATTEMPT</a>). Also standard <a class="el" href="class_q_p_1_1_q_s.html" title="QS logging facilities.">QS</a> trace records have been added for creating/deleting new event references (<a class="el" href="namespace_q_p.html#a2ee815d414fbd802853c730489f13f45ab2a5b85bda9829cfa535774c1676bae2" title="new event reference was created">QS_QF_NEW_REF</a> and <a class="el" href="namespace_q_p.html#a2ee815d414fbd802853c730489f13f45a118fac26bfea59e3184df6d11cc31fe6" title="an event reference is about to be deleted">QP::QS_QF_DELETE_REF</a>, respectively). To make room for these new records, the following rarely-used records have been removed: QS_QF_ACTIVE_ADD, QS_QF_ACTIVE_REMOVE, QS_QF_EQUEUE_INIT, and QS_QF_MPOOL_INIT. The global filter settings in the QS_filterOn() and QS_filterOff() functions have been updated to the augmented and re-organized <a class="el" href="class_q_p_1_1_q_s.html" title="QS logging facilities.">QS</a> trace records.</p>
<dl class="section note"><dt>Note</dt><dd>Because of the changes in the standard <a class="el" href="class_q_p_1_1_q_s.html" title="QS logging facilities.">QS</a> trace recods, this release requires the matching <b>QSPY 6.2.0</b> or later. Also, because of the changes this release might break some existing QUTest unit test scripts, which need to be re-adjusted to the new trace records.</dd></dl>
<p>Additionally, this release improves support for tracing and unit-testing embedded POSIX targets, such as embedded Linux, or OSes/RTOSes with the POSIX compatiblity layer. Specifically, the POSIX ports (<code>qpcpp/ports/posix/</code> and <code>qpcpp/ports/posix-qutest</code>) no longer produce libraries. Instead all examples for POSIX (<code>qpcpp/examples/posix/</code> and <code>qpcpp/ports/qutest</code>) build the QP/C framework directly from the sources, which promotes consisentcy in the toolchain and options used. For unit testing, <code>posix.mak</code> makefiles have been added for projects <code>qpcpp/examples/qutest/dpp</code> and <code>qpcpp/examples/qutest/self_test</code>. These makefiles support remote testing of embedded POSIX targets over TCP/IP, where the POSIX target runs only the test fixture, but the host (e.g., Windows host) executes both the QSPY host application and runs the QUTest scripts. The previous makefiles for POSIX have been renamed to <code>posix_host.mak</code>, because they are intended to use POSIX as a <em>host</em>, as opposed to a <em>target</em>.</p>
<p>Also, this release adds new QUTest exampes, which illustrate:</p><ul>
<li>event deferral (<code>qpcpp/examples/qutest/defer</code>)</li>
<li>dispatching/posting events with parameters (<code>qpcpp/examples/qutest/evt_par</code>).</li>
</ul>
<p>Additionally, this release updates the QP/C++ ports to win32-qv and posix-qv to allow a "tickless" mode, where the "tickerThread" is not created. This mode is set by configuring the system clock tick rate to 0 (QF_setTickRate(0)).</p>
<p>Finally, this release phases out the <code>qp_port.h</code> header file. If any of your projects still includes this file, please replace it with the qpc.h heder file.</p>
<h1><a class="anchor" id="qpcpp_6_1_1"></a>
Version 6.1.1, 2018-02-18</h1>
<p>The main purpose of this release is adding the context-switch callbacks to the preemptive <a class="el" href="group__qk.html">QK</a> and <a class="el" href="group__qxk.html">QXK</a> kernels. The <a class="el" href="qk_8hpp.html#acff88880f797d7b05a230ddbb8ad7ccf" title="QK context switch callback (customized in BSPs for QK)">QK_onContextSw()</a> and <a class="el" href="qxk_8hpp.html#a2a0015b8e5c790fcd206c37908ba5d7d" title="QXK context switch callback (customized in BSPs for QXK)">QXK_onContextSw()</a> callback functions provide a mechanism to perform additional custom operations when QK/QXK switches context from one thread to another. To avoid extra overhead when this functionality is not needed and for backwards-compatiblity with the existing applications, the callbacks are enabled only when the macros <a class="el" href="qk__port_8hpp.html#a606cc116164e722ae952c031623fe6d1" title="enable the context-switch callback">QK_ON_CONTEXT_SW</a> (for <a class="el" href="class_q_p_1_1_q_k.html" title="QK services.">QK</a>) and <a class="el" href="qxk__port_8hpp.html#a4cc251a9cba375c2b6f9749d95503b35" title="activate the context-switch callback">QXK_ON_CONTEXT_SW</a> (for <a class="el" href="class_q_p_1_1_q_x_k.html" title="QXK services.">QXK</a>) are defined. These macros can be defined either directly in command-line for the compiler, or in the QK/QXK port files (qk_port.c for <a class="el" href="class_q_p_1_1_q_k.html" title="QK services.">QK</a> and qxk_port.c for <a class="el" href="class_q_p_1_1_q_x_k.html" title="QXK services.">QXK</a>). Examples for the context-switch callbacks have been provided for for the <a class="el" href="arm-cm_dpp_nucleo-l053r8.html">NUCLEO-L053R8</a> (Cortex-M0+) and the <a class="el" href="arm-cm_dpp_nucleo-h743zi.html">NUCLEO-H743ZI</a> (Cortex-M7).</p>
<p>Also, this release changes the ARM Cortex-M ports for the IAR-ARM toolchain in that it replaces the assembly modules with the equivalent C implementation. This change enables using the configuration macros <a class="el" href="qk__port_8hpp.html#a606cc116164e722ae952c031623fe6d1" title="enable the context-switch callback">QK_ON_CONTEXT_SW</a> (for <a class="el" href="class_q_p_1_1_q_k.html" title="QK services.">QK</a>) and QXK_ON_CONTEXT_SW (for <a class="el" href="class_q_p_1_1_q_x_k.html" title="QXK services.">QXK</a>) in the ports. All existing example projects for IAR-ARM have been updated to use the <code>q(x)k_port.c</code> files instead of <code>q(x)k_port.s</code> files.</p>
<p>Also, this release adds new project files for the Atollic TRUEstudio for STM32. The TRUEstudio projects (Eclipse) have been added for the <a class="el" href="arm-cm_dpp_nucleo-l053r8.html">NUCLEO-L053R8</a> (Cortex-M0+) and the <a class="el" href="arm-cm_dpp_nucleo-h743zi.html">NUCLEO-H743ZI</a> (Cortex-M7).</p>
<p>Also, this relese updates the CMSIS to version 5.3.0 (see <code>qpcpp/3rd_party/CMSIS</code></p>
<p>Finally, this release fixes the following bug:</p>
<ul>
<li><a href="https://sourceforge.net/p/qpc/bugs/203/">bug#203 QXK: precondition in QXSemaphore::wait() incorrectly handles the scheduler lock"</a></li>
</ul>
<h1><a class="anchor" id="qpcpp_6_1_0"></a>
Version 6.1.0, 2018-02-04</h1>
<p>The main purpose of this release is adding the support for the <a href="https://developer.arm.com/products/software-development-tools/compilers/arm-compiler"><b>ARM Compiler 6 (ARM-Clang)</b></a>, which is a C/C++ toolchain for ARM processors based on the modern <a href="https://clang.llvm.org/">Clang frontend</a> and the <a href="https://llvm.org/">LLVM framework</a>. This release adds the ARM-Clang ports and examples for all built-in kernels (<a class="el" href="class_q_p_1_1_q_v.html" title="QV services.">QV</a>, <a class="el" href="class_q_p_1_1_q_k.html" title="QK services.">QK</a>, and <a class="el" href="class_q_p_1_1_q_x_k.html" title="QXK services.">QXK</a>) for the ARM Cortex-M CPU cores.</p>
<p>This release also adds support for the STM32H7 high-performance Cortex-M7 with the <b>double-precision FPU</b> (FPv5-DP-D16-M). Specifically, this release provides examples for the <a href="http://www.st.com/en/evaluation-tools/nucleo-h743zi.html">NUCLEO-H743ZI board</a> (Cortex-M7 with FPv5-DP-D16-M). The <a class="el" href="arm-cm_dpp_nucleo-h743zi.html">examples for NUCLEO-H743ZI board</a> include all built-in kernels with ARM-CLANG, ARM-KEIL, GNU-ARM, and IAR-ARM. Additionally the NUCLEO-H743ZI examples also include the <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> FreeRTOS with ARM-KEIL, GNU-ARM, and IAR-ARM.</p>
<p>Also, this release changes the ARM Cortex-M ports for the GNU-ARM toolchain in that it replaces the assembly modules with the equivalent C implementation. This change enables using wider range of GNU-ARM toolchain distributions, such as GNU-ARM Linaro, which had trouble with the assembly modules, but compiles correctly the C modules. All related GNU-ARM example projects have been modifed to use the new C-ports.</p>
<p>Also, this release fixes build problems with IAR EWARM caused by the CMSIS v5.1.1, where the IAR C++ compiler failed to compile the CMSIS "mpu_armv7.h" header file. The problem was caused by the <code>restrict</code> keyword, which was supported by default in the IAR C compiler, but was <b>not</b> supported by default by the IAR C++ compiler. The fix was to add explicit compiler option <code>--enable-restrict</code> to all IAR projects for Cortex-M processors.</p>
<p>Also, this release updates the existing projects for the Code Composer Studio (CCS) to CCSv7. All existing CCS projects for the EK-TM4C123GXL (TivaC LauchPad) and LaunchXL2-TMS57012 (Hercules) boards have been upgraded and tested.</p>
<p>Also, all examples for MSP430 with CCS have been updated to CCSv7 and re-tested on the supported boards.</p>
<h1><a class="anchor" id="qpcpp_6_0_4"></a>
Version 6.0.4, 2018-01-10</h1>
<p>The main purpose of this release is the provision of the official <a class="el" href="freertos.html">QP/C++ port to FreeRTOS</a> (version 10). The QP/C++ port to FreeRTOS is completely generic and should work on any CPU supported by FreeRTOS. The port comes with the following examples (see examples/freertos/):</p><ul>
<li><a class="el" href="freertos_dpp_ek-tm4c123gxl.html">DPP on EK-TM4C123GXL (ARM Cortex-M4F)</a> with ARM-KEIL, GNU-ARM and IAR-ARM toolchains.</li>
<li><a class="el" href="freertos_dpp_stm32f746g-disco.html">DPP on STM32F746G-Discovery (ARM Cortex-M7)</a> with ARM-KEIL, GNU-ARM and IAR-ARM toolchains.</li>
</ul>
<p>This release also replaces assembly with C implementation in the ARM-KEIL ports or the <a class="el" href="class_q_p_1_1_q_k.html" title="QK services.">QK</a> and <a class="el" href="class_q_p_1_1_q_x_k.html" title="QXK services.">QXK</a> kernels to Cortex-M to take advantage of the <code>__asm</code> functions. (NOTE: this change has impact on the existing QP/C++ applications that use the ARM-KEIL toolchain and the <a class="el" href="class_q_p_1_1_q_k.html" title="QK services.">QK</a> or <a class="el" href="class_q_p_1_1_q_x_k.html" title="QXK services.">QXK</a> kernels.)</p>
<p>Additionally, this release modifies all IAR-ARM example projects by adding compiler option "--enable_restrict". This option is necessary to compile the CMSIS header file "mpu_armv7.h" under the IAR C++, where the "restrict" keyword is not supported by default.</p>
<p>Additionally, this release fixes some problems with the native examples for STM32F4 and STM32F7 boards.</p>
<p>Additionally, this release adds a generic function <a class="el" href="class_q_p_1_1_q_active.html#a095312061d7fdd412b019495c93c3dd9" title="Generic setting of additional attributes (useful in QP ports)">QP::QActive::setAttr()</a> to set thread attributes in various <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> ports to 3rd-party RTOSes. This function is then used in the <a class="el" href="embos.html">embOS port</a> and the <a class="el" href="ucos-ii.html">uC/OS-II port</a>.</p>
<p>Finally, this release fixes the following bug in the <a class="el" href="threadx.html">ThreadX port</a>:</p>
<ul>
<li><a href="https://sourceforge.net/p/qpc/bugs/197/">bug#197 "Problems with scheduler locking in QP/C/C++ ports to ThreadX"</a></li>
</ul>
<h1><a class="anchor" id="qpcpp_6_0_3"></a>
Version 6.0.3, 2017-12-12</h1>
<p>Changes since version 6.0.1:</p>
<ul>
<li>fixed <a href="https://sourceforge.net/p/qpc/bugs/193/">bug#193 "QXK: context switch from extended to basic thread fails"</a></li>
<li>replaced attributes of <a class="el" href="class_q_p_1_1_q_active.html" title="QActive active object (based on QP::QHsm implementation)">QP::QActive</a> and <a class="el" href="class_q_p_1_1_q_e_queue.html" title="Native QF Event Queue class.">QP::QEQueue</a> classes from type <code>uint_fastX_t</code> to <code>uintX_t</code>. For the ARM Cortex-M port, these changes reduce the memory footprint of each <a class="el" href="class_q_p_1_1_q_active.html" title="QActive active object (based on QP::QHsm implementation)">QP::QActive</a> instance from 50 to 38 bytes (25% improvement).</li>
<li>improved the performance of the ARM Cortex-M0/M0+ ports, which do not supprt the CLZ (count leading zeros) instruction. All <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> ports to Cortex-M0/M0+ (qv, qk and qxk) now contain hand-optimized assembly implementation of the LOG2 (log-base-2) function. The implementation executes only in 14 machine instructions and uses only 16-byte look-up-table (LUT). This replaces LOG2 implementation based on a 256-byte LUT.</li>
<li>changed the interrupt disabling policy in ARM Cortex-M ports back to "unconditional interrupt disabling", which is simpler and faster than "saving-and-restoring interrupt status".</li>
<li>added a port to ARM Cortex-M with the LLVM compiler (currently only for the dual-mode <a class="el" href="class_q_p_1_1_q_x_k.html" title="QXK services.">QXK</a> kernel). Unlike the other ARM Cortex-M ports, the port to LLVM uses the "saving-and-restoring interrupt status" interrupt disabling policy (explicit request from a commercial customer).</li>
<li>removed ARM Cortex-M port and examples for the TI-ARM compiler. (Projects for the TI CCS can use the GNU-ARM toolchain and the existing GNU-ARM ports).</li>
<li>Added the DPP-COMP example (Dining Philosophers Problem) with the "Orthogonal Component" state pattern located in <code>qpcpp/examples/win32/dpp-comp</code>. This example demonstrates also a partitioned QM model into external packages for the Container (Table active object) and the Components (Philo active objects).</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>This release does not change any of the QP/C++ APIs.</dd></dl>
<h1><a class="anchor" id="qpcpp_6_0_1"></a>
Version 6.0.1, 2017-12-10</h1>
<p>The main focus of this release is to fix the remaining problems with transitions out of eXit-Points in sub-machines. Specifically, this release modifies the QMsm-based state machine implementation strategy (file <a class="el" href="qep__msm_8cpp.html" title="QP::QMsm implementation.">src/qf/qep_msm.cpp</a> to properly handle transitions from eXit-Points to Entry-Points and to History connectors in sub-machines. These changes are part of fixing the following bugs reported for QM:</p>
<ul>
<li><a href="https://sourceforge.net/p/qpc/bugs/190/">bug#190 "Exit-Point segment targeting History doesn't work</a></li>
<li><a href="https://sourceforge.net/p/qpc/bugs/189/">bug#189 "Exit-Point segment targeting an Entry-Point to sub-machine state doesn't work"</a></li>
</ul>
<p>Additionally, this release fixes the following bug in transitions to "shallow history":</p><ul>
<li><a href="https://sourceforge.net/p/qpc/bugs/191/">bug#191 "Transition to shallow history in QMsm causes assertion qep_msm#810"</a></li>
</ul>
<p>The bug#191 is fixed by modifying the function <a class="el" href="class_q_p_1_1_q_msm.html#ad5ab1177bb6ba8a1ca57cf4eba6dc683" title="Obtain the current active child state of a given parent (read only)">QMsm::childStateObj()</a> in <a class="el" href="qep__msm_8cpp.html" title="QP::QMsm implementation.">qep_msm.cpp</a> to return the parent state in the corner case when the current state is the parent state.</p>
<dl class="section note"><dt>Note</dt><dd>This QP/C++ 6.0.1 release is the minium version required in the upcoming QM 4.1.0. This is because QM 4.1.0 assumes the modified QMsm-state machine implementation strategy in order to properly handle the various transitions out of eXit-Points in sub-machine states.</dd></dl>
<p>Additionally, this release changes the <a class="el" href="class_q_p_1_1_q_x_k.html" title="QXK services.">QXK</a> implementation still related to the <a href="https://sourceforge.net/p/qpc/bugs/186/">bug#186 "QXK: Extended thread context switch causes assertion in PendSV_Handler"</a>. Specifically, the case of context switching away and back to the same thread (which can arise under specific interrupt preemption scenarios) is now handled as a simple return from PendSV. The <a class="el" href="class_q_p_1_1_q_x_k.html" title="QXK services.">QXK</a> scheduler has been modified to set the "next" thread pointer to NULL when it detects switching back to the "current" thread.</p>
<h1><a class="anchor" id="qpcpp_6_0_0"></a>
Version 6.0.0, 2017-10-13</h1>
<p>This release fixes two bugs found in the <a class="el" href="class_q_p_1_1_q_x_k.html" title="QXK services.">QXK</a> kernel:</p><ul>
<li><a href="https://sourceforge.net/p/qpc/bugs/185/">bug#185</a> "QXK: PendSV_Handler uses inconsistent stack frames for saving and restoring AO for Cortex-M0(+)"</li>
<li><a href="https://sourceforge.net/p/qpc/bugs/186/">bug#186</a> "QXK: Extended thread context switch causes assertion in PendSV_Handler"</li>
</ul>
<p>Additionally, this release includes a workaround for a <a href="https://bugs.launchpad.net/gcc-arm-embedded/+bug/1722849">bug indetified in the GNU-ARM toolset</a>. This problem affected the ARMv6-M architecture (Cortex-M0/M0+/M1) and manifested itself in generation of incorrect code for the <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> critical section at certain gcc optimization levels (such as -O). This bug was first discovered and filed as <a href="https://sourceforge.net/p/qpc/bugs/184/">bug#184</a>. The bug affected the GNU-ARM ports to all built-in kernels <a class="el" href="group__qv.html">QV</a>, <a class="el" href="group__qk.html">QK</a>, and <a class="el" href="group__qxk.html">QXK</a>.</p>
<dl class="section note"><dt>Note</dt><dd>This release no longer contains the directory <code>qpcpp/source</code>, which was scheduled to be phased out in QP5. In QP6 the source code is found only in the <code>qpcpp/src</code> directory.</dd></dl>
<h1><a class="anchor" id="qpcpp_5_9_9"></a>
Version 5.9.9, 2017-09-29</h1>
<p>This release implements the feature request <a href="https://sourceforge.net/p/qpc/feature-requests/132/">#132 "Extend the QXK mutex to support also simple operation without the priority-ceiling protocol"</a>.</p>
<dl class="section note"><dt>Note</dt><dd>This release is completely backwards-compatible with the <a class="el" href="history.html#qpcpp_5_9_8">previous QP/C++ release 5.9.8</a>.</dd></dl>
<p>Specifically, the <a class="el" href="class_q_p_1_1_q_x_mutex.html" title="Priority Ceiling Mutex the QXK preemptive kernel.">QP::QXMutex</a> class has been extended as follows:</p><ul>
<li>a mutex initialized with ceiling==0 (see <a class="el" href="class_q_p_1_1_q_x_mutex.html#aa0d18323a440f7c8e472bfbb35bed699" title="initialize the QXK priority-ceiling mutex QP::QXMutex">QP::QXMutex::init()</a>) means "no ceiling", so such mutex will NOT use the priority-ceiling protocol.</li>
<li>in this case the mutex will NOT require a unique priority level</li>
<li>in this case the mutex will not change (boost) the priority of the holding thread in the <a class="el" href="class_q_p_1_1_q_x_mutex.html#ae81960cd55154c38cd4bae8c45d5d92e" title="lock the QXK priority-ceiling mutex QP::QXMutex">QP::QXMutex::lock()</a> operation.</li>
<li>in this case the mutex will still support nesting of locks (as before), up to 255 levels of nesting.</li>
<li>when initialized with <code>ceiling&gt;0</code>, <a class="el" href="class_q_p_1_1_q_x_mutex.html" title="Priority Ceiling Mutex the QXK preemptive kernel.">QP::QXMutex</a> WILL use the priority-ceiling protocol, as before. It will require that the ceiling priority be unique and not used by any other thread or mutex. In other words, the previous functionality remains unchanged.</li>
</ul>
<h1><a class="anchor" id="qpcpp_5_9_8"></a>
Version 5.9.8, 2017-09-15</h1>
<p>This release fixes the <a class="el" href="class_q_p_1_1_q_x_k.html" title="QXK services.">QXK</a> kernel <a href="https://sourceforge.net/p/qpc/bugs/182/">bug#182 " Inconsistent QXThread::post_() behavior with respect to the 'margin' parameter"</a>.</p>
<p>Also, the pre-condition assertion in the function <a class="el" href="class_q_p_1_1_q_f.html#acc01bf7f20f6517953de5ef28af442fb" title="Internal QF implementation of creating new event reference.">QF::newRef_()</a> (file <code><a class="el" href="qf__dyn_8cpp.html" title="QF/C++ dynamic event management.">src/qf/qf_dyn.cpp</a></code>) has been modified to allow creating event references only for dynamic events <code>(e-&gt;poolId_ == 0)</code>.</p>
<p>Modifed ARM Cortex-M examples with the GNU-ARM toolset to be compatible with C++ RTTI and C++ Exception handling, as follows:</p>
<ul>
<li>removed definitions of <code>_init()</code> and <code>_fini()</code> from the GNU-ARM startup code for all supported boards in the <code>3rd_party</code> directory</li>
<li>added the empty definitions of <code>_init()</code> and <code>_fini()</code> to <code>mini_cpp.cpp</code> in the <code>3rd_party/gnu_cpp directory</code></li>
<li>Modified all GNU-ARM linker scripts (.ld files) to add the following symbols:</li>
</ul>
<pre class="fragment">   __exidx_start = .;
   .ARM.exidx   : { *(.ARM.exidx* .gnu.linkonce.armexidx.*) } &gt;RAM
   __exidx_end = .;
</pre><p>Provided C++ example with RTTI and Exception hanlding in the directory: <code>examples/arm-cm/dpp_efm32-slstk3401a/qxk/gnu_with-rtti</code></p>
<h1><a class="anchor" id="qpcpp_5_9_7"></a>
Version 5.9.7, 2017-08-18</h1>
<p>The main focus of this release are new requested features for the <a class="el" href="group__qxk.html">dual-mode QXK kernel</a>:</p><ul>
<li><a href="https://sourceforge.net/p/qpc/feature-requests/129" class="extern">feature#129 "Allow blocking while holding a mutex in QXK"</a>; and</li>
<li><a href="https://sourceforge.net/p/qpc/feature-requests/130" class="extern">feature#130 "Allow QXK mutex locks to nest while acquired by the same thread"</a>; and</li>
<li><a href="https://sourceforge.net/p/qpc/feature-requests/131" class="extern">feature#131 "Add a non-blocking "tryLock()" operation to the QXK mutex"</a>.</li>
</ul>
<p>Additionally, this release adds also the non-blocking <a class="el" href="class_q_p_1_1_q_x_semaphore.html#afdf929d9acbbc94b7262364ef570d631" title="try wait on the semaphore (non-blocking)">QXSemaphore::tryWait()</a> operation.</p>
<p>In the process of re-implementing the <a class="el" href="class_q_p_1_1_q_x_mutex.html" title="Priority Ceiling Mutex the QXK preemptive kernel.">QP::QXMutex</a>, the previouis non-blocking priority ceiling mutex has been replaced with an equivalent selective <a class="el" href="class_q_p_1_1_q_x_k.html" title="QXK services.">QXK</a> scheduler locking up to the specified ceiling priority. Specifically, this feature has been implemented with two new operations <a class="el" href="class_q_p_1_1_q_x_k.html#a5c49ed626f6699644beec500fe028bbd" title="QXK selective scheduler lock.">QXK::schedLock()</a> and <a class="el" href="class_q_p_1_1_q_x_k.html#a7e62ef374df0a3f426fd95f1e76396b9" title="QXK selective scheduler unlock.">QXK::schedUnlock()</a>.</p>
<p>For consistency, the non-blocking mutex of the <a class="el" href="group__qk.html">QK kernel</a> has been also replaced by the operations <a class="el" href="class_q_p_1_1_q_k.html#a5c49ed626f6699644beec500fe028bbd" title="QK selective scheduler lock.">QK::schedLock()</a> and <a class="el" href="class_q_p_1_1_q_k.html#a7e62ef374df0a3f426fd95f1e76396b9" title="QK selective scheduler unlock.">QK::schedUnlock()</a>.</p>
<p>All related <a class="el" href="class_q_p_1_1_q_x_k.html" title="QXK services.">QXK</a> and <a class="el" href="class_q_p_1_1_q_k.html" title="QK services.">QK</a> examples have been updated to use the selective scheduler locking instead of the mutex. The new blocking <a class="el" href="class_q_p_1_1_q_x_k.html" title="QXK services.">QXK</a> mutex has been demonstrated in the following updated examples:</p><ul>
<li><a class="el" href="arm-cm_dpp_efm32-slstk3401a.html">DPP on EFM32-SLSTK3401A</a></li>
<li><a class="el" href="arm-cm_dpp_ek-tm4c123gxl.html">DPP on EK-TM4C123GXL</a></li>
</ul>
<dl class="section attention"><dt>Attention</dt><dd>The changes to <a class="el" href="class_q_p_1_1_q_x_mutex.html" title="Priority Ceiling Mutex the QXK preemptive kernel.">QP::QXMutex</a> in <a class="el" href="class_q_p_1_1_q_x_k.html" title="QXK services.">QXK</a> and the now obsolete QMutex in <a class="el" href="class_q_p_1_1_q_k.html" title="QK services.">QK</a> <b>break backwards-compatiblity</b> with the exising code that relies these features. In the exising code, the mutexes should be replaced with selective scheduler locking.</dd>
<dd>
Also, the blocking APIs with timeouts, such as <a class="el" href="class_q_p_1_1_q_x_mutex.html#ae81960cd55154c38cd4bae8c45d5d92e" title="lock the QXK priority-ceiling mutex QP::QXMutex">QXMutex::lock()</a>, <a class="el" href="class_q_p_1_1_q_x_semaphore.html#a1076047c54b71d8135feb06eedfdb444" title="wait (block) on the semaphore">QXSemaphore::wait()</a>, <a class="el" href="class_q_p_1_1_q_x_thread.html#a7f4cee6eaea7c867c7a9592232052050" title="delay (block) the current extended thread for a specified # ticks">QXThread::delay()</a>, and <a class="el" href="class_q_p_1_1_q_x_thread.html#ae4a644af2db1379f568c0c67ddc74b17" title="obtain a message from the private message queue (block if no messages)">QXThread::queueGet()</a> no longer require the last <code>tickRate</code> parameter. This also <b>breaks backward-compatiblity</b> with the exising code that uses these operations.</dd></dl>
<p>This release also updates CMSIS to version 5.1.0 (3rd_party/CMSIS).</p>
<p>This release also adds the <a class="el" href="api.html">API Reference</a> section to the QP/C++ documentation.</p>
<h1><a class="anchor" id="qpcpp_5_9_6"></a>
Version 5.9.6, 2017-08-04</h1>
<p>The main focus of this release are improvements to the "dual-mode" <a class="el" href="class_q_p_1_1_q_x_k.html" title="QXK services.">QXK</a> kernel. Specifically, this release implements the <a href="https://sourceforge.net/p/qpc/feature-requests/128/" class="extern">featrue request #128 "QP Semaphore Max Value Setting"</a> for <a class="el" href="class_q_p_1_1_q_x_k.html" title="QXK services.">QXK</a>. This feature changes the <a class="el" href="class_q_p_1_1_q_x_k.html" title="QXK services.">QXK</a> function <a class="el" href="class_q_p_1_1_q_x_semaphore.html#aee04c046bd6e10430c11c29530ad9236" title="initialize the counting semaphore">QP::QXSemaphore::init()</a>, which now takes additional parameter <code>count</code>. This parameter specifies the maximum allowed count for the semaphore (e.g., count of 1 makes the semaphore a binary-semaphore).</p>
<dl class="section note"><dt>Note</dt><dd>This change does NOT break any existing code, because the additional parameter has a default value (0xFFFF).</dd></dl>
<p>This release also fixes a bug inside the assertions in <a class="el" href="class_q_p_1_1_q_x_semaphore.html#a48e4edb5679474f5855ae10f4a533394" title="signal (unblock) the semaphore">QP::QXSemaphore::signal()</a>, where the check for the extended-thread is performed.</p>
<p>Also, this release adds assertions to the <a class="el" href="class_q_p_1_1_q_x_k.html" title="QXK services.">QXK</a> code, which ensure that any available blocking calls can only be made from extended-threads and not from basic-threads (active objects) or ISRs.</p>
<p>Also, this release adds protection in the IRQ priorities initialization in QK/QV/QXK for ARM Cortex-M3/M4/M7, so that the number of IRQs is extracted from bits 0-2 of the ICTR register (INTLINESNUM).</p>
<p>Finally, this release consistently changes all example projects (for all toolchains) to use the <b>src</b> directory for QP/C++ source code, instead of the <b>source</b> directory. The source/ directory is now truly obsolete, but is still provided in this release for backwards compatibility with user projects.</p>
<h1><a class="anchor" id="qpcpp_5_9_5"></a>
Version 5.9.5, 2017-07-20</h1>
<p>This release fixes the following bugs:</p><ul>
<li><a href="https://sourceforge.net/p/qpc/bugs/178/" class="extern">bug#178</a> "GNU-ARM compiler reports "Error: unaligned opcodes..." in startup code for QP/C/C++/nano examples". The bug fix entails modifying the startup code for the GNU-ARM compiler in the <code>3rd_party</code> directory. Specifically, the proper alignment directives have been added to the inline assembly in the exception handlers.</li>
<li><a href="https://sourceforge.net/p/qpc/bugs/179/" class="extern">bug#179</a> "Assertion ID 210 fires when signaling on a QXK semaphore"</li>
</ul>
<p>This release fixes the naming problem of the startup code for the STM32F7-Discovery board (in the <code>3rd_party/stm32f7-discovery/gnu/ and arm/</code> directories), where the startup code was renamed from <code>startup_stm32f4xx.c/s</code> to <code>startup_stm32f746xx.c/s</code>. The change has been also made in the example projects for the STM32F7-Discovery board (for ARM-KEIL and GNU-ARM toolsets).</p>
<p>Finally, this release modifies the example code (mostly <code>bsp.cpp</code> files) so that the <a class="el" href="qassert_8h.html#a27042866331f49c9e9ff4f3ef459eaaf" title="Define the file name (with __FILE__) for assertions in this file.">Q_DEFINE_THIS_FILE()</a> macro is used consistently <em>outside</em> a namespace at the top of the file scope.</p>
<h1><a class="anchor" id="qpcpp_5_9_4"></a>
Version 5.9.4, 2017-07-07</h1>
<p>This release adds Thread-Local Storage (TLS) feature for the dual-mode <a class="el" href="class_q_p_1_1_q_x_k.html" title="QXK services.">QXK</a> kernel (see <a class="el" href="group__qxk.html#qxk_tls">Thread Local Storage</a>).</p>
<h1><a class="anchor" id="qpcpp_5_9_3"></a>
Version 5.9.3, 2017-06-19</h1>
<p>This release implements the feature request <a href="https://sourceforge.net/p/qpc/feature-requests/126/" target="_blank" class="extern">#126</a> "Allow non-asserting
event allocation for zero-margin allocations". Specifically, calling <a class="el" href="qf_8hpp.html#aa52b4d3c43a262022392c6e11be06436" title="Allocate a dynamic event (non-asserting version).">Q_NEW_X()</a> or <a class="el" href="class_q_p_1_1_q_active.html#a447d6f0d8a479b17deb64808dda2d4a3">QP::QActive::post_()</a> with the <code>margin</code> argument of zero will no longer assert if the allocation/posting fails.</p>
<h1><a class="anchor" id="qpcpp_5_9_2"></a>
Version 5.9.2, 2017-06-05</h1>
<p>This release adapts the Makefiles for GNU-ARM to the new location of the GNU-ARM toolset, which is now included in the QTools Collection (v 5.9.1) for Windows.</p>
<p>Also, this release improves the flash loading scripts for the JLink hardware debugger (for GNU-ARM projects for the EFM32-SLSTK3401A board). Specifically, the JLink configuration file for flash download is generated by the flash batch script based on the command-line paramter (the binary file to load into the flash). This eliminates the need to manually maintain JLink configuration files.</p>
<p>Also, this release adds bi-directional QP/Spy to the embOS example project for the STM32F4-Discovery board.</p>
<p>Also, this release adds GNU-ARM port to uC/OS-II and adds GNU-ARM example project for the EK-TM4C123GXL board.</p>
<p>Finally, this release implements the feature request #125 "Include QPC
Demo application for STM32F4 processor without RTOS" (see <a href="https://sourceforge.net/p/qpc/feature-requests/125/">https://sourceforge.net/p/qpc/feature-requests/125/</a> ). The DPP demo for the STM32F4-Discovery board has been added in the directory: qpc/examples/arm-cm/dpp_stm32f4-discovery . This demo includes <a class="el" href="class_q_p_1_1_q_v.html" title="QV services.">QV</a>, <a class="el" href="class_q_p_1_1_q_k.html" title="QK services.">QK</a> and <a class="el" href="class_q_p_1_1_q_x_k.html" title="QXK services.">QXK</a> kernels and ARM-Keil, GNU-ARM, and IAR-ARM toolsets. The demos support bi-directional QP/Spy.</p>
<h1><a class="anchor" id="qpcpp_5_9_1"></a>
Version 5.9.1, 2017-05-26</h1>
<p>This release fixes the following bug:</p><ul>
<li><a href="https://sourceforge.net/p/qpc/bugs/169/" target="_blank" class="extern">bug#169 "Submachine-state eXit Point does not work correctly"</a></li>
</ul>
<dl class="section note"><dt>Note</dt><dd>The bug only affects sub-machines and does not affect any other aspects of QMsm-style state machines.</dd></dl>
<p>Also, this release changes the organization of the QP/C++ source code to make it more friendly for the Eclipse CDT, as proposed in the <a href="https://sourceforge.net/p/qpc/feature-requests/123/" target="_blank" class="extern">feature request #123 "Eclipse-friendly source directory structure for QP/C/C++"</a>. Specifically, the QP/C++ source code is now provided in the <code>qpc/src/</code> directory with the following structure:</p>
<pre class="fragment">qpcpp/
  +-source/  - exitsting source directory with "flat" structure
  |            (for backwards-compatibility)
  +-src/     - new source directory grouped by functionality
     +-qf/    - core framework (QEP + QF)
     +-qk/    - QK kernel
     +-qv/    - QV kernel (only one file qv.c)
     +-qxk/   - QXK kernel
     +-qs/    - QS software tracing
     +-qf_pkg.h
     +-qs_pkg.h
     +-qxk_pkg.h
</pre><dl class="section note"><dt>Note</dt><dd>The original <code>qpcpp/source</code> directory is still provided for backwards compatibility with the existing QP/C projects. This directory will be phased out in the future QP/C++ releases. Please use the new source code structure provided in the <code>qpcpp/src</code> directory.</dd></dl>
<h1><a class="anchor" id="qpcpp_5_9_0"></a>
Version 5.9.0, 2017-05-19</h1>
<p>The main purpose of this milestone QP/C++ release is to provide support for the powerful <b>Unit Testing Framework</b> called <a href="https://www.state-machine.com/qtools/qutest.html" target="_blank" class="extern"><b>QUTest&trade;</b> (pronounced <em>cutest</em>)</a>. QUTest&trade; is the fundamental tooling for Test-Driven Development (TDD) of QP/C++ applications, which is a highly recommended best-practice. This release introduces changes in the QS-RX (receive) channel and adds several new callbacks.</p>
<dl class="section note"><dt>Note</dt><dd>The signature of the <a class="el" href="class_q_p_1_1_q_s.html#ad4e3ed9f48e3852d66cec4072af6edb4" title="Callback function to execute user commands (to be implemented in BSP)">QS::onCommand()</a> has changed and the function now takes 3 arbitrary 32-bit parameters instead of one. This introduces backwards-incompatibility with previous code that used <a class="el" href="class_q_p_1_1_q_s.html#ad4e3ed9f48e3852d66cec4072af6edb4" title="Callback function to execute user commands (to be implemented in BSP)">QS::onCommand()</a>.</dd></dl>
<p>This release also changes the critical section for QP/C++ ports to ARM Cortex-M in that the policy of "save and restore interrupt status" is used. This policy permits nesting of critical sections, which was requested by customers.</p>
<p>Additionally, this release changes the selective interrupt disabling for ARM Cortex-M3/4/7 (with the BASEPRI register) to address the hardware problem on ARM Cortex-M7 core r0p1 (ARM-EPM-064408, errata 837070). The <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> ports to ARM Cortex-M3/4/7 now implement the workaround recommended by ARM, which is to surround MSR BASEPRI with the "CPSID i"/"CPSIE i" pair. This workaround works also for Cortex-M3/M4 cores.</p>
<p>New ports:</p><ul>
<li>ports/win32-qutest folder contains port to QUTest for Windows</li>
<li>ports/posix-qutest folder contains port to QUTest for POSIX (Linux)</li>
<li>ports/arm-cm/qutest folder contains port to QUTest for ARM Cortex-M</li>
</ul>
<p>New examples:</p><ul>
<li>examples/qutest/dpp folder contains the QUTest DPP test for various platforms (Win32, EFM32-SLSTK3401A and EK-TM4C123GXL)</li>
<li>examples/qutest/qhsmtst folder contains the QUTest test for the QHsmTst state machine (structural test)</li>
<li>examples/qutest/qmsmtst folder contains the QUTest test for the QMsmTst state machine (structural test)</li>
<li>examples/qutest/self_test folder contains the QUTest self-test for various features of QUTest</li>
</ul>
<p>Updates of 3rd_party software:</p><ul>
<li>the 3rd_party/CMSIS folder has been updated to CMSIS 5.0.2.</li>
<li>the 3rd_party/embOS folder has been updated to embOS 4.34.1</li>
</ul>
<p>Finally, this release fixes the following bugs:</p><ul>
<li>bug#162 "QF critical sections require modification for M7 core"</li>
</ul>
<h1><a class="anchor" id="qpcpp_5_8_2"></a>
Version 5.8.2, 2017-02-08</h1>
<p>This release adds examples for the ARM Cortex-<b>M7</b> CPU. Specifically, the release contains the standard <a class="el" href="dpp.html">Dining Philosophers Problem (DPP)</a> examples for the <a class="el" href="arm-cm_dpp_stm32f746g-disco.html">STM32F746G-Discovery board</a>, all build-in kernels (<a class="el" href="class_q_p_1_1_q_v.html" title="QV services.">QV</a>, <a class="el" href="class_q_p_1_1_q_k.html" title="QK services.">QK</a>, and <a class="el" href="class_q_p_1_1_q_x_k.html" title="QXK services.">QXK</a>), and ARM-KEIL, IAR EWARM, GNU-ARM toolsets.</p>
<p>To provide examples for STM32F746G-Discovery board, the release now provides the folder <code>3rd_party/stm32f7-discovery</code> with the support code for the STM32F7xx MCUs, which contains parts of STM32CubeF7 library.</p>
<p>Also, the <code>3rd_party/CMSIS</code> folder now provides the new CMSIS V5.0.1.</p>
<p>Also, the file <code>3rd_party/gnu_cpp/mini_cpp.cpp</code> has been updated to provide compatibility with the latest GNU-ARM (gcc 6.2.0).</p>
<p>Finally, this release fixes the following bugs:</p><ul>
<li>bug#159 QP/C/C++ Win32 ports don't work on all x86 CPUs</li>
<li>bug#157 In QPC ucosii port, conversion of AO's priority to OS task priority is incorrect.</li>
<li>bug#152 Typo (qpcpp/ports/arm7-9/qk/gnu/qk_port.s:42) prevents compilation</li>
<li>bug#151 <a class="el" href="class_q_p_1_1_q_ticker.html" title="Ticker Active Object class.">QTicker</a> compile error when <a class="el" href="macros_8hpp.html#a6fe4f9d0a79376c9d457fcb4aab5b08f" title="The preprocessor switch to activate the event-constructors and destructors.">Q_EVT_CTOR</a> is defined</li>
<li>bug#154 qspy.c parses history transitions incorrectly</li>
</ul>
<h1><a class="anchor" id="qpcpp_5_8_1"></a>
Version 5.8.1, 2016-12-16</h1>
<p>This release is in response to a recent finding that many <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> users of the ports to ARM Cortex-M3/M4 forget to explicitly set their interrupt priorities, as described in the AppNote <a href="https://www.state-machine.com/doc/AN_ARM-Cortex-M_Interrupt-Priorities.pdf" target="_blank" class="extern">"Setting ARM Cortex-M Interrupt Priorities in QP 5.x"</a>.</p>
<p>Specifically, this release improves safety of <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> ports to ARM Cortex-M3/M4, by initializing the interrupt priorities to a safe default in a generic, portable way. This <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> port includes such a fix for QV/QK/QXK ports to ARM Cortex-M3/M4.</p>
<p>Additionally, this release introduces the new <a class="el" href="class_q_p_1_1_q_ticker.html" title="Ticker Active Object class.">QP::QTicker</a> class, which is an efficient active object specialized to process <a class="el" href="class_q_p_1_1_q_f.html" title="QF services.">QF</a> system clock tick at a specified tick frequency [0..#QF_MAX_TICK_RATE]. Placing system clock tick processing in an active object allows you to remove the non-deterministic <a class="el" href="qf_8hpp.html#a9a12c5b2f250d8d874a2ec0ba72a0676" title="Invoke the system clock tick processing QP::QF::tickX_().">TICK_X()</a> processing from the interrupt level and move it into the thread-level, where you can prioritize it as low as you wish.</p>
<p>Changes in detail:</p><ul>
<li>modified the <a class="el" href="class_q_p_1_1_q_v.html" title="QV services.">QV</a>, <a class="el" href="class_q_p_1_1_q_k.html" title="QK services.">QK</a>, and <a class="el" href="class_q_p_1_1_q_x_k.html" title="QXK services.">QXK</a> source code to call QV_init(), QK_init(), and QXK_init(), respectively.</li>
<li>modified the ARM Cortex-M ports of <a class="el" href="class_q_p_1_1_q_v.html" title="QV services.">QV</a>, <a class="el" href="class_q_p_1_1_q_k.html" title="QK services.">QK</a>, and <a class="el" href="class_q_p_1_1_q_x_k.html" title="QXK services.">QXK</a> to initialize priorities all exceptions and IRQs to the safe value QF_BASEPRI.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>The <a class="el" href="class_q_p_1_1_q_v.html" title="QV services.">QV</a> port now has a new <b>qv_port.cpp</b> module that needs to be added to the build.</dd></dl>
<ul>
<li>added declaration of the <a class="el" href="class_q_p_1_1_q_ticker.html" title="Ticker Active Object class.">QP::QTicker</a> class to qf.h</li>
<li>added implementation of the <a class="el" href="class_q_p_1_1_q_ticker.html" title="Ticker Active Object class.">QP::QTicker</a> class to <a class="el" href="qf__actq_8cpp.html" title="QP::QActive native queue operations (based on QP::QEQueue)">qf_actq.cpp</a></li>
<li>modified the following examples to demonstrate the use of the <a class="el" href="class_q_p_1_1_q_ticker.html" title="Ticker Active Object class.">QP::QTicker</a>:<ul>
<li>qpcpp/examples/arm-cm/dpp_efm32-slstk3401a/qk</li>
<li>qpcpp/examples/arm-cm/game_efm32-slstk3401a/qv</li>
<li>qpcpp/examples/arm-cm/game_efm32-slstk3401a/qk</li>
</ul>
</li>
<li>added the header file <b>cmsis_ccs.h</b> to qpcpp/3rd_party/CMSIS/Include directory (used in the examples for the Code Composer Studio). The file has been dropped during the upgrade to CMSIS 5.0.1, because it is not part of the standard distribution.</li>
</ul>
<h1><a class="anchor" id="qpcpp_5_8_0"></a>
Version 5.8.0, 2016-11-30</h1>
<p>The main purpose of this milestone QP/C++ release is to finally provide the baseline framework fully compatible with the upcoming QM 4.0.0.</p>
<p>This release changes the class hierarchy so that <a class="el" href="class_q_p_1_1_q_hsm.html" title="Hierarchical State Machine base class.">QP::QHsm</a> becomes the base class of <a class="el" href="class_q_p_1_1_q_msm.html" title="QM State Machine implementation strategy.">QP::QMsm</a> and <a class="el" href="class_q_p_1_1_q_active.html" title="QActive active object (based on QP::QHsm implementation)">QP::QActive</a>. Also, <a class="el" href="class_q_p_1_1_q_active.html" title="QActive active object (based on QP::QHsm implementation)">QP::QActive</a> becomes the base class of <a class="el" href="class_q_p_1_1_q_m_active.html" title="QMActive active object (based on QP::QMsm implementation)">QP::QMActive</a>, which reverses the changes introduced in version 4.1.</p>
<p>The modified <a class="el" href="struct.html#classes">class hierarchy</a> better reflects the fact that <a class="el" href="class_q_p_1_1_q_hsm.html" title="Hierarchical State Machine base class.">QP::QHsm</a> state machine implementation strategy is simpler and supports less functionality than the more advanced <a class="el" href="class_q_p_1_1_q_msm.html" title="QM State Machine implementation strategy.">QP::QMsm</a> strategy. For example, only the <a class="el" href="class_q_p_1_1_q_msm.html" title="QM State Machine implementation strategy.">QP::QMsm</a> class fully supports sub-machines and sub-machine states that are the main feature of QM 4.x. This clean progression of supported functionality from subclasses to superclasses allows QM to easier check and enforce that advanced features are not generated for subclasses that don't have the required capabilities. (With previous class hierarchy with <a class="el" href="class_q_p_1_1_q_msm.html" title="QM State Machine implementation strategy.">QP::QMsm</a> as the base class all subclasses, including <a class="el" href="class_q_p_1_1_q_hsm.html" title="Hierarchical State Machine base class.">QP::QHsm</a>, would technically inherit the advanced functionality, which is not the case).</p>
<dl class="section note"><dt>Note</dt><dd>The changes in QP/C++ 5.8.0 might occasionally require changing existing QP/C++ applications by changing the type of pointers to <a class="el" href="class_q_p_1_1_q_msm.html" title="QM State Machine implementation strategy.">QP::QMsm</a> with pointers to <a class="el" href="class_q_p_1_1_q_hsm.html" title="Hierarchical State Machine base class.">QP::QHsm</a> or pointers to <a class="el" href="class_q_p_1_1_q_m_active.html" title="QMActive active object (based on QP::QMsm implementation)">QP::QMActive</a> with <a class="el" href="class_q_p_1_1_q_active.html" title="QActive active object (based on QP::QHsm implementation)">QP::QActive</a>, because of the reverse superclass-subclass relationship between these classes.</dd></dl>
<p>Also, this release changes the implementation of the <a class="el" href="class_q_p_1_1_q_v.html" title="QV services.">QV</a>, <a class="el" href="class_q_p_1_1_q_k.html" title="QK services.">QK</a>, and <a class="el" href="class_q_p_1_1_q_x_k.html" title="QXK services.">QXK</a> kernels in that the ready-set representing active threads is cleared only <em>after</em> completion of the RTC-step, not when the last event is removed from the corresponding event queue. In case of the <a class="el" href="class_q_p_1_1_q_x_k.html" title="QXK services.">QXK</a> kernel this change fixes the high-priority <a href="https://sourceforge.net/p/qpc/bugs/147/">bug#147</a>. But even in case of the <a class="el" href="class_q_p_1_1_q_v.html" title="QV services.">QV</a> and <a class="el" href="class_q_p_1_1_q_k.html" title="QK services.">QK</a> kernels, where this behavior didn't lead to any bugs, the policy better reflects the semantics of the ready-set.</p>
<p>This release also updates the CMSIS interface included in the 3rd_party/CMSIS folder to the latest CMSIS-5.</p>
<p>All examples and QM models have been updated to the new upcoming QM 4.0.0. All these models require QM 4.x.</p>
<p>Finally, the complete list of bugs fixed in this release is as follows:</p>
<ul>
<li><a href="https://sourceforge.net/p/qpc/bugs/147/">bug#147</a> "QXK: PendSV_error is triggered on special conditions"</li>
<li><a href="https://sourceforge.net/p/qpc/bugs/144/">bug#144</a> "Obsolete Win32 API in qwin_gui.c"</li>
<li><a href="https://sourceforge.net/p/qpc/bugs/124/">bug#124</a> "Windows port now cause memory leakage"</li>
</ul>
<h1><a class="anchor" id="qpcpp_5_7_4"></a>
Version 5.7.4, 2016-11-04</h1>
<p>This release fixes the following bugs:</p><ul>
<li>bug#145 <a class="el" href="class_q_p_1_1_q_f.html#af3b38af4b7b4aecc95b1a36d141e873a" title="Publish event to the framework.">QP::QF::publish_()</a> leaks events that have no subscribers</li>
<li>bug#144 Obsolete Win32 API in qwin_gui.c</li>
<li>bug#143 <a class="el" href="class_q_p_1_1_q_active.html#a2275d125f8bb6e87a60a2c13ee4be7a2" title="Posts an event directly to the event queue of the active object using the Last-In-First-Out (LIFO) po...">QP::QMActive::postLIFO</a> on initial transition asserts on <a class="el" href="class_q_p_1_1_q_x_k.html" title="QXK services.">QXK</a></li>
</ul>
<h1><a class="anchor" id="qpcpp_5_7_3"></a>
Version 5.7.3, 2016-10-07</h1>
<p>This release adds <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> ports to the TI-RTOS kernel (SYS/BIOS) with TI-CCS and IAR EWARM toolsets. Examples are provided for the EK-TM4C123GXL (TivaC LaunchPad) in the directory:</p>
<p>qpcpp/examples/ti-rtos/arm-cm/dpp_ek-tm4c123gxl</p>
<p>NOTE: The examples require a separate installation of the TI-RTOS (file tirtos_tivac_setupwin32_2_16_01_14.exe)</p>
<p>Also, this release fixes the following bugs:</p><ul>
<li>bug#140 (PendSV_Handler() exception stacked PC not halfword aligned).</li>
<li>bug#142 (PendSV_restore_ex may not be able to enable interrupt before returning to task).</li>
</ul>
<h1><a class="anchor" id="qpcpp_5_7_2"></a>
Version 5.7.2, 2016-09-30</h1>
<p>This is the first production release of the "dual-mode" <a class="el" href="class_q_p_1_1_q_x_k.html" title="QXK services.">QXK</a> kernel. "Dual-mode" <a class="el" href="class_q_p_1_1_q_x_k.html" title="QXK services.">QXK</a> means that <a class="el" href="class_q_p_1_1_q_x_k.html" title="QXK services.">QXK</a> supports both basic-threads (BC1 class from the OSEK/VDX RTOS specification) as well as extended-threads (EC1 class from the OSEK/VDX RTOS specification. In other words, <a class="el" href="class_q_p_1_1_q_x_k.html" title="QXK services.">QXK</a> executes active objects (basic threads) like the <a class="el" href="class_q_p_1_1_q_k.html" title="QK services.">QK</a> kernel using the single stack (Main Stack on ARM Cortex-M), but can also execute traditional <em>blocking</em> threads (extended threads).</p>
<p>Only the extended threads (<a class="el" href="class_q_p_1_1_q_x_thread.html" title="Extended (blocking) thread of the QXK preemptive kernel.">QP::QXThread</a> class) need their private stack spaces and the overhead of the full context switch. The basic threads (<a class="el" href="class_q_p_1_1_q_m_active.html" title="QMActive active object (based on QP::QMsm implementation)">QP::QMActive</a> and <a class="el" href="class_q_p_1_1_q_active.html" title="QActive active object (based on QP::QHsm implementation)">QP::QActive</a> classes) run efficiently using the main stack with much lower context switch overhead.</p>
<p>The <a class="el" href="class_q_p_1_1_q_x_k.html" title="QXK services.">QXK</a> examples have been updated for more thorough demonstration of the <a class="el" href="class_q_p_1_1_q_x_k.html" title="QXK services.">QXK</a> features. The <a class="el" href="class_q_p_1_1_q_x_k.html" title="QXK services.">QXK</a> examples are available in the following directories: dpp_efm32-slstk3401a, dpp_ek-tm4c123gxl, and dpp_nucleo-l053r8.</p>
<p>This release also changes the internal <a class="el" href="class_q_p_1_1_q_k.html" title="QK services.">QK</a> implementation to match the terminology applied in the <a class="el" href="class_q_p_1_1_q_x_k.html" title="QXK services.">QXK</a> kernel (e.g., <a class="el" href="qk_8hpp.html#afe93da1e870c6b1c749d69b01847e85e" title="QK scheduler finds the highest-priority thread ready to run.">QK_sched_()</a> has been renamed to <a class="el" href="qk_8hpp.html#a66f8c70043c85b83fee5fc6eab93d8ba" title="QK activator activates the next active object. The activated AO preempts.">QK_activate_()</a> and QK_schedPrio_() to <a class="el" href="qk_8hpp.html#afe93da1e870c6b1c749d69b01847e85e" title="QK scheduler finds the highest-priority thread ready to run.">QK_sched_()</a>). These changes fall into the category of refactoring and have no impact on the API or performance.</p>
<p>Finally, this release improves the implementation of scheduler locking in publish-subscribe event delivery.</p>
<h1><a class="anchor" id="qpcpp_5_7_0"></a>
Version 5.7.0, 2016-08-31</h1>
<p>This release adds support for sub-machines and sub-machine states for reusing pieces of state machines (an advanced UML concept) to the QMsm-state machine implementation strategy. This feature is to match the upcoming QM 4.0.0.</p>
<p>Also, this release adds support for the ARM Cortex-R processor. Specifically, the release contains a generic port to ARM Cortex-R with the IAR and TI-CCS toolsets and <a class="el" href="arm-cr_dpp_launchxl2-tms57012.html">examples for the TI Hercules TMS570LS12x</a> safety MCU (LAUNCHPADXL2-TMS57012).</p>
<p>Also, this release changes once more the <a class="el" href="class_q_p_1_1_q_k.html" title="QK services.">QK</a> port to ARM Cortex-M, to reduce the interrupt latecy. This has been achieved by shortening the critical section in the PendSV exception. Also, this <a class="el" href="class_q_p_1_1_q_k.html" title="QK services.">QK</a> port to Cortex-M no longer uses the NMI exception.</p>
<p>Also, this release changes slightly the <a class="el" href="class_q_p_1_1_q_x_k.html" title="QXK services.">QXK</a> port to ARM Cortex-M, where again the critical section in PendSV has been slighly shortened.</p>
<p>Finally, this release replaces all absolute paths with relative paths in all CCS-Eclipse project files (for TivaC, Hercules, and MSP430).</p>
<p>Changes in detail:</p>
<ol type="1">
<li>Modified <a class="el" href="qep__msm_8cpp.html" title="QP::QMsm implementation.">qep_msm.cpp</a> to correct the support for sub-machines and sub-machine states</li>
<li>Added new port to ARM Cortex-R in the directory ports/arm-cr</li>
<li>Added examples for ARM Cortex-R in the directory examples/arm-cr</li>
<li>Modified the ARM Cortex-M <a class="el" href="class_q_p_1_1_q_k.html" title="QK services.">QK</a> ports (ARM-KEIL, GNU, IAR, and TI)</li>
<li>Modified the ARM Cortex-M <a class="el" href="class_q_p_1_1_q_x_k.html" title="QXK services.">QXK</a> ports (ARM-KEIL, GNU, IAR, and TI)</li>
</ol>
<h1><a class="anchor" id="qpcpp_5_6_5"></a>
Version 5.6.5, 2016-06-06</h1>
<p>This release adds support for the new board: EFM32-SLSTK3401A (Pearl Gecko Starter Kit from Silicon Labs). This board replaces the Stellaris EK-LM3S811 board, which has been discontinued. (The Stellaris EK-LM3S811 board had been used in the "Fly 'n' Shoot" game example accompanying the PSiCC2 book).</p>
<p>This release also introduces a new version of the QWIN GUI Toolkit in the Windows prototypes for the "Fly 'n' Shoot" game and the DPP-GUI version (see <a href="https://www.state-machine.com/products/index#QWIN">https://www.state-machine.com/products/index#QWIN</a>).</p>
<p>Additionally, this release also includes the QP/C integration with the emWin emgedded GUI from SEGGER, which is also the same product as uC/GUI distributed by Micrium (<a class="el" href="exa_emwin.html">emWin Embedded GUI</a>).</p>
<p>Finally, this relase comes with updated project files for TI Code Composer Studio (both for ARM Cortex-M and for MSP430).</p>
<p>This release fixes the following bugs:</p><ul>
<li>bug#130 (POSIX port stop-&gt;start leads to reuse of sestroyed mutex).</li>
<li>bug#131 (<a class="el" href="class_q_p_1_1_q_f.html#acc01bf7f20f6517953de5ef28af442fb" title="Internal QF implementation of creating new event reference.">QP::QF::newRef_()</a> increments reference counter without QF_CRIT_ENTRY_()).</li>
</ul>
<h1><a class="anchor" id="qpcpp_5_6_4"></a>
Version 5.6.4, 2016-04-25</h1>
<p>This release fixes a serious Bug #128 (<a href="https://sourceforge.net/p/qpc/bugs/128">https://sourceforge.net/p/qpc/bugs/128</a> ) in the <a class="el" href="class_q_p_1_1_q_k.html" title="QK services.">QK</a> port to ARM Cortex-M introduced back in <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> 5.6.1</p>
<h1><a class="anchor" id="qpcpp_5_6_3"></a>
Version 5.6.3, 2016-04-12</h1>
<p>This release fixes a serious Bug #127 (<a href="https://sourceforge.net/p/qpc/bugs/127">https://sourceforge.net/p/qpc/bugs/127</a> ) in the <a class="el" href="class_q_p_1_1_q_k.html" title="QK services.">QK</a> preemptive scheduler introduced in <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> 5.6.2.</p>
<h1><a class="anchor" id="qpcpp_5_6_2"></a>
Version 5.6.2, 2016-03-31</h1>
<p>The main purpose of this release is to introduce <em>atomic event multicasting</em>, meaning that event publishing to all subscribers is now protected from preemption. This eliminates potential for re-ordering of events under preemptive kernels (such as <a class="el" href="class_q_p_1_1_q_k.html" title="QK services.">QK</a>, <a class="el" href="class_q_p_1_1_q_x_k.html" title="QXK services.">QXK</a>, or 3rd-party RTOSes), when events are published from low-priority AOs and some higher-priority subscribers can preempt multicasting and post/publish events of their own (before the original event is posted to all subscribers).</p>
<p>The atomic event multicasting is implemented by means of selective scheduler locking&ndash;very much like a priory-ceiling mutex. During event multicasting the scheduler gets locked, but only up to the highest-priority subscriber to a given event. The whole point here is that active objects with priorities above such "priority ceiling" are <em>not</em> affected. Please see the discussion thread:</p>
<p><a href="https://sourceforge.net/p/qpc/discussion/668726/thread/c186bf45">https://sourceforge.net/p/qpc/discussion/668726/thread/c186bf45</a></p>
<p>This release also changes the implementation of the priority-ceiling mutex in the preemptive built-in kernels: <a class="el" href="class_q_p_1_1_q_k.html" title="QK services.">QK</a> and <a class="el" href="class_q_p_1_1_q_x_k.html" title="QXK services.">QXK</a>. Specifically, the implementation now re-uses the selective scheduler locking mechanism. In this new implementation, the <a class="el" href="class_q_p_1_1_q_x_mutex.html" title="Priority Ceiling Mutex the QXK preemptive kernel.">QXMutex</a> of the <a class="el" href="class_q_p_1_1_q_x_k.html" title="QXK services.">QXK</a> kernel is much more efficient and lightweight, but it <em>cannot block</em> while holding a mutex.</p>
<p>Finally, this release changes the <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> ports to 3rd-party RTOSes by performing any RTOS operations (like posting events to message queues) outside critical sections. Also the ports have been augmented to support scheduler locking (this feature depends on what's available in the specific RTOSes).</p>
<p>Changes in detail:</p>
<ol type="1">
<li>Added scheduler locking to <a class="el" href="class_q_p_1_1_q_f.html#af3b38af4b7b4aecc95b1a36d141e873a" title="Publish event to the framework.">QF::publish_()</a> in <a class="el" href="qf__ps_8cpp.html" title="QF/C++ Publish-Subscribe services definitions.">qf_ps.cpp</a>. This feature is added in a portable way, via macros QF_SCHED_STAT_TYPE_, <a class="el" href="qk_8hpp.html#ac14354c79432577621af7b82e9f92de5" title="Internal macro for selective scheduler locking.">QF_SCHED_LOCK_()</a> and <a class="el" href="qk_8hpp.html#ae105405c9dde7fbeb959f318d0c9ac6d" title="Internal macro for selective scheduler unlocking.">QF_SCHED_UNLOCK_()</a>, which need to be implemented in every <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> port.</li>
<li>Modified <a class="el" href="class_q_p_1_1_q_v.html" title="QV services.">QV</a> kernel to provide (dummy) implementation of selective scheduler locking.</li>
<li>Modified <a class="el" href="class_q_p_1_1_q_k.html" title="QK services.">QK</a> kernel to implement selective scheduler locking via modified priority-ceiling mutex QMutex.</li>
<li>Modified <a class="el" href="class_q_p_1_1_q_x_k.html" title="QXK services.">QXK</a> kernel to implement selective scheduler locking via modified priority-ceiling mutex <a class="el" href="class_q_p_1_1_q_x_mutex.html" title="Priority Ceiling Mutex the QXK preemptive kernel.">QXMutex</a>.</li>
<li>Modified embOS port to provide (global) scheduler locking, which affects all priorities, because that's all embOS supports. Also, modified the embOS port to perform event posting outside the <a class="el" href="class_q_p_1_1_q_f.html" title="QF services.">QF</a> critical section.</li>
<li>Modified uC/OS-II port to provide (global) scheduler locking, which affects all priorities, because that's all uC/OS-II supports. Also, modified the uC/OS-II port to perform event posting outside the <a class="el" href="class_q_p_1_1_q_f.html" title="QF services.">QF</a> critical section.</li>
<li>Modified ThreadX port to provide selective scheduler locking, by means of "priority-threshold" available in ThreadX. Also, modified the ThreadX port to perform event posting outside the <a class="el" href="class_q_p_1_1_q_f.html" title="QF services.">QF</a> critical section.</li>
<li>Changed the ThreadX example to run on ARM Cortex-M4 board (STM32DiscoveryF4), instead of Win32 emulation (see qpcpp/examples/threadx/arm-cm/dpp_stm32f429-discovery).</li>
<li>Modified the Win32 port to provide (global) scheduler locking, which is implemented by Win32 critical section.</li>
<li>Fixed Bug#122 (<a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> didn't initiate some internal variables) <a href="https://sourceforge.net/p/qpc/bugs/122/">https://sourceforge.net/p/qpc/bugs/122/</a> by adding explicit clearing of all <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> variables in <a class="el" href="class_q_p_1_1_q_f.html#a2858154e2009b0e6e616f313177762bc" title="QF initialization.">QF::init()</a>.</li>
<li>Modified the POSIX port to dummy-out scheduler locking. This means that this port currently does NOT lock scheduler around event publishing. (At this point it is not clear how to implement POSIX scheduler locking in a portable way.)</li>
<li>Modified <a class="el" href="class_q_p_1_1_q_k.html" title="QK services.">QK</a> and <a class="el" href="class_q_p_1_1_q_x_k.html" title="QXK services.">QXK</a> examples in qpcpp/examples/arm-cm/dpp_ek-tm4c123gxl to demonstrate the usage of the new priority-ceiling mutexes.</li>
<li>Fixed the 3rd-party file startup_stm32l32l1xx.c to include exceptions for Cortex-M3 (MemManage_Handler, BusFault_Handler, and UsageFault_Handler).</li>
<li>Updated the 3rd-party files for the EK-TM4C123GXL board (TivaC LaunchPad).</li>
<li>Modified Makefiles for the EK-TM4C123GXL board with GNU-ARM toolset to define the symbol TARGET_IS_TM4C123_RB1 for compatibility with the updated 3rd-party files.</li>
<li>Implemented Feature Request #110 as well as the duplicate Request #62 by adding function <a class="el" href="class_q_p_1_1_q_active.html#ad4a2e6ce9a7570c608ec12ae47b34a63" title="Flush the specified deferred queue &#39;eq&#39;.">QMActive::flushDeferred()</a></li>
</ol>
<h1><a class="anchor" id="qpcpp_5_6_1"></a>
Version 5.6.1, 2016-01-01</h1>
<p>This release is the first official (production) release of the new blocking <a class="el" href="group__qxk.html">QXK kernel</a> ("eXtended Quantum Kernel"). <a class="el" href="class_q_p_1_1_q_x_k.html" title="QXK services.">QXK</a> is a small, preemptive, priority-based, <b>blocking</b> kernel that provides most features you might expect of a traditional blocking RTOS kernel.</p>
<p><a class="el" href="class_q_p_1_1_q_x_k.html" title="QXK services.">QXK</a> has been designed specifically for applications that need to mix event-driven active objects with traditional blocking code, such as commercial middleware (TCP/IP stacks, UDP stacks, embedded file systems, etc.) or legacy software. The <a class="el" href="class_q_p_1_1_q_x_k.html" title="QXK services.">QXK</a> kernel is integrated tightly and optimally with the rest of the <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a>. It reuses all mechanisms already provided in <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a>, thus avoiding any code duplication, inefficient layers of indirection, and additional licensing costs, which are inevitable when using 3rd-party RTOS kernels to run QP/C++ applications.</p>
<dl class="section note"><dt>Note</dt><dd>The <a class="el" href="class_q_p_1_1_q_x_k.html" title="QXK services.">QXK</a> documentation is available in the QP/C Reference Manual at <a class="el" href="group__qxk.html">QXK</a></dd></dl>
<p>Additionally, this release removes the macros Q_ROM, Q_ROM_BYTE, and Q_ROM_VAR from the QP/C++ code. These macros have been necessary for odd Harvard-architecture 8-bit CPUs (such as AVR, 8051) to place constant data in ROM. As QP/C++ stopped supporting those CPUs, the non-standard extensions could be removed from the QP/C++ code base.</p>
<p>Additionally, this release re-designs the priority-ceiling mutex in the <a class="el" href="class_q_p_1_1_q_k.html" title="QK services.">QK</a> kernel, which now works the same as the mutex of the new <a class="el" href="class_q_p_1_1_q_x_k.html" title="QXK services.">QXK</a> kernel. Also, the <a class="el" href="class_q_p_1_1_q_k.html" title="QK services.">QK</a> ports to ARM Cortex-M no longer need or use the SVC_Handler (Supervisor Call). This is done to make the <a class="el" href="class_q_p_1_1_q_k.html" title="QK services.">QK</a> ports compatible with various "hypervisors" (such as mbed uVisor or Nordic SoftDevice), which use the SVC exception.</p>
<p>Finally, this release modifies the GNU-ARM ports of <a class="el" href="class_q_p_1_1_q_k.html" title="QK services.">QK</a> for ARM Cortex-M, to use the __ARM_ARCH macro to distinguish among different architectures (ARCHv6 vs ARCHv7).</p>
<p>Changes in detail:</p>
<ol type="1">
<li>Added new header files for <a class="el" href="class_q_p_1_1_q_x_k.html" title="QXK services.">QXK</a>: qxk.h, and qxthread.h.</li>
<li>Added new source files for <a class="el" href="class_q_p_1_1_q_x_k.html" title="QXK services.">QXK</a>: <a class="el" href="qxk_8cpp.html" title="QXK/C++ preemptive kernel core functions public interface.">qxk.cpp</a>, <a class="el" href="qxk__mutex_8cpp.html" title="Priority-ceiling blocking mutex QP::QXMutex class definition.">qxk_mutex.cpp</a>, qxk_pkg.h, <a class="el" href="qxk__sema_8cpp.html" title="QXK/C++ preemptive kernel counting semaphore implementation.">qxk_sema.cpp</a>, <a class="el" href="qxk__xthr_8cpp.html" title="QXK/C++ preemptive kernel extended (blocking) thread implementation.">qxk_xthr.cpp</a>.</li>
<li>Added <a class="el" href="class_q_p_1_1_q_x_k.html" title="QXK services.">QXK</a> ports to ARM Cortex-M for ARM-KEIL, GNU-ARM, IAR, and TI-ARM toolsets (see qpcpp/ports/arm-cm/qxk)</li>
<li>Added <a class="el" href="class_q_p_1_1_q_x_k.html" title="QXK services.">QXK</a> examples for ARM Cortex-M (in qpcpp/examples/arm-cm/dpp_ek-tm4c123gxl/qxk and qpcpp/examples/arm-cm/dpp_nucleo-l053r8/qxk) for all supported toolsets.</li>
<li>Removed Q_ROM, Q_ROM_BYTE, and Q_ROM_VAR from the QP/C++ code.</li>
<li>Added Q_ROM, Q_ROM_BYTE to the compatibility-layer in <a class="el" href="qpcpp_8h.html" title="QP/C++ public interface old-version for backwards-compatibility.">qpcpp.h</a>.</li>
<li>Removed ports and examples for the following 3rd-party RTOSes: CMSIS-RTX and FreeRTOS, as <a class="el" href="class_q_p_1_1_q_x_k.html" title="QXK services.">QXK</a> provided all the features found in those kernels and is recommended over those kernels.</li>
<li>Removed AVR ports and examples.</li>
<li>Re-designed the <a class="el" href="class_q_p_1_1_q_k.html" title="QK services.">QK</a> priority-mutex in files qk.h and qk_mutex.cpp.</li>
<li>Provided <a class="el" href="class_q_p_1_1_q_k.html" title="QK services.">QK</a> mutex examples in qpcpp/examples/arm-cm/dpp_ek-tm4c123gxl/qk and qpcpp/examples/arm-cm/dpp_nucleo-l053r8/qk.</li>
<li>Updated Makefiles for GNU-ARM to use the __ARM_ARCH macro for defining the ARM architecture.</li>
<li>Updated CMSIS from 4.2 to 4.3 in qpcpp/3rd-party/CMSIS</li>
<li>Added error directives to source files from different built-in kernels (<a class="el" href="class_q_p_1_1_q_v.html" title="QV services.">QV</a>, <a class="el" href="class_q_p_1_1_q_k.html" title="QK services.">QK</a>, and <a class="el" href="class_q_p_1_1_q_x_k.html" title="QXK services.">QXK</a>) to generate meaningful error messages when these files are mixed in one project. For example, a project based on <a class="el" href="class_q_p_1_1_q_k.html" title="QK services.">QK</a> will report errors when source files for <a class="el" href="class_q_p_1_1_q_v.html" title="QV services.">QV</a> or <a class="el" href="class_q_p_1_1_q_x_k.html" title="QXK services.">QXK</a> are included in it.</li>
<li>Corrected example projects for the ARM Cortex-M with TI/CCS toolset</li>
</ol>
<h1><a class="anchor" id="qpcpp_5_5_1"></a>
Version 5.5.1, 2015-10-05</h1>
<p>The purpose of this release is to improve the AAPCS compliance of the ARM Cortex-M port to the <a class="el" href="class_q_p_1_1_q_k.html" title="QK services.">QK</a> preemptive kernel. Specifically, the PendSV handler in assembly did not always maintain the 8-byte stack alignment, which is required by AAPCS. This version corrects the stack misalignment in the qk_port.s files for all supported ARM compilers (ARM-Keil, GNU, and IAR). All these ports should also be ready for ARM Cortex-M7.</p>
<h1><a class="anchor" id="qpcpp_5_5_0"></a>
Version 5.5.0, 2015-09-28</h1>
<p>The main purpose of this release is the extension of the <a class="el" href="class_q_p_1_1_q_s.html" title="QS logging facilities.">QS</a> software tracing system to bi-directional communication with embedded Targets. Specifically, the QS-RX (receive channel for <a class="el" href="class_q_p_1_1_q_s.html" title="QS logging facilities.">QS</a>) has been added with the following capabilities:</p>
<ol type="1">
<li>Set global <a class="el" href="class_q_p_1_1_q_s.html" title="QS logging facilities.">QS</a> filters inside the Target</li>
<li>Set local <a class="el" href="class_q_p_1_1_q_s.html" title="QS logging facilities.">QS</a> filters inside the Target</li>
<li>Inject an arbitrary event to the Target (direct post or publish)</li>
<li>Execute a user-defined callback function inside the Target with arguments supplied from QSPY</li>
<li>Peek data inside the Target and send to QSPY</li>
<li>Poke data (supplied from QSPY) into the Target</li>
<li>Execute clock tick inside the Target</li>
<li>Request target information (version, all sizes of objects, build time-stamp)</li>
<li>Remotely reset of the Target</li>
</ol>
<p>This QP/C++ version complements the recent release of Qtools 5.5.0, where the QSPY host application (<a href="https://www.state-machine.com/qspy">https://www.state-machine.com/qspy</a> ) has been extended with a UDP socket, which is open for communication with various Front-Ends (GUI-based or headless). An example Front-End written in Tcl/Tk called "QSpyView" has been developed to demonstrate all the features. The example application located in the directory qpcpp/examples/arm-cm/dpp_ek-tm4c123gxl/qspy contains customization of the "qspyview" script for the DPP application. Please refer to the documentation of this example (<a href="https://www.state-machine.com/qpcpp/arm-cm_dpp_ek-tm4c123gxl.html">https://www.state-machine.com/qpcpp/arm-cm_dpp_ek-tm4c123gxl.html</a> ) for more information.</p>
<p>Also, this release adds a state machine operation for implementing the shallow history mechanism. The operation is called "childState", because it computes a child state of a given parent, such that the child belongs to the same state hierarchy as the current state.</p>
<p>Also, this release fixes problems with QP/C++ examples for Qt. The Qt project files have been modified to build QP/C++ from sources rather than using <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> as a library.</p>
<p>Finally, this release fixes bugs #110 and #115 reported against QP/C++ on SourceForge.net.</p>
<p>Changes in detail:</p>
<ol type="1">
<li>Modified the <a class="el" href="class_q_p_1_1_q_s.html" title="QS logging facilities.">QS</a> software tracing component to add new functionality, such as the QS-RX input channel. Also added new trace records.</li>
<li>Added file "qstamp.cpp" (in the qpcpp/include/ folder) to provide time-stamp of the application build.</li>
<li>Added function <a class="el" href="class_q_p_1_1_q_msm.html#ad5ab1177bb6ba8a1ca57cf4eba6dc683" title="Obtain the current active child state of a given parent (read only)">QMsm::childStateObj()</a> to the <a class="el" href="class_q_p_1_1_q_msm.html" title="QM State Machine implementation strategy.">QMsm</a> class and <a class="el" href="class_q_p_1_1_q_hsm.html#ab5d68e62ff9cf979b6ecfa223efc676a" title="Obtain the current active child state of a given parent.">QHsm::childState()</a> to the <a class="el" href="class_q_p_1_1_q_hsm.html" title="Hierarchical State Machine base class.">QHsm</a> class. These functions have been added to support the shallow-history mechanism.</li>
<li>Modified all example projects (qpcpp/examples/ folder) to include the "qstamp.cpp" file and force its re-compilation for each new build, so that every build has an up-to-date and unique time stamp.</li>
<li>Extended the DPP on TivaC LauchPad example (directory qpcpp/examples/arm-cm/dpp_ek-tm4c123gxl/) to demonstrate QS-RX (<a class="el" href="class_q_p_1_1_q_s.html" title="QS logging facilities.">QS</a> receive channel).</li>
<li>Provided example of customizing the "QSpyView" Tcl/Tk script for the DPP application in the directory qpcpp/examples/arm-cm/dpp_ek-tm4c123gxl/qspy/</li>
<li>Modified all examples (qpcpp/examples/ folder) to call the <a class="el" href="qs_8hpp.html#ad5a514fe3724afa4a625ee2f04c1cc6a" title="Produce the assertion failure trace record.">QS_ASSERTION()</a> macro to the <a class="el" href="qassert_8h.html#a641001e43708d975152996c9229a7afc" title="Callback function invoked in case of any assertion failure.">Q_onAssert()</a> callback function.</li>
<li>Modified the startup code (in the qpcpp/3rd_party/ folder) for ARM Cortex-M to invoke the <a class="el" href="qassert_8h.html#a641001e43708d975152996c9229a7afc" title="Callback function invoked in case of any assertion failure.">Q_onAssert()</a> callback from the assert_failure() exception handler. This is to allow application-level code to define <a class="el" href="qassert_8h.html#a641001e43708d975152996c9229a7afc" title="Callback function invoked in case of any assertion failure.">Q_onAssert()</a> for each specific project.</li>
<li>Replaced deprecated registers in TM4C (TivaC) projects (SYSCTL-&gt;RCGCGPIO rather than the deprecated SYSCTL-&gt;RCGC2).</li>
<li>Fixed bug #110 "QF::init() failed to initialize the last entry in
active_[] array"</li>
<li>Fixed bug #115 "QMsm::isInState() implementation missing"</li>
</ol>
<h1><a class="anchor" id="qpcpp_5_4_2"></a>
Version 5.4.2, 2015-06-06</h1>
<p>The main focus of this release is to improve the support for "dual targeting" of QP/C++ applications, which is developing of deeply embedded code as much as possible on the desktop OS, such as Windows. Experience shows that "dual targeting" dramatically improves productivity of embedded systems developers, perhaps more than any other technique.</p>
<p>This release makes it possible to use exactly the <b>same</b> application code, main function, and the Board Support Package interface (bsp.h) on both deeply embedded target and on Windows. The only differences between these targets can be completely encapsulated in the Board Support Package implementation (bsp.cpp).</p>
<p>The support for "dual targeting" in this QP/C++ release works both for Win32 console and Win32 GUI applications. The Win32-GUI support enables developers to easily emulate the front-panels of the embedded devices, with LCD-screens (graphical and segmented), LEDs, buttons, switches, sliders, etc.</p>
<p>Changes in detail:</p>
<ol type="1">
<li>Modified the QP/C++ ports to Windows (both <a class="el" href="win32.html">Win32 API (Windows)</a> and <a class="el" href="win32-qv.html">Win32-QV (Windows with QV)</a>) so that they support both Win32 console and Win32-GUI applications. The newly introduced pre-processor <a class="el" href="macros_8hpp.html#a8f79859d1e9f6f0a55e722dfe573c547" title="Macro that should be defined (typically on the compiler&#39;s command line) in the Win32-GUI applications...">WIN32_GUI</a> macro is now required to use the Win32-GUI facilities.</li>
<li>Added portable "safe" macros from <code>&lt;stdio.h&gt;</code> and <code>&lt;string.h&gt;</code> to the QP/C++ ports to Windows. These macros encapsulate the differences between Microsoft Visual C++ and other compilers (such as MinGW).</li>
<li>Simplified the structure of the QP/C++ Windows ports by eliminating one level of directories for the compilers used. Both VC++ and MinGW builds can now be run in the same port directory.</li>
<li>Modified the <a class="el" href="class_q_p_1_1_q_f.html#aacf6bf8e121fea8b0a92d7197b73fe27" title="Function invoked by the application layer to stop the QF application and return control to the OS/Ker...">QF::stop()</a> function in the QP/C++ port to <a class="el" href="win32-qv.html">Win32-QV (Windows with QV)</a>, so that it unblocks the <a class="el" href="class_q_p_1_1_q_v.html" title="QV services.">QV</a> event-loop and thus lets the application terminate.</li>
<li>Modified all examples for Windows to use the new port structure.</li>
<li>Improved all Makefiles (for the MinGW toolset) in all Windows examples, to make them easier to adapt to custom applications, both Win32 console and Win32 GUI.</li>
<li>Moved several examples from the <code>examples/win32/</code> and examples/win32-qv directories to <code>examples/arm-cm/</code> directory with native embedded examples for ARM Cortex-M. This co-location of the Win32 emulation with the embedded code running on the actual board demonstrates better the "dual targeting" development approach.</li>
<li>Updated all Windows examples to the latest <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> API by compiling the code with the macro <a class="el" href="qpcpp_8hpp.html#a3d046e1bb0df20880186bd32a31684f0" title="Macro that specifies the backwards compatibility with the QP/C++ API version.">QP_API_VERSION</a> set to 9999 (latest API without backwards compatibility)</li>
<li>Improved the PC-Lint support for checking the application-level code located in in <code>examples/arm-cm/dpp_ek-tm4c123gxl/lint</code></li>
</ol>
<h1><a class="anchor" id="qpcpp_5_4_1"></a>
Version 5.4.1, 2015-05-21</h1>
<p>This release changes the active object class hierarchy so that <a class="el" href="class_q_p_1_1_q_m_active.html" title="QMActive active object (based on QP::QMsm implementation)">QP::QMActive</a> is now more fundamental and is the base class for <a class="el" href="class_q_p_1_1_q_active.html" title="QActive active object (based on QP::QHsm implementation)">QP::QActive</a>. (Previously <a class="el" href="class_q_p_1_1_q_m_active.html" title="QMActive active object (based on QP::QMsm implementation)">QP::QMActive</a> was a subclass of <a class="el" href="class_q_p_1_1_q_active.html" title="QActive active object (based on QP::QHsm implementation)">QP::QActive</a>). The newly added documentation section about <a class="el" href="struct.html#classes">QP/C++ Design</a> shows the current class hierarchy.</p>
<dl class="section note"><dt>Note</dt><dd>Because the types <a class="el" href="class_q_p_1_1_q_m_active.html" title="QMActive active object (based on QP::QMsm implementation)">QP::QMActive</a> and <a class="el" href="class_q_p_1_1_q_active.html" title="QActive active object (based on QP::QHsm implementation)">QActive</a> are equivalent in QP/C++, this change has minimal impact on the applications, but it is now more correct to use <a class="el" href="class_q_p_1_1_q_m_active.html" title="QMActive active object (based on QP::QMsm implementation)">QMActive</a> as the base class for all "opaque" active object pointers.</dd></dl>
<p>Also, this release brings several cosmetic improvements:</p>
<ol type="1">
<li>All QM models have been saved with QM 3.3.0, which means that they will not open with QM 3.2.x or earlier QM versions.</li>
<li>The <code>qpcpp/ports/arm-cm/qk/gnu/qk_port.s</code> ARM Cortex-M port to <a class="el" href="class_q_p_1_1_q_k.html" title="QK services.">QK</a> with GNU has been modified to use the CMSIS-compliant symbol __FPU_PRESENT instead of the FPU_VFP_V4_SP_D16 symbol.</li>
<li>All Makefiles for the GNU toolset have been cleaned up, whereas any <code>/</code> (back-slash) characters in the paths have been repalced with <code>/</code> (forward-slash) characters. Also all these Makefiles have been updated to provide the __FPU_PRESENT to C/C++ and assembler when the hardware FPU is used.</li>
<li>The file display drver for the EK-LM2S811 board locate at <code>qpc/3rd_party/ek-lm3s811/display96x16x1.c</code> has been modified to fix the problem with incorrect hardware delay with the GNU compiler at higher levels of optimization. The in-line assembly for the GNU compiler has been updated such that the delay loop cannot be "optimized away".</li>
<li>Several README files have been updated.</li>
</ol>
<h1><a class="anchor" id="qpcpp_5_4_0"></a>
Version 5.4.0, 2015-05-14</h1>
<p>This release changes the basic philosophy of distributing the <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> frameworks by <b>combining</b> the "QP/C++ Baseline Code" with all currently available "QP/C++ Development Kits" (QDK/C++). This is done to eliminate any potential mistakes in downloading and installing separate pieces of code.</p>
<p>Additionally, this release changes the basic philosophy of building your embedded applications with the QP/C++ framework. Starting with this release, all <a class="el" href="exa.html">examples</a> for embedded boards include the QP/C++ framework as <b>source code</b> within the projects, instead of statically linking with a QP/C++ library. (<b>NOTE:</b> It is still possible to use QP/C++ as a library, but you need to build such libraries yourself, as they are no longer provided in the QP/C++ distribution.)</p>
<p>The move to building QP/C++ from sources ensures the consistent toolset version and compiler options applied to the application code as well as the QP/C++ framework code. (<b>NOTE:</b> The QP/C++ examples for "big operating systems", like <a class="el" href="exa_native.html">Windows orLinux</a>, still use QP/C++ as a pre-compiled library that is statically linked with the application code.)</p>
<p>This release also changes the active object class hierarchy so that <a class="el" href="class_q_p_1_1_q_m_active.html" title="QMActive active object (based on QP::QMsm implementation)">QMActive</a> is now more fundamental and is the base class for <a class="el" href="class_q_p_1_1_q_active.html" title="QActive active object (based on QP::QHsm implementation)">QActive</a>. (Previously <a class="el" href="class_q_p_1_1_q_m_active.html" title="QMActive active object (based on QP::QMsm implementation)">QMActive</a> was a subclass of <a class="el" href="class_q_p_1_1_q_active.html" title="QActive active object (based on QP::QHsm implementation)">QP::QActive</a>). The newly added documentation section about <a class="el" href="struct.html#classes">QP/C++ Design</a> shows the current class hierarchy.</p>
<dl class="section note"><dt>Note</dt><dd>Even though the QP/C++ source has been re-packaged in this release, the changes have minimal impact on the existing QP/C++ applications. The biggest difference is that "opaque" pointers to active objects derived from <a class="el" href="class_q_p_1_1_q_m_active.html" title="QMActive active object (based on QP::QMsm implementation)">QMActive</a> now need to be also typed <a class="el" href="class_q_p_1_1_q_m_active.html" title="QMActive active object (based on QP::QMsm implementation)">QMActive</a> (as opposed to <a class="el" href="class_q_p_1_1_q_active.html" title="QActive active object (based on QP::QHsm implementation)">QActive</a>), because <a class="el" href="class_q_p_1_1_q_m_active.html" title="QMActive active object (based on QP::QMsm implementation)">QMActive</a> is no longer a subclass of <a class="el" href="class_q_p_1_1_q_active.html" title="QActive active object (based on QP::QHsm implementation)">QActive</a> and the automatic upcast no longer applies.</dd></dl>
<p>The changes in basic approach to distributing and building the framework have also the following ripple effects:</p>
<ol type="1">
<li>The QP/C++ source code has been simplified and has been re-packaged into a much smaller number of source files. The whole QP/C++ source code now resides in the single <span class="img folder"><b>source</b></span> folder. Additionally, the source code files have now the <b>read-only</b> protection to prevent inadvertent changes to the QP/C++ source code that is part of your projects.</li>
<li>It is no longer necessary to define the <b>QPCPP environment variable</b> to build the QP/C++ examples. All directories and files referenced by example projects are <b>relative</b> to the project folder. This change reflects the fact that most development tools add source files to the project using relative paths (and now the projects contain QP/C++ source code, not just the <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> library).</li>
<li>The QP/C++ <span class="img folder"><a class="el" href="ports.html">Ports</a></span> folder has been reorganized to contain all currently available QP/C++ ports. The ports are organized into three categories: <a class="el" href="ports_native.html">native QP/C++ ports</a> ("bare-metal"), <a class="el" href="ports_rtos.html">ports to 3rd-party RTOSes</a>, and <a class="el" href="ports_os.html">ports to big operating systems</a> (Windows and Linux).(<b>NOTE</b>: the ports are now documented in the this <b>QP/C++ Reference Manual</b>. Each port sub-directory contains a <span class="img qp_link">README</span> link to the corresponding page in the online documentation)</li>
<li>The QP/C++ <span class="img folder"><a class="el" href="exa.html">Examples</a></span> folder has been reorganized to reduce the repetitions and contains all currently available QP/C++ examples. The folder includes four categories of examples: <a class="el" href="exa_native.html">native QP/C++ examples</a> ("bare-metal"), <a class="el" href="exa_rtos.html">examples for 3rd-party RTOSes</a>, <a class="el" href="exa_os.html">examples for big operating systems</a> (Windows and Linux), and <a class="el" href="exa_mware.html">examples for 3rd-party Middleware</a>. As mentioned before, all example projects for embedded systems use QP/C++ as source code and not as a library. The <span class="img folder">examples</span> folder has been expanded to contain all currently available QP/C++ examples, many of them are new in this release. (<b>NOTE</b>: the currently available examples are now documented in the <b>QP/C++ Reference Manual</b>. Each example sub-directory contains a <span class="img qp_link">README</span> link to the corresponding page in the online documentation)</li>
<li>A new <span class="img folder">3rd_party</span> folder created to contain the Third-Party code used in the QP/C++ ports and examples, such as MCU register files, low-level startup code, device drivers, etc. The <span class="img folder">3rd_party</span> folder avoids the need to repeat such code in every project. Also, the separation of the Third-Party components helps to clearly indicate code that comes from various sources, and to which Quantum Leaps, LLC expressly makes <b>no claims of ownership</b>. The Third-Party software components included in this "3rd_party" folder are licensed under a variety of different licensing terms that are defined by the respective owners of this software and are spelled out in the README.txt or LICENSE.txt files included in the respective sub-folders.</li>
<li>This release also comes with the much expanded online <b>QP/C++ Reference Manual</b>, which is cross-linked with the ports and examples.</li>
</ol>
<p>Changes in detail:</p>
<ol type="1">
<li>Renamed the "Vanilla" scheduler to the <a class="el" href="struct.html#comp_qv">QV cooperative kernel</a> for symmetry with the <a class="el" href="struct.html#comp_qk">QK preemptive kernel</a>. Renamed QF::onIdle() callback to <a class="el" href="class_q_p_1_1_q_v.html#ac183489a298b22f2c25fb70491cadcce" title="QV idle callback (customized in BSPs for QK)">QV::onIdle()</a>.</li>
<li>Removed class QFsm (which is now deprecated). Legacy state machines coded in the "QFsm-style" will continue to work, but will use the <a class="el" href="class_q_p_1_1_q_hsm.html" title="Hierarchical State Machine base class.">QHsm</a> implementation internally. There is no longer any efficiency advantage in using the "QFsm-style" state machines.</li>
<li>Applied a slight performance improvement to the ARM Cortex-M port to the <a class="el" href="class_q_p_1_1_q_k.html" title="QK services.">QK</a> preemptive kernel. The <a class="el" href="class_q_p_1_1_q_k.html" title="QK services.">QK</a> port now checks for ISR context by looking at the IPSR register, instead of incrementing and decrementing the <code>QK_intNest_</code> up-down counter.</li>
<li>Updated <a class="el" href="exa_arm-cm.html">ARM Cortex-M examples</a> and provided new examples for NXP mbed-LPC1768, and STM32 NUCLEO-L053R8, and NUCLEO-L152RE boards. All examples now use the latest CMSIS (V4.3.0). All ARM Cortex-M exampels are provided for the ARM-KEIL, GNU-ARM, and IAR-ARM toolsets.</li>
<li>Added the native <a class="el" href="arm7-9.html">port</a> and <a class="el" href="exa_arm7-9.html">examples</a> to the <a class="el" href="arm7-9.html">classic ARM7/9</a> with AT91SAM7S-EK board and the IAR-ARM toolset.</li>
<li>Added the native port and examples to the AVR (AVRmega) with GNU-AVR and IAR-AVR toolsets. The examples are provided for the Arduino-UNO board.</li>
<li>Added the native <a class="el" href="msp430.html">port</a> and <a class="el" href="exa_msp430.html">examples</a> to MSP430 with TI CCS-430 and IAR-430 toolsets. The <a class="el" href="exa_msp430.html">examples</a> are provided for the MSP430 LauchPad board (MSP-EXP430F5529LP for the "classic" MSP430 and "extened" MSP430X).</li>
<li>Added port to CMSIS-RTOS RTX. Examples are available for TI EK-TM4C123GLX, STM32 NUCLEO-L053R8, and NUCLEO-L152RE boards with ARM-KEIL, GNU-ARM, and IAR-ARM toolsets.</li>
<li>Updated port to <a class="el" href="embos.html">embOS</a>. Examples are available for STM32 STM32F4-Discovery board with IAR-ARM toolset.</li>
<li>Updated port to <a class="el" href="freertos.html">FreeRTOS</a> for the latest version 8.2.1. Examples are available for TI EK-TM4C123GLX board with GNU-ARM and IAR-ARM toolsets.</li>
<li>Added <a class="el" href="threadx.html">port to Thread-X</a>. Example is available for the Thread-X demo with Visual Studio on Windows.</li>
<li>Updated port to <a class="el" href="ucos-ii.html">uC/OS-II</a> for the latest version v2.92. Examples are available for TI EK-TM4C123GLX and STM32 NUCLEO-L152RE boards with ARM-KEIL and IAR-ARM toolsets.</li>
<li>Updated <a class="el" href="win32.html">port to Win32</a> (Windows). Modified the port to apply a generous "fudge factor" in over-sizing <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> event queues and event pools, to minimize the risk of overflowing queues/pools due to non-deterministic Windows behavior.</li>
<li>Updated the <a class="el" href="qt.html">QP-Qt Port</a> (QP/C++ port to the Qt cross-platform GUI framework).</li>
<li>Added new <a class="el" href="win32-qv.html">port to Win32-QV</a> (Windows with cooperative "Vanilla" scheduler, previously known as Win32-1T).</li>
<li>Updated the <a class="el" href="lwip_ek-lm3s6965.html">lwIP-QP example for EK-LM3S6965 board</a>.</li>
</ol>
<h1><a class="anchor" id="qpcpp_5_3_1"></a>
Version 5.3.1, 2014-09-20</h1>
<p>/note QP/C++ 5.3.1 remains backwards-compatible with all QP/C++ ports and applications</p>
<p>This release fixes the following bugs:</p>
<ol type="1">
<li><a class="el" href="class_q_p_1_1_q_msm.html#aecd7c807d27c7067a189f7bab4fd0a03" title="Tests if a given state is part of the active state configuration.">QMsm::isInState()</a> returns invalid result (bug #105)</li>
<li><a class="el" href="class_q_p_1_1_q_f.html#a7d5f70fa40bdb5a9ed3524c5309be685" title="Recycle a dynamic event.">QF::gc()</a> doc typo (bug #102)</li>
<li>POSIX-port Makefile error (bug #65)</li>
<li>Problematic friendship to extern "C" function in qf.h (bug #106)</li>
</ol>
<p>Also, this release updates the PC-Lint options and removes all the remaining PC-Lint warnings for the latest PC-Lint 9.00k.</p>
<p>Additionally, this release improves the uC/OS-II port in that it is now generic and applicable for any CPU, for which uC/OS-II port exists. Specifically, all references to DOS or x86 have been removed from the <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> port and any CPU-specific dependencies have been placed in the separate part of the port.</p>
<p>Finally, this release improves the "QP/C++ Reference Manual" generated by Doxygen and available both inside the QP/C++ baseline distribution (qpcpp.chm file) and online at: <a href="https://www.state-machine.com/qpcpp">https://www.state-machine.com/qpcpp</a></p>
<h1><a class="anchor" id="qpcpp_5_3_0"></a>
Version 5.3.0, 2014-04-14</h1>
<p>This release adds the "transition to history" (deep history) feature to both <a class="el" href="class_q_p_1_1_q_hsm.html" title="Hierarchical State Machine base class.">QHsm</a> and <a class="el" href="class_q_p_1_1_q_msm.html" title="QM State Machine implementation strategy.">QMsm</a> state machines and their subclasses. This QP/C++ release matches the new QM modeling tool version 3.1.0, which now supports the "transition to history" connector and the corresponding code generation for transitions to history.</p>
<p>/note QP/C++ 5.3.0 remains backwards-compatible with QP/C++ applications developed for QP/C++ 4.x and QP/5.x. However, any QM models created for the previous QP/C++ versions require re-generating the code with QM 3.1.0.</p>
<p>This release adds new <a class="el" href="class_q_p_1_1_q_s.html" title="QS logging facilities.">QS</a> (Quantum Spy) instrumentation for tracing transitions to history as well as entry and exit points in submachines. All these features require the matching QSPY host application included in Qtools 5.3.0.</p>
<p>Additionally, the <a class="el" href="class_q_p_1_1_q_msm.html" title="QM State Machine implementation strategy.">QMsm</a> state machine has been extended to add implementation of the reusable submachine states and submachines with entry points and exit points. The reusable submachines in QP/C++ 5.3.0 lay the groundwork for providing reusable submachine states and submachine diagrams in the next upcoming QM version.</p>
<p>This release also uses the C99 data types uint_fast8_t and uint_fast16_t instead of the non-standard uint_t.</p>
<p>Finally, this QP/C++ release brings deep changes in the source code comments and the doxygen documentation generated from the source code. All comments have now more consistent structure, and every function is now documented in the implementation file (.cpp file), whereas the interface (.h files) contain only the brief descriptions of the functions. This re-structuring of documentation is performed as part of the validation and verification effort that has begun to provide a certification package for QP/C++ for safety standards, such as IEC 61508 and ISO 62304 (FDA 510(k)).</p>
<p>Changes in detail:</p>
<ol type="1">
<li>Moved detailed documentation of functions from the header files (.h) to implementation files (.cpp).</li>
<li>Removed the header file "qevt.h" and merged its contents into "qep.h"</li>
<li>Added macros: trace records QS_QEP_TRAN_HIST, QS_QEP_TRAN_EP, and QS_QEP_TRAN_XP to "qs.h"</li>
<li>Added macros: <a class="el" href="qpcpp_8hpp.html#ac927f38462ffb9c8cca4e4f2920f8fcd">Q_TRAN_HIST()</a>, <a class="el" href="qpcpp_8hpp.html#a14349d32e3cde9c71e97bb6935ea448e">QM_TRAN_HIST()</a>, <a class="el" href="qpcpp_8hpp.html#a649323882007687fa56f0be276987bcc">QM_TRAN_EP()</a>, <a class="el" href="qpcpp_8hpp.html#acfe0428063ed55b051d99585baf01173">QM_TRAN_XP()</a>, and <a class="el" href="qpcpp_8hpp.html#a71b78461fb1400313719808b30992efc">QM_SUPER_SUB()</a> to "qep.h"</li>
<li>Added attributes entryAction and initAction to the <a class="el" href="namespace_q_p.html#struct_q_p_1_1_q_m_state" title="State object for the QP::QMsm class (QM State Machine).">QMState</a> struct in "qep.h" (needed for transition to history).</li>
<li>Added attribute act to the QP::QMAttr union in "qep.h" (needed for transitions to entry point in submachine states).</li>
<li>Changed the QState return type from action/state handler functions to uint_fast8_t.</li>
<li>Added QM models to the "Transition to History" design pattern example (directory qpcpp/examples/win32/mingw/history) and also added an example for "Transition to History" with the <a class="el" href="class_q_p_1_1_q_msm.html" title="QM State Machine implementation strategy.">QMsm</a> class (see qpcpp/examples/win32/mingw/history_qm).</li>
<li>Changed the m_prio attribute of <a class="el" href="class_q_p_1_1_q_active.html" title="QActive active object (based on QP::QHsm implementation)">QActive</a> to uint_fast8_t.</li>
<li>Changed the type of prio argument to uint_fast8_t and qlen/stkSize to uint_fast16_t in the signature of <a class="el" href="class_q_p_1_1_q_active.html#ad30cc525bc2eb71b4821409bfddd45c3" title="Starts execution of an active object and registers the object with the framework.">QActive::start()</a></li>
<li>Changed the type of the tickRate argument in <a class="el" href="class_q_p_1_1_q_time_evt.html" title="Time Event class.">QTimeEvt</a> constructor and <a class="el" href="class_q_p_1_1_q_f.html#ae0fe12cc6c6133b85bbfd5c73a7d1cb8" title="Processes all armed time events at every clock tick.">QP::QF::tickX_()</a>, and <a class="el" href="class_q_p_1_1_q_f.html#a43a22a9498bb572f243a294a764db83b" title="Returns true if all time events are inactive and false any time event is active.">QP::QF::noTimeEvtsActiveX()</a> to uint_fast8_t.</li>
<li>Changed the type of the poolSize argument in <a class="el" href="class_q_p_1_1_q_f.html#ab81f33393cd2fe6390bd451dad555545" title="Event pool initialization for dynamic allocation of events.">QP::QF::poolInit()</a> to uint_fast16_t.</li>
<li>Changed arguments evtSize and margin in <a class="el" href="class_q_p_1_1_q_f.html#a96f78ae7178a02a2bb60889d413c6df4" title="Internal QF implementation of creating new dynamic event.">QP::QF::newX_()</a> to uint_fast16_t.</li>
<li>Changed attribute bits in QPSet8 as well as bytes and bits[] in QPSet64 to uint_fast8_t.</li>
<li>Changed the QEQueueCtr event queue counter type to uint_fast8_t.</li>
<li>Changed type of arguments qLen and margin in <a class="el" href="class_q_p_1_1_q_e_queue.html#a77ee07175cee4d2095a786efd382af21" title="Initializes the native QF event queue.">QP::QEQueue::init()</a> and QEQueue/QActive::post() to uint_fast16_t.</li>
<li>Changed the return type from QK_schedPrio_() (priority) as well as the p argument in <a class="el" href="qk_8hpp.html#afe93da1e870c6b1c749d69b01847e85e" title="QK scheduler finds the highest-priority thread ready to run.">QK_sched_()</a> and QK_schedExt_() to uint_fast8_t</li>
<li>Added function <a class="el" href="class_q_p_1_1_q_msm.html#aecd7c807d27c7067a189f7bab4fd0a03" title="Tests if a given state is part of the active state configuration.">QMsm::isInState()</a> to "qep.h" and its implementation file qmsm_in.cpp. This function tests whether the <a class="el" href="class_q_p_1_1_q_msm.html" title="QM State Machine implementation strategy.">QMsm</a> state machine (or its subclasses like <a class="el" href="class_q_p_1_1_q_m_active.html" title="QMActive active object (based on QP::QMsm implementation)">QMActive</a>) "is in" the given state.</li>
<li>Updated all make scripts for QP/C++ ports to include the new qmsm_in.cpp in the QP/C++ library builds.</li>
</ol>
<h1><a class="anchor" id="qpcpp_5_2_1"></a>
Version 5.2.1, 2014-01-06</h1>
<p>This release fixes two bugs.</p>
<ol type="1">
<li>In file qmsm_dis.cpp added saving of the action-table into a temporary variable <em>before</em> exiting the current state to the transition source. Also, changed the signature of the QMsm::msm_tran() helper function to take the action table as parameter. NOTE: This bug only affected the Spy configuration and because of this escaped regression testing. The internal testing process have been updated to test all build configurations: Debug, Release, and Spy.</li>
<li>In file qs_mem.cpp fixed an error in accounting used bytes in the <a class="el" href="class_q_p_1_1_q_s.html" title="QS logging facilities.">QS</a> trace buffer.</li>
</ol>
<h1><a class="anchor" id="qpcpp_5_2_0"></a>
Version 5.2.0, 2013-12-28</h1>
<p>This release matches the new QM 3.0.0, for which it provides model examples based on the new QMsm/QMActive classes. This, in turn demonstrates the new state machine code generation that QM3 was specifically designed to do.</p>
<p>This release also provides a clearly separated API compatibility layer, whereas you can configure a level of backwards compatibility by means of the <a class="el" href="qpcpp_8hpp.html#a3d046e1bb0df20880186bd32a31684f0" title="Macro that specifies the backwards compatibility with the QP/C++ API version.">QP_API_VERSION</a> macro. This facilitates migrating existing <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> applications to the newer API.</p>
<p>An cyclomatic complexity (McCabe V(G)) analysis of this version has been performed and the maximum V(G) complexity per function has been reduced to 15 by breaking up the <a class="el" href="class_q_p_1_1_q_hsm.html#a4be5d9e5ceb53df30eb02f299e5a41fc" title="Dispatches an event to QHsm.">QHsm::dispatch()</a> function. The code metrics report, including cyclomatic complexity by function as well as other standard code metrics (e.g., lines of code), is now included in the "QP/C++ Reference Manual", see <a href="https://www.state-machine.com/qpcpp/metrics.html">https://www.state-machine.com/qpcpp/metrics.html</a></p>
<p>Also, in this release all internal <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> data that were previously uninitialized are now explicitly initialized to zero. In other words, this release no longer assumes that all uninitialized data (global and static inside functions) is implicitly initialized to zero before the control is transferred to main(). This is a requirement of the C Standard, but some embedded startup code fails to do this.</p>
<p>Finally, this release demonstrates safer stack allocation and safer exception handlers in all ARM Cortex-M examples. The techniques are described in the Embedded.com article "Are We Shooting Ourselves in the
Foot with Stack Overflow?".</p>
<p>Changes in detail:</p>
<ol type="1">
<li>for backwards compatibility, in file qp_port.h defined "API
Compatibility Layer", which is controlled by the macro <a class="el" href="qpcpp_8hpp.html#a3d046e1bb0df20880186bd32a31684f0" title="Macro that specifies the backwards compatibility with the QP/C++ API version.">QP_API_VERSION</a>. For example, specifying QP_API_VERSION=500 chooses API compatible with <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> version 5.0.0 or newer, but excludes APIs that became deprecated in the earlier versions. If the macro <a class="el" href="qpcpp_8hpp.html#a3d046e1bb0df20880186bd32a31684f0" title="Macro that specifies the backwards compatibility with the QP/C++ API version.">QP_API_VERSION</a> is not defined by the user (typically on the command line for the compiler), the default value of 0 is assumed. This default means maximum backwards compatibility (from version 0.0.0). On the other hand, higher values of <a class="el" href="qpcpp_8hpp.html#a3d046e1bb0df20880186bd32a31684f0" title="Macro that specifies the backwards compatibility with the QP/C++ API version.">QP_API_VERSION</a> mean less backwards compatibility. For example QP_API_VERSION=9999 will specify compatibility only with the latest version of <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a>. The API Compatibility Layer for QP_API_VERSION &lt; 500 provides macros: postLIFO(), publish(), and tick(). These macros resolve to <a class="el" href="qf_8hpp.html#a46e898fd379bdf4753e803b10d2c6f8f" title="Invoke the direct event posting facility QP::QActive::post_().">POST()</a>, <a class="el" href="qf_8hpp.html#ac809aab93c0c4cb303ecc39b8e3825e2" title="Invoke the event publishing facility QP::QF::publish_(). This macro.">PUBLISH()</a>, and <a class="el" href="qf_8hpp.html#a9a12c5b2f250d8d874a2ec0ba72a0676" title="Invoke the system clock tick processing QP::QF::tickX_().">TICK_X()</a> respectively.</li>
<li>In file qhsm_dis.cpp, broken up the function <a class="el" href="class_q_p_1_1_q_hsm.html#a4be5d9e5ceb53df30eb02f299e5a41fc" title="Dispatches an event to QHsm.">QHsm::dispatch()</a> into two functions <a class="el" href="class_q_p_1_1_q_hsm.html#a4be5d9e5ceb53df30eb02f299e5a41fc" title="Dispatches an event to QHsm.">QHsm::dispatch()</a> and a private helper <a class="el" href="class_q_p_1_1_q_hsm.html#ae1744b1d839f025e54593738f1621135" title="internal helper function to take a transition in QP::QHsm">QHsm::hsm_tran()</a>. This has reduced the cyclomatic complexity from 25 for the original function, to 11 and 15 for QHsm::dispatch_() and <a class="el" href="class_q_p_1_1_q_hsm.html#ae1744b1d839f025e54593738f1621135" title="internal helper function to take a transition in QP::QHsm">QHsm::hsm_tran()</a>, respectively.</li>
<li>In file qmsm_dis.cpp, broken up the function <a class="el" href="class_q_p_1_1_q_msm.html#acaca8e70c22982e3df53508092ea5881" title="Dispatches an event to a HSM.">QMsm::dispatch()</a> into two functions <a class="el" href="class_q_p_1_1_q_msm.html#acaca8e70c22982e3df53508092ea5881" title="Dispatches an event to a HSM.">QMsm::dispatch()</a> and a private helper QMsm::msm_tran(). This has reduced the cyclomatic complexity from 15 for the original function, to 9 and 7 for <a class="el" href="class_q_p_1_1_q_msm.html#acaca8e70c22982e3df53508092ea5881" title="Dispatches an event to a HSM.">QMsm::dispatch()</a> and QMsm::msm_tran(), respectively.</li>
<li>Changed QM models dpp.qm and game.qm to use <a class="el" href="class_q_p_1_1_q_m_active.html" title="QMActive active object (based on QP::QMsm implementation)">QMActive</a> and <a class="el" href="class_q_p_1_1_q_msm.html" title="QM State Machine implementation strategy.">QMsm</a> base classes instead of <a class="el" href="class_q_p_1_1_q_active.html" title="QActive active object (based on QP::QHsm implementation)">QActive</a> and <a class="el" href="class_q_p_1_1_q_hsm.html" title="Hierarchical State Machine base class.">QHsm</a>, to showcase the new code generation capabilities of QM3.</li>
<li>Added the QMsmTst example application analogous to the QHsmTst to test the <a class="el" href="class_q_p_1_1_q_msm.html" title="QM State Machine implementation strategy.">QMsm</a> base class. The QMsmTst comes with the QM model qmsmtst.qm.</li>
<li>In file <a class="el" href="qf__act_8cpp.html" title="QP::QActive services and QF support code.">qf_act.cpp</a> added the function <a class="el" href="class_q_p_1_1_q_f.html#a996109d745da0df30e1ac64d2975ee01" title="Clear a specified region of memory to zero.">QF::bzero()</a>, and in files qvanilla.cpp and <a class="el" href="qk_8cpp.html" title="QK/C++ preemptive kernel core functions.">qk.cpp</a> added calls to <a class="el" href="class_q_p_1_1_q_f.html#a996109d745da0df30e1ac64d2975ee01" title="Clear a specified region of memory to zero.">QF::bzero()</a> to explicitly clear the uninitialized data. Also added calls to <a class="el" href="class_q_p_1_1_q_f.html#a996109d745da0df30e1ac64d2975ee01" title="Clear a specified region of memory to zero.">QF::bzero()</a> inside qf_psini.cpp.</li>
<li>Updated all examples for ARM Cortex-M to use safer stack allocation and safer exception handlers in all ARM Cortex-M examples, as described in the Embedded.com article "Are We Shooting Ourselves in the Foot with
Stack Overflow?".</li>
</ol>
<h1><a class="anchor" id="qpcpp_5_1_1"></a>
Version 5.1.1, 2013-10-10</h1>
<p>This release fixes reversal of logic in the <a class="el" href="class_q_p_1_1_q_f.html#a43a22a9498bb572f243a294a764db83b" title="Returns true if all time events are inactive and false any time event is active.">QF::noTimeEvtsActiveX()</a> function as well as sleep mode transition in the ARM Cortex-M3/M4 ports to the cooperative Vanilla kernel. Also, the native <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> event queue implementation has been changed to count the extra "front-event" location into the number of free entries, which fixes the problem of defer queues of depth 1. Finally, the release restores the support for linting (with PC-Lint) of the QP/C++ applications for ARM Cortex-M (with IAR and GNU compilers).</p>
<p>Changes in detail:</p>
<ol type="1">
<li>In file qf_tick.cpp reversed the logic inside <a class="el" href="class_q_p_1_1_q_f.html#a43a22a9498bb572f243a294a764db83b" title="Returns true if all time events are inactive and false any time event is active.">QF::noTimeEvtsActiveX()</a></li>
<li>Modified free entry accounting (nFree) in the files: qeq_init.cpp, qeq_fifo.cpp, qeq_get.cpp, and qeq_lifo.cpp.</li>
<li>Modified free entry accounting (nFree) in the files: qa_init.cpp, qa_fifo.cpp, qa_get_.cpp, and qa_lifo.cpp.</li>
<li>Introduced new macro QF_CPU_SLEEP() in the ARM Cortex-M Vanilla ports.</li>
<li>Changed Board Support Package files (bsp.cpp) in the ARM Cortex-M Vanilla examples.</li>
<li>Modified the CMSIS-compliant startup code in all ARM Cortex-M Vanilla examples.</li>
<li>Modified the application examples with PC-Lint (qpcpp/examples/arm-cm/qk/gnu/dpp-qk_ek-lm3s811-lint and qpcpp/examples/arm-cm/qk/iar/dpp-qk_ek-lm3s811-lint). Updated lint files for the latest PC-Lint</li>
<li>Ported all state pattern examples to Win32/MinGW. That way, all these examples can be run and modified directly on Windows, without going back to DOS.</li>
</ol>
<h1><a class="anchor" id="qpcpp_5_1_0"></a>
Version 5.1.0, 2013-10-02</h1>
<p>/note QP/C++ 5.1.0 remains <b>backwards-compatible</b> with the existing QP/C 4.x applications, except the <b>ARM Cortex-M applications</b> need to adjust the interrupt priorities. Specifically, you need to set the interrupt priorities equal or lower than <b>QF_AWARE_ISR_CMSIS_PRI</b> constant provided in the qf_port.h header file.</p>
<p>The main purpose of this milestone QP/C++ release is to enable the QM modeling tool to generate a new type of state machine code (requires QM version 3.0.0, which is still in development as of this writing).</p>
<p>This new type of state machine implementation in QP/C++ 5 is based on the new <a class="el" href="class_q_p_1_1_q_msm.html" title="QM State Machine implementation strategy.">QP::QMsm</a> class, which takes advantage of the QM tool as an advanced "state machine compiler". QM can perform optimizations that were not possible with the C pre-processor alone. Specifically, the QM can easily determine the LCA (Least-Common-Ancestor) state for every transition and it can generate the complete transition-sequences (sequences of exit/entry/initial actions) at code-generation time. The resulting code can be still highly human-readable, but it will no longer be human-maintainable. The lab tests indicate that the new "housekeeping" code for executing hierarchical state machines can be about twice as fast as the previous code based on the <a class="el" href="class_q_p_1_1_q_hsm.html" title="Hierarchical State Machine base class.">QP::QHsm</a> class.</p>
<p>The next important change introduced in QP/C++ 5 is making several important functions in QP/C++ base classes virtual. The new virtual functions include: <a class="el" href="class_q_p_1_1_q_msm.html#aeaa351bd92e4a4a59960a6ac20fd3ea8" title="Performs the second step of SM initialization by triggering the top-most initial transition.">QMsm::init()</a> and <a class="el" href="class_q_p_1_1_q_msm.html#acaca8e70c22982e3df53508092ea5881" title="Dispatches an event to a HSM.">QMsm::dispatch()</a> and <a class="el" href="class_q_p_1_1_q_active.html#ad30cc525bc2eb71b4821409bfddd45c3" title="Starts execution of an active object and registers the object with the framework.">QActive::start()</a>, QActive::post(), and <a class="el" href="class_q_p_1_1_q_active.html#a2275d125f8bb6e87a60a2c13ee4be7a2" title="Posts an event directly to the event queue of the active object using the Last-In-First-Out (LIFO) po...">QActive::postLIFO()</a> perations. Making theses functions virtual means that all these operations can be overridden in sub-classes of state machines and active objects. This, in turn, allows a single application to use a mix of state machine classes derived from the new <a class="el" href="class_q_p_1_1_q_msm.html" title="QM State Machine implementation strategy.">QMsm</a> base class with state machines derived from the <a class="el" href="class_q_p_1_1_q_hsm.html" title="Hierarchical State Machine base class.">QHsm</a> base class, each one using a different state machine implementation strategy. Additionally, the virtual QActive::post() operation could be very useful for implementing various Proxy active objects (e.g., for active object event posting across networks).</p>
<p>Another big feature introduced in QP/C++ 5 are the multiple, independent system clock tick rates for time events. The number of system tick rates can be now configured in the QP/C++ ports. For example, a digital watch can use a "fast" clock tick rate of 100Hz and a "slow" clock tick rate of only 1Hz. These clock tick rates can be managed independently, so for example, the fast clock tick rate can be shut down in the absence of time events assigned to this rate. This feature allows the applications to implement sophisticated power-saving policies.</p>
<p>As yet another important feature, QP/C++ adds a new "extended" API for non-asserting event allocation and posting. This feature is intended for situations, where an application is hammered with external events that at times arrive too fast for processing, but that can be ignored under the overload conditions. In those cases firing an assertion inside the framework is undesirable. The non-asserting API allows a designer to request a safety-margin when allocating or posting an event. The event is not allocated/posted if the safety margin cannot be satisfied at the time of the call. On the other hand, the safety margin allows the application to still use the regular (asserting) event allocation and posting, because the event pools and event queues are guaranteed to maintain a minimal margin for safe operation.</p>
<p>Finally, this QP/C++ release brings significant improvements to the <a class="el" href="class_q_p_1_1_q_s.html" title="QS logging facilities.">QS</a> software tracing implementation and also brings important changes the ARM Cortex-M port. Changes in detail are as follows:</p>
<p>0. Removed the conditional compilation of the <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a>:: namespace based on the macro Q_NNAMESPACE. The namespace <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a>:: is now enabled permanently, which is a requirement of MISRA-C++:2004 and is also is part of the QM code generation for QP/C++. Also, the use of explicit <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a>:: namespace improves the doxygen documentation (QP/C++ Reference Manual).</p>
<ol type="1">
<li>Added the new <a class="el" href="class_q_p_1_1_q_msm.html" title="QM State Machine implementation strategy.">QMsm</a> class to qep.h. Changed the inheritance tree by deriving <a class="el" href="class_q_p_1_1_q_hsm.html" title="Hierarchical State Machine base class.">QHsm</a> and QFsm from the <a class="el" href="class_q_p_1_1_q_msm.html" title="QM State Machine implementation strategy.">QMsm</a> base class.</li>
<li>Added new source files qmsm_ini.cpp and qmsm_dis.cpp to the <a class="el" href="class_q_p_1_1_q_e_p.html" title="Provides miscellaneous QEP services.">QEP</a>. These files implement the <a class="el" href="class_q_p_1_1_q_msm.html#aeaa351bd92e4a4a59960a6ac20fd3ea8" title="Performs the second step of SM initialization by triggering the top-most initial transition.">QMsm::init()</a> and <a class="el" href="class_q_p_1_1_q_msm.html#acaca8e70c22982e3df53508092ea5881" title="Dispatches an event to a HSM.">QMsm::dispatch()</a> functions, respectively.</li>
<li>Added the new <a class="el" href="class_q_p_1_1_q_m_active.html" title="QMActive active object (based on QP::QMsm implementation)">QMActive</a> class to qf.h. Extended the inheritance tree to derive <a class="el" href="class_q_p_1_1_q_m_active.html" title="QMActive active object (based on QP::QMsm implementation)">QMActive</a> from <a class="el" href="class_q_p_1_1_q_active.html" title="QActive active object (based on QP::QHsm implementation)">QActive</a>.</li>
<li>Added the multiple system clock tick rates feature in qf.h:<ul>
<li>added new configuration macro #QF_MAX_TICK_RATE, which specifies the number of clock tick rates. This macro is to be defined in the <a class="el" href="class_q_p_1_1_q_f.html" title="QF services.">QF</a> ports (in the qf_port.h header file). If the macro is undefined, the default value is 1 (one clock tick rate).</li>
<li>renamed and re-implemented the QF::tick() function as the "extended" QF::tickX() function with the argument 'tickRate' for processing time events allocated to different clock rates. The application must call QF::tickX(0), QF::tickX(1), ... at the specified tick rates from ISRs or <em>tasks</em>.</li>
<li>added an "extended" time event constructor, which assigns a time event to a specific tick rate as well as specific active object.</li>
<li>renamed and re-implemented the internal function QTimeEvt::arm_() to a public function <a class="el" href="class_q_p_1_1_q_time_evt.html#a8cb134ea948e3a716b64d2233f161bf9" title="Arm a time event (one shot or periodic) for event posting.">QTimeEvt::armX()</a> for arming time events initialized with the "extended" constructor. The <a class="el" href="class_q_p_1_1_q_time_evt.html#a8cb134ea948e3a716b64d2233f161bf9" title="Arm a time event (one shot or periodic) for event posting.">QTimeEvt::armX()</a> function is the new recommended API for arming time events, both one-shot and periodic.</li>
<li>re-implemented <a class="el" href="class_q_p_1_1_q_time_evt.html#ab90f9368f80d3d78fc717bb1d66d5af4" title="Disarm a time event.">QTimeEvt::disarm()</a> and QTimeEvt::rarm().</li>
<li>renamed QF::noTimeEvtsActive() to the "extended" version <a class="el" href="class_q_p_1_1_q_f.html#a43a22a9498bb572f243a294a764db83b" title="Returns true if all time events are inactive and false any time event is active.">QF::noTimeEvtsActiveX()</a>, which checks time events assigned to the given tick rate.</li>
</ul>
</li>
<li>Added the new non-asserting API to qf.h:<ul>
<li>renamed internal function QF::new_() to <a class="el" href="class_q_p_1_1_q_f.html#a96f78ae7178a02a2bb60889d413c6df4" title="Internal QF implementation of creating new dynamic event.">QF::newX_()</a>, the latter one taking the argument 'margin' for allocating events. The function returns NULL if the event pool has less free events than the specified margin. The function asserts if the margin is zero and the event can't be allocated.</li>
<li>added function QActive::post() to post an event to the given active object. The function does not post the event if the target event queue has less free slots than the specified margin. The function asserts if the margin is zero and the event can't be posted.</li>
<li>added "extended" macro <a class="el" href="qf_8hpp.html#aa52b4d3c43a262022392c6e11be06436" title="Allocate a dynamic event (non-asserting version).">Q_NEW_X()</a> for allocating events with a margin.</li>
<li>added "extended" macro <a class="el" href="qf_8hpp.html#ae774afb3828695a8e6c5797de441dd2e" title="Invoke the direct event posting facility QP::QActive::post_() without delivery guarantee.">POST_X()</a> for posting events with a margin.</li>
</ul>
</li>
<li>Modified the <a class="el" href="class_q_p_1_1_q_active.html#a29446ebb1a76be27c27f62bf89cc07e4" title="Defer an event to a given separate event queue.">QActive::defer()</a> function to return the status of the defer operation (true==success), instead of asserting when the defer queue overflows.</li>
<li>Modified <a class="el" href="class_q_p_1_1_q_s.html" title="QS logging facilities.">QS</a> (Quantum Spy) software tracing implementation:<ul>
<li>Optimized the internal <a class="el" href="class_q_p_1_1_q_s.html" title="QS logging facilities.">QS</a> implementation of all functions that insert trace data into the trace buffer. The general idea of the optimization is to extensively use automatic variables instead of global variables (such as buffer head and tail indexes, the running checksum, etc.).</li>
<li>Reduced the number of <a class="el" href="class_q_p_1_1_q_s.html" title="QS logging facilities.">QS</a> global filters from 256 to 124 (0x7C). This enables the code to avoid escaping the trace record numbers</li>
<li>added additional tick rate byte to the trace records QS_QF_TICK and QS_QFF_TIMEEVT_*.</li>
<li>An empty <a class="el" href="class_q_p_1_1_q_s.html" title="QS logging facilities.">QS</a> record and the QS_RESET record are now inserted automatically into the trace buffer in the function <a class="el" href="class_q_p_1_1_q_s.html#ae1c016cb1d1695e891c08e7a5b79dbd7" title="Initialize the QS data buffer.">QS::initBuf()</a>. The empty <a class="el" href="class_q_p_1_1_q_s.html" title="QS logging facilities.">QS</a> record/QS_RESET pair provides a clean start of a session and allows the QSPY host application to re-synch with the data stream.</li>
<li>added new trace records <a class="el" href="namespace_q_p.html#a2ee815d414fbd802853c730489f13f45a856dcbb514f27abfd8ac1b9caf4bd581" title="attempt to post an evt to AO failed">QS_QF_ACTIVE_POST_ATTEMPT</a>, <a class="el" href="namespace_q_p.html#a2ee815d414fbd802853c730489f13f45a4e98ea7fef614e40e326097e38483e41" title="attempt to post an evt to QEQueue failed">QS_QF_EQUEUE_POST_ATTEMPT</a>, and <a class="el" href="namespace_q_p.html#a2ee815d414fbd802853c730489f13f45a106568feb051d89446ff5260f4268d2f" title="attempt to get a memory block failed">QS_QF_MPOOL_GET_ATTEMPT</a> for the "extened" non-asserting event allocation and posting.</li>
<li>added new trace records QS_TEST_RUN and QS_TEST_FAIL for future support for unit testing.</li>
<li>added new <a class="el" href="class_q_p_1_1_q_s.html" title="QS logging facilities.">QS</a> source file qs_dict.cpp with functions QS_*_dict() to generate various dictionary entries. Changed the macros QS_*_DICTIONARY() to call these functions. This was done to significantly reduce the amount of tracing code needed to send the dictionaries from applications.</li>
<li>grouped together the various <a class="el" href="class_q_p_1_1_q_s.html" title="QS logging facilities.">QS</a> variables (such as filters, trace buffer indexes, etc.) in a single struct, which results in a more efficient code for various <a class="el" href="class_q_p_1_1_q_s.html" title="QS logging facilities.">QS</a> operations.</li>
</ul>
</li>
<li>Changed the structure of the ARM Cortex-M ports<ul>
<li>renamed the sub-directory for ARM Cortex-M ports and examples from "arm-cortex" to "arm-cm". This is done to avoid confusion with other ARM Cortex variants, such as Cortex-A/R, which very different from Cortex-M.</li>
<li>Changed the policy of disabling interrupts for Cortex-M3/M4. For these cores, <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> 5.1.0 never completely disables interrupts, even inside the critical sections. The <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> port disables interrupts selectively using the BASEPRI register. (NOTE: The BASEPRI register is not implemented in the ARMv6-M architecture (Cortex-M0/M0+), so Cortex-M0/M0+ need to use the PRIMASK register to disable interrupts globally).</li>
<li>removed the CMSIS (Cortex Microcontroller Software Interface Standard) directories from the Cortex-M examples and moved it to the common location in the QPC%/ports/arm-cm/cmsis/ directory. Upgraded the CMSIS to the latest version 3.20.</li>
<li>added the ARM Cortex-M ports and examples with Keil/ARM MDK to the <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> Baseline Code.</li>
<li>upgraded ARM Cortex-M ports with IAR to the latest IAR EWARM 6.60</li>
<li>upgraded ARM Cortex-M ports with Sourcery CodeBench to the latest version 2013.05-53.</li>
</ul>
</li>
<li>Added the requested simple "Blinky" example for Windows and ARM Cortex-M (with the GNU, IAR, and Keil toolsets).<ul>
<li>Added "Getting Started with QP/C++" guide based on the Blinky example.</li>
</ul>
</li>
<li>Updated the Doxygen documentation (QP/C++ Reference Manual)<ul>
<li>removed the outdated tutorial section</li>
<li>updated and added documentation and code samples</li>
<li>added search box and tree-view panel to the HTML documentation</li>
</ul>
</li>
</ol>
<p>/note This new policy of disabling interrupts in ARM Cortex-M divides interrupts into "kernel-unaware" interrupts, which are never disabled, and "kernel-aware" interrupts, which are disabled in the <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> critical sections. Only "kernel-aware" interrupts are allowed to call <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> services. "Kernel-unaware" interrupts are <em>NOT</em> allowed to call any <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> services and they can communicate with <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> only by triggering a "kernel-aware" interrupt (which can post or publish events).</p>
<h1><a class="anchor" id="qpcpp_4_5_04"></a>
Version 4.5.04, 2013-02-10</h1>
<p>The main purpose of this release is adding support for the ARM Cortex-M4F processors with the hardware Floating-Point Unit (FPU). The QP/C ports to Cortex-M4F take full advantage of the "lazy stacking" feature of the FPU registers, and by doing so offer the most efficient preemptive multitasking on this processor.</p>
<p>Changes in detail:</p>
<ol type="1">
<li>Added ports and examples for ARM Cortex-M4F with the EK-LM4F120XL board (Stellaris Launchpad).</li>
<li>Added the macro <a class="el" href="namespace_q_p.html#a9037f4a4175d6f0101c247257a775e4b">QF_LOG2()</a>, which can be re-implemented in the <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> ports, if the CPU supports special instructions, such as CLZ (count leading zeros in Cortex-M3/M4). If the macro is not defined in the <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> port, the default implementation uses a lookup table.</li>
<li>Updated all ARM Cortex-M ports and examples to the latest IAR EWARM 6.50 and Sourcery CodeBench 2012.09-85.</li>
<li>Updated App Notes "QP and ARM Cortex-M with IAR" and "QP and ARM
Cortex-M with GNU".</li>
<li>Updated the PC-Lint support files (include/lib-qpcpp.lnt, au-misra2.lnt) to the latest PC-Lint 9.00j.</li>
<li>Updated the Application Note: "QP/C++ MISRA-C:2004 Compliance Matrix".</li>
<li>Spell-checked the comments in all QP/C++ source files and removed several typos.</li>
<li>Removed the Qt ports and examples from the QP/C++ Baseline Code and moved them to the separate QDK/C++-Qt.</li>
</ol>
<p>/note QP/C++ Version 4.5.04 preserves full compatibility with QM 2.2.03 and all existing QDKs for QP/C++ 4.5.xx.</p>
<h1><a class="anchor" id="qpcpp_4_5_03"></a>
Version 4.5.03, 2012-11-29</h1>
<p>This release changes the directory structure of <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> ports to various operating systems, such as POSIX (Linux, BSD, etc.), Win32 (Windows), Qt, etc. The OS ports are moved from the ports/80x86/ directory one level up to ports/. Also, the OS examples are moved from the exampels/80x86/ directory one level up to examples/.</p>
<h1><a class="anchor" id="qpcpp_4_5_02"></a>
Version 4.5.02, 2012-08-15</h1>
<p>The main purpose of this release is providing QM models in most examples and better, more comprehensive support for (rapid) prototyping of embedded <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> applications on the desktop with the Win32 API and with Qt. Among others, this release adds a complete toolkit for creating realistic embedded front panels with pure Win32-GUI API and free Visual C++ Express and ResEdit. An extensive Application Note "QP and Win32" is included in this release.</p>
<p>This <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> relase adds QM models, created with the new QM 2.2.01, to most of the examples. The code generated by this new QM version complies with MISRA-C++:2008 rules. For this compliance, the QM code generator applies the <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a>:: namespace prefix to all QP/C++ elements, such as classes, types, enumerations, etc.</p>
<p>For compliance with MISRA-C++:2008 and compatibility with QM, all QP/C++ ports in this release use the <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a>:: namespace. The namespace generation can be suppressed by providing the new configuration macro Q_NNAMESPACE, but this is generally <em>not</em> recommended, because it breaks compatiblity with the QM code generation. (In other words, a QP/C++ port without namespace cannot use the code generated by QM.)</p>
<p>This release simplifies the <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> ports to desktop OSs, such as Windows (Win32), Linux, BSD, Mac OSX (POSIX) and combines 32-bit and 64-bit ports in one with conditional compilation.</p>
<p>This release also enhances the option for using constructors for dynamically allocated events. When the configuration macro Q_EVT_CTOR is defined, the <a class="el" href="struct_q_p_1_1_q_evt.html" title="QEvt base class.">QEvt</a> class provides a non-default constructor and the <a class="el" href="qf_8hpp.html#abd823f3a9e8b3206a3460a108d5fa3e3" title="Allocate a dynamic event.">Q_NEW()</a> macro becomes variadic and takes the arguments for the event constructor. This generally allows creating dynamic events "on-the-fly" without a temporary pointer to the event. This <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> configuration is demonstrated only in the <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> port to Qt, but can be used in any other port. NOTE: The event constructor feature is NOT backward-compatible with the existing applications.</p>
<p>At the same time, the <a class="el" href="struct_q_p_1_1_q_evt.html" title="QEvt base class.">QEvt</a> class in this release provides the virtual destructor only when the new macro Q_EVT_VIRTUAL is defined. This separation of <a class="el" href="struct_q_p_1_1_q_evt.html" title="QEvt base class.">QEvt</a> constructor from virtual destructor makes the constructor more attractive, because it saves the virtual pointer in every event, if no virtual functions are used in <a class="el" href="struct_q_p_1_1_q_evt.html" title="QEvt base class.">QEvt</a> subclasses (which seems to be generally the case).</p>
<p>This release also adds a new macro QF_MPOOL_EL, which is intended for allocating properly aligned storage for memory pools and event pools.</p>
<p>Finally, all <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> ports included in this release use only a single <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> library, rather than separate libraries for <a class="el" href="class_q_p_1_1_q_e_p.html" title="Provides miscellaneous QEP services.">QEP</a>, <a class="el" href="class_q_p_1_1_q_f.html" title="QF services.">QF</a>, <a class="el" href="class_q_p_1_1_q_k.html" title="QK services.">QK</a>, and <a class="el" href="class_q_p_1_1_q_s.html" title="QS logging facilities.">QS</a>.</p>
<p>Changes in detail:</p>
<ol type="1">
<li>Modified <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> port to Win32 and used the free Visual C++ Express 2010 with Platform SDK rather than Visual C++ Pro 2008. Renamed the port directory from vc2008/ to vc/. Provided a completely revised App Note "QP and Win32".</li>
<li>Eliminated <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> port to Win32 with one thread (Win32-1T).</li>
<li>Consolidated all <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> ports to POSIX OSs (Linux, Linux64, Mac_OSX) into a single port to POSIX and placed it in the directory posix/.</li>
<li>Renamed the port directory qt_1t/ to qt/.</li>
<li>Added event constructor to qevt.h (controlled by the configuration macro Q_EVT_CTOR).</li>
<li>Added the conditional compilation with the macro Q_EVT_VIRTUAL around the virtual destructor in the <a class="el" href="struct_q_p_1_1_q_evt.html" title="QEvt base class.">QEvt</a> class.</li>
<li>Added macro QF_MPOOL_EL to qmpool.h. Modified all examples to demonstrate the use of this macro to allocate properly aligned storage for event pools.</li>
<li>Added new typedef 'enum_t' and modified signatures of functions taking event signals from QSignal to enum_t. This was done to significantly reduce the number of casts necessary when enumerated signals were passed to <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> functions.</li>
<li>Modified all <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> ports distributed in the QP/C++ baseline code to generate only a single <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> library, rather than separate libraries for <a class="el" href="class_q_p_1_1_q_e_p.html" title="Provides miscellaneous QEP services.">QEP</a>, <a class="el" href="class_q_p_1_1_q_f.html" title="QF services.">QF</a>, <a class="el" href="class_q_p_1_1_q_k.html" title="QK services.">QK</a>, and <a class="el" href="class_q_p_1_1_q_s.html" title="QS logging facilities.">QS</a>. This includes all <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> ports to the desktop (ports/80x86/ directory) and ARM Cortex-M ports (ports/arm-cortex/ directory).</li>
<li>Modified all examples to link only one <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> library.</li>
<li>Added QM models to most examples and used the automatically generated code from the models instead of the hand-written code.</li>
<li>Modified Qt ports to use the event constructors and modified examples for Qt to demonstrate this feature.</li>
<li>Added .ui files to the Qt examples for generating UIs graphically with the Qt Designer tool. Revised and updated the App Note "QP and Qt".</li>
<li>Added new macro <a class="el" href="qs_8hpp.html#ae75893daa66c6d0b5a6dfb8f3fca1196" title="Output user QS record dictionary record.">QS_USR_DICTIONARY()</a> to <a class="el" href="class_q_p_1_1_q_s.html" title="QS logging facilities.">QS</a> for providing symbolic names for user-defined trace records</li>
<li>Added new macro QS_RESET() to <a class="el" href="class_q_p_1_1_q_s.html" title="QS logging facilities.">QS</a> for telling the QSPY application when the target resets. This allows QSPY to reset its internal state.</li>
</ol>
<h1><a class="anchor" id="qpcpp_4_5_01"></a>
Version 4.5.01, 2012-06-14</h1>
<p>The main purpose of this minor release is providing improved MISRA-compliant state machine implementation. Specifically, a new macro <a class="el" href="qep_8hpp.html#a40a035a3e4679f8b35d81a7f49a6d44f" title="Macro to specify that the event was NOT handled due to a guard condition evaluating to &#39;false&#39;.">Q_UNHANDLED()</a> has been added for a situation when a guard condition evaluates to FALSE, but the state model does not prescribe the explicit [else] case for this guard. In this case, the state handler can return <a class="el" href="qep_8hpp.html#a40a035a3e4679f8b35d81a7f49a6d44f" title="Macro to specify that the event was NOT handled due to a guard condition evaluating to &#39;false&#39;.">Q_UNHANDLED()</a>, which will cause the <a class="el" href="class_q_p_1_1_q_e_p.html" title="Provides miscellaneous QEP services.">QEP</a> event processor to propagate the event to the superstate, which is what UML semantics prescribes.</p>
<p>NOTE: These change to the <a class="el" href="class_q_p_1_1_q_e_p.html" title="Provides miscellaneous QEP services.">QEP</a> event processor is completely backwards-compatible. All state hander functions coded the old way will continue to handle the guard conditions correctly and in accordance with the UML specification. The new <a class="el" href="qep_8hpp.html#a40a035a3e4679f8b35d81a7f49a6d44f" title="Macro to specify that the event was NOT handled due to a guard condition evaluating to &#39;false&#39;.">Q_UNHANDLED()</a> macro is necessary only for MISRA-compliant state handler coding, which will be applied in the upcoming release of the QM modeling and code generation tool.</p>
<p>Changes in detail:</p>
<ol type="1">
<li>Added macro <a class="el" href="qep_8hpp.html#a40a035a3e4679f8b35d81a7f49a6d44f" title="Macro to specify that the event was NOT handled due to a guard condition evaluating to &#39;false&#39;.">Q_UNHANDLED()</a> and return value Q_RET_UNHANDLED in qep.h.</li>
<li>Modified qhsm_dis.cpp to handle the Q_RET_UNHANDLED return value.</li>
<li>Updated the QP/C MISRA-C++:2008 compliance matrix to include the new MISRA-compliant way of coding guard conditions.</li>
<li>Modified qs.h and qs_dummy.h to add new trace record type QS_QEP_UNHANDLED, which is generated when the state handler returns Q_RET_UNHANDLED.</li>
<li>Modified qs.h and qs_dummy.h to add the User record dictionary trace record and macro <a class="el" href="qs_8hpp.html#ae75893daa66c6d0b5a6dfb8f3fca1196" title="Output user QS record dictionary record.">QS_USR_DICTIONARY()</a>.</li>
</ol>
<p>NOTE: This new trace record requires the updated QSPY 4.5.01.</p>
<ol type="1">
<li>Corrected qfsm_dis.cpp, which did not generate <a class="el" href="class_q_p_1_1_q_s.html" title="QS logging facilities.">QS</a> trace records for entry and exit from non-hierarchical states.</li>
<li>Updated the IAR ARM compiler used in the ARM Cortex-M examples to the latest version IAR EWARM 6.40.</li>
<li>Modified the Qt port not to define the QPApp::onClockTick() slot function, but instead to allow defining this slot function in the BSP of the application.</li>
</ol>
<h1><a class="anchor" id="qpcpp_4_5_00"></a>
Version 4.5.00, 2012-05-26</h1>
<p>The main pupose of this relase is to improve host-based development of <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> applications, which is critical for Test-Driven Development (TDD). Among others, this release provides integration between <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> and the popular Qt GUI framework, which allows developers to easily build host-based simulations of the embedded systems with the realistic user interfaces.</p>
<p>This realase also simplifies implementing transitions to history, which is a preparation to providing this feature in the QM modeling tool.</p>
<p>Changes in detail:</p>
<ol type="1">
<li>Renamed the event class from QEvent to <a class="el" href="struct_q_p_1_1_q_evt.html" title="QEvt base class.">QEvt</a> to avoid a name conflict with the Qt framework. Also, for consistency, renamed the file qevent.h to qevt.h and the macro Q_EVENT_CAST() to <a class="el" href="qep_8hpp.html#a9f117cb1bc50e9ef4dcc933533ccdd7f" title="Perform downcast of an event onto a subclass of QEvt class_.">Q_EVT_CAST()</a>.</li>
</ol>
<p>NOTE: To minimize impact of this change on the existing <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> ports and applications, the name QEvent is provided as well, but this can be suppressed by defining the configuration macro Q_NQEVENT in qep_port.h.</p>
<ol type="1">
<li>Changed the design of QF::tick() (file qf_tick.cpp) to better support calling this function from low-priority tasks (as opposed to interrupts and highest-priority tasks), which often happens when <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> is executed on the desktop operating systems. In this design only QF::tick() can remove time events from the active linked list, so no unexpected changes to the list structure are eliminated</li>
<li>Simplified the <a class="el" href="class_q_p_1_1_q_time_evt.html" title="Time Event class.">QTimeEvt</a> class by removing the m_prev link pointer, as the new design no longer needs a bi-directional list. These changes impact the files: qte_*.cpp.</li>
<li>Added return value to <a class="el" href="class_q_p_1_1_q_f.html#a55052cc4c69d89ac25491bd744b3f5cc" title="Transfers control to QF to run the application.">QF::run()</a> to allow transfer of the exit status to the destop operating systems.</li>
</ol>
<p>NOTE: This modification haves impact on most QP/C++ ports, because the <a class="el" href="class_q_p_1_1_q_f.html#a55052cc4c69d89ac25491bd744b3f5cc" title="Transfers control to QF to run the application.">QF::run()</a> function must now return a int16_t value.</p>
<ol type="1">
<li>Eliminated the m_running member of the <a class="el" href="class_q_p_1_1_q_active.html" title="QActive active object (based on QP::QHsm implementation)">QActive</a> class, which has been used only in the <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> ports to "big" OSes such as Linux or Windows.</li>
<li>Added member m_temp to the <a class="el" href="class_q_p_1_1_q_hsm.html" title="Hierarchical State Machine base class.">QHsm</a> and QFsm base classes to prevent clobbering the current state (the m_state member) during transitons. This change allows keeping the current state unchanged during the entire transition chain, which in turn allows easy and generic access to the state information to store the state history in the exit actions from states. Additional bonus of this re-design is the opportunity of testing for stable state configuration in assertions added to the qhsm_*.cpp and qfsm_*.cpp files.</li>
<li>Added the <a class="el" href="class_q_p_1_1_q_hsm.html#ac46d83d0f84d0a808ab653235b3e8ec1" title="Obtain the current state (state handler function)">QHsm::state()</a> and QFsm::state() accessor methods.</li>
<li>Modified the "Transition to History" pattern implementation to use the simplified technique of obtaining the current state in the exit action from the superstate rather than all the exit actions from the substates. Modified the "State-Local Storage" (SLS) pattern as well, because it was using the transition to history constructs.</li>
<li>Re-designed the implementation of the QSPY host application, so that it can be convenienty included as part of the <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> library. This allows direct <a class="el" href="class_q_p_1_1_q_s.html" title="QS logging facilities.">QS</a> tracing output to the screen for <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> applications running on the desktop.</li>
</ol>
<p>NOTE: This change is part of the Qtools release 4.5.00.</p>
<ol type="1">
<li>Modified the <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> ports to Win32_1t (both the MinGW and VC2008) to output <a class="el" href="class_q_p_1_1_q_s.html" title="QS logging facilities.">QS</a> trace data directly to the stdout via the QSPY host-application interface. Modified the DPP examples for Win32_1T to demonstrate the direct <a class="el" href="class_q_p_1_1_q_s.html" title="QS logging facilities.">QS</a> output to the screen.</li>
<li>Added <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> port to Qt_1t (Qt with one thread) and two example applications (DPP and PELICAN crossing).</li>
<li>Added GNU compiler option -pthread to <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> ports for POSIX with P-threads, including <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> ports and examples for Linux and Mac OS X.</li>
</ol>
<h1><a class="anchor" id="qpcpp_4_4_00"></a>
Version 4.4.00, 2012-05-02</h1>
<p>The main pupose of this relase is MISRA-C++:2008 compliance, strong-type checking compliance, update of PC-Lint option files and tests, and general cleanup.</p>
<ol type="1">
<li>Moved the qp_port.h header file from the port directories to the qcppp/include/ directory. Also, moved the inclusion of the <a class="el" href="class_q_p_1_1_q_s.html" title="QS logging facilities.">QS</a> (Spy) header files (<a class="el" href="qs__port_8h.html" title="QS/C port to a 32-bit CPU and a generic C compiler.">qs_port.h</a>/qs_dummy.h) from qep.h, qf.h, and qk.h headers to qp_port.h. These structural changes were made to reduce the number of preprocessor #if nesting levels below 8, which is the ANSI-C limit. This was done to comply with the MISRA-C rule 1.1 (all code shall conform to ANSI/ISO C).</li>
</ol>
<p>NOTE: This modifications have impact on most QP/C++ ports, because the qp_port.h header file must be removed from the port.</p>
<ol type="1">
<li>Enabled the <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> namespace in most QP/C++ ports (except the DOS ports with the Open Watcom compiler). This modification was needed for MISRA-C++:2008 compliance with the rule 7-3-1.</li>
</ol>
<p>NOTE: This modifications have impact on most QP/C++ ports, because all <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> elements require now using the <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a>:: prefix. However, this prefix can be dropped when the application applies the "using namespace QP" directive. (The "using" directive deviates from MISRA-C++:2008 rule 7-3-4, so it is not used in the MISRA-compliant examples. However, a number of <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> ports applies the "using" directive for backwards compatibilty.)</p>
<ol type="1">
<li>Added the PC-Lint option files <a class="el" href="std_8lnt.html" title="PC-Lint-Plus standard option file.">std.lnt</a> and lib-qpcpp.lnt to the qcppp/include/ directory.</li>
<li>Cleaned the whole QP/C code from lint comments. All PC-Lint options have been moved to PC-Lint option files.</li>
<li>Modified <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> assertion macro <a class="el" href="qassert_8h.html#a302498d7d57ae4196cb0745ac65959ae" title="Define the user-specified module name for assertions in this file.">Q_DEFINE_THIS_MODULE()</a> to avoid using the # operator (MISRA rule 16-3-2). This macro now requires the argument enclosed in doble quotes "".</li>
</ol>
<p>NOTE: This modification has impact on some QP/C++ ports.</p>
<ol type="1">
<li>Added typedefs for char_t, int_t, float32_t, and float64_t to event.h header file for compliance with MISRA-C++:2008 rules 3-9-2.</li>
<li>Added macros <a class="el" href="qep_8hpp.html#a6531b0ab582f41275f19d28ac91d9e4f" title="Macro to perform casting to QStateHandler.">Q_STATE_CAST()</a> and Q_EVENT_CAST() to qep.h to encapsulate deviation from MISRA-C++:2008 rule 5-2-7.</li>
<li>Added macro <a class="el" href="qep_8hpp.html#ad28acca1ff94561bd0f1dbc5f2532d49" title="Perform cast from unsigned integer uint_ to pointer of type type_.">Q_UINT2PTR_CAST()</a> to encapsulate casting unsigned integers to pointers, which deviates from MISRA-C++:2008 rules 5-2-7 and 5-2-8. This macro has been added for <em>application-level</em> code.</li>
<li>Updated ARM Cortex-M examples with the latest CMSIS v3.0, which complies with more MISRA-C:2004 rules.</li>
<li>Added DPP examples for MISRA-C++:2008 compliant applications (for IAR-ARM and GNU-ARM).</li>
<li>Updated ARM-Cortex-M3 port with GNU to the latest Sourcery CodeBench 2011.09-60.</li>
<li>Added QP/C++ port to Win32-1t and examples (Windows with 1 thread). This port is useful for testing embedded QP/C++ applications on windows.</li>
<li>Added documentation to QP/C++ distribution in the directory qpcpp/doc/, with the following Application notes: "MISRA-C++:2008 Compliance Matrix", "Quantum Leaps Coding Standard", "QP and ARM Cortex-M, and QP and Windows",</li>
</ol>
<h1><a class="anchor" id="qpcpp_4_3_00"></a>
Version 4.3.00, 2011-11-03</h1>
<ol type="1">
<li>This release changes the names of critical section macros and introduces macros for unconditional interrupt disabling/enabling. This is done to simplify and speed up the built-in Vanilla and <a class="el" href="class_q_p_1_1_q_k.html" title="QK services.">QK</a> kernels, which no longer are dependent on the interrupt locking policy.</li>
</ol>
<p>NOTE: The change in handling the critical section in the Vanilla and <a class="el" href="class_q_p_1_1_q_k.html" title="QK services.">QK</a> kernels can break <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> ports, which use the "save and restore
interrupt lock" policy, because all such ports must also define unconditional interrupt disabling and enabling.</p>
<ol type="1">
<li>This release changes the partitioning of the <a class="el" href="class_q_p_1_1_q_k.html" title="QK services.">QK</a> scheduler. Specifically, the <a class="el" href="class_q_p_1_1_q_k.html" title="QK services.">QK</a> scheduler is now divided between two functions QK_schedPrio_() and <a class="el" href="qk_8hpp.html#afe93da1e870c6b1c749d69b01847e85e" title="QK scheduler finds the highest-priority thread ready to run.">QK_sched_()</a>, to calculate the highest-priority task ready to run and to perform scheduling, respectively. The function QK_schedPrio_() is useful to determine if scheduling is even necessary.</li>
<li>Updated all <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> ports to comply with the new critical section names and policies.</li>
<li>Modified the ARM Cortex-M port qk_port.s to take advantage of the new structure of the <a class="el" href="class_q_p_1_1_q_k.html" title="QK services.">QK</a> scheduler.</li>
<li>Upgraded the examples for ARM Cortex with IAR EWARM to the latest IAR EWARM version 6.30.</li>
<li>Upgraded the examples for ARM Cortex with GNU (CodeSourcery) to the latest Sourcery CodeBench 2011.07-60.</li>
</ol>
<h1><a class="anchor" id="qpcpp_4_2_04"></a>
Version 4.2.04, 2011-09-24</h1>
<p>The main pupose of this relase is to provide a bug fix for the <a class="el" href="class_q_p_1_1_q_k.html" title="QK services.">QK</a> port to ARM Cortex processors. The bug fix addresses a very rare and undocumented behavior of late-arrival of an interrupt while entering the PendSV exception. In this case the PENDSVSET bit in the NVIC-ICSR register is <em>not</em> cleared when finally PendSV is entered, so the PendSV exception is entered in a <em>different</em> state when it is entered via the late-arrival mechanism versus the normal activation of the exception through tail-chaining. The consequence of this undocumented and inconsistent hardware behavior, PendSV could be re-entered again before the SVCall exception cleans up the stack. The bug fix is implemented in the qk_port.s file and consists of clearing the PENDSVSET bit programmatically inside PendSV_Handler.</p>
<h1><a class="anchor" id="qpcpp_4_2_02"></a>
Version 4.2.02, 2011-09-08</h1>
<ol type="1">
<li>The main pupose of this relase is to repackage the default QP/C++ distribution to contain the single root directory qpcpp/ in the archive. That way, unziping the archive will produce only one directory (qpcpp/), which can be then changed by the user.</li>
<li>This release also changes the ARM Cortex <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> ports with GNU. The suffix "_cs" has been added to all <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> libraries generated by the Code Sourcery toolset (now Mentor Sourcery CodeBench). This is to distinguish libraries generated by different GNU-toolchains (such as CodeRed, Attolic, DevKit ARM, etc.)</li>
</ol>
<h1><a class="anchor" id="qpcpp_4_2_01"></a>
Version 4.2.01, 2011-08-13</h1>
<ol type="1">
<li>Modified file <a class="el" href="qassert_8h.html" title="Customizable and memory-efficient assertions for embedded systems.">qassert.h</a> to add assertion macros <a class="el" href="qassert_8h.html#a8808a28cad1ff01daf65ca8ee37de314" title="General purpose assertion with user-specified assertion-id.">Q_ASSERT_ID</a>, <a class="el" href="qassert_8h.html#abacf59f21a2f59dc79ca39bb1ab9c3c0" title="Assertion for checking preconditions with user-specified assertion-id.">Q_REQUIRE_ID</a>, <a class="el" href="qassert_8h.html#aa8639670682ec29addc58801137f1e23" title="Assertion for checking postconditions with user-specified assertion-id.">Q_ENSURE_ID</a>, <a class="el" href="qassert_8h.html#aece62bcb3b8dbc7f070fb32a8b5ae184" title="Assertion for checking invariants with user-specified assertion-id.">Q_INVARIANT_ID</a>, and <a class="el" href="qassert_8h.html#ae16bddd04e54835e5bf8cbbb0ae90d30" title="Assertion with user-specified assertion-id for a wrong path.">Q_ERROR_ID</a>, which are better suited for unit testig, because they avoid the volatility of line numbers for indentifying assertions.</li>
<li>Added <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> port and examples for Mac OS X on 80x86.</li>
</ol>
<h1><a class="anchor" id="qpcpp_4_2_00"></a>
Version 4.2.00, 2011-07-15</h1>
<p>The goal of this milestone release is to extend the number of event pools (theoretically up to 255 pools) instead of just three event pools available up til now. This release adds an option to use constructors/destructors and virtual functions in subclasses of QEvent. Also, this release adds an option to wrap the whole <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> framework in the <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> namespace to avoid name conflicts with other libraries and to improve <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> compliance with MISRA C++ 2008. This release adds also several improvements to the QS/QSPY software tracing, such as adding sender information to event posting so that sequence diagrams could be easily and automatically reconstructed from tracing data. Also, the tracing now supports 64-bit targets, such as embedded Linux 64-bit. Finally, this milestone release migrates the examples to use the environment variable QPCPP instead of relying on the relative path to the QP/C++ framework. This allows easier adaptation of the examples for real projects, which don't really belong to the examples directory.</p>
<p>The changes in detail are:</p>
<ol type="1">
<li>Changed the QEvent base class (file qevent.h). The private member 'dynamic_' has been replaced by two members 'poolId_' and 'refCtr_'.</li>
<li>Added conditionally-compiled constructor and virtual destructor to the QEvent base class (file qevent.h). Also added the inclusion of the &lt;new&gt; header file for placement new if the constructor/ destructor option is configured.</li>
<li>Added new version of the macro <a class="el" href="qf_8hpp.html#abd823f3a9e8b3206a3460a108d5fa3e3" title="Allocate a dynamic event.">Q_NEW()</a> with variable number of paramters, which invokes the event constructor (via placement new) with any parameters requried by the event constructor (file qf.h).</li>
<li>Added explicit call to the event destructor in <a class="el" href="class_q_p_1_1_q_f.html#a7d5f70fa40bdb5a9ed3524c5309be685" title="Recycle a dynamic event.">QF::gc()</a> (file qf_gc.cpp).</li>
<li>Added configuration macro QF_MAX_EPOOL (file qf.h) to define the maximum number of event pools in the <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> application (default to 3). The maximum theoretical number of this macro is 255.</li>
<li>Made algorithmic changes in the <a class="el" href="class_q_p_1_1_q_f.html" title="QF services.">QF</a> source code related to the change of storing the event pool-IDs and reference counters inside QEvent.</li>
<li>Changed the default signal size (macro Q_SIGNAL_SIZE in the file qevent.h) from 1 to 2 bytes.</li>
<li>Changed the signature of <a class="el" href="class_q_p_1_1_q_active.html#aa436248a33030f8d4cc68591a2bfae98" title="Recall a deferred event from a given event queue.">QActive::recall()</a> to return uint8_t instead of QEvent*, which this could encourage incorrect usage (processing of the event at the point of recalling it). Now, the function only returns 1 (TRUE) if the event was recalled and 0 (FALSE) if the event was not recalled.</li>
<li>Added the QTimeEvt() constructor and new source file qte_ctr.cpp. The function returns the counter of a time event, which allows using a time event for measuring the time.</li>
<li>Added new <a class="el" href="class_q_p_1_1_q_f.html" title="QF services.">QF</a> macros #QF_TICK, #QF_PUBLISH, and #QACTIVE_POST in file qf.h to provide sender of the events for software tracing.</li>
<li>Added new <a class="el" href="class_q_p_1_1_q_s.html" title="QS logging facilities.">QS</a> macros (files qs.h and qs_dummy.h) for handling 64-bit integers.</li>
<li>Added the functions QS::u64() and QS::u64_() and new source file qs_u64.cpp.</li>
<li>Added the <a class="el" href="class_q_p_1_1_q_s.html" title="QS logging facilities.">QS</a> macro #QS_U32_HEX_T for hexadecimal formatting of integer numbers in the user-defined trace records.</li>
<li>Added the new port linux64 for 64-bit Linux. Also added the corresponding examples for 64-bit Linux.</li>
<li>Adapted the QSPY host application for 64-bit pointer sizes and the changed layout of trace records that contain event information (such as PoolID and RefCtr). Also added the backwards-compatibility option (-v) for switching the tool to the previous data format.</li>
<li>Removed the tools directory from the QPC distribution and moved the QSPY host application to the QTOOLS distribution, which now also contains the GNU make tools for Windows.</li>
<li>Modified the make files and project files to use the environment variable QPCPP instead of relying on the relative path to the QP/C++ framework.</li>
<li>Upgraded the examples for ARM Cortex with IAR EWARM to the latest IAR EWARM 6.20.</li>
</ol>
<h1><a class="anchor" id="qpcpp_4_1_07"></a>
Version 4.1.07, 2011-02-28</h1>
<p>The goal of this release is to improve the ease of experimenting with QP/C++ on the desktop. This release adds support for Windows (Win32) to the baseline code. Two most popular compilers for Windows are supported: Microsoft Visual Studio and MinGW (GNU). The support for Linux has been improved by including pre-built QP/C++ libraries and improving makefiles for Eclipse compatibility.</p>
<p>The changes in detail are:</p>
<ol type="1">
<li>Added Win32 port with the Visual C++ 2008 (ports/80x86/win32/vc2008). This directory contains the Visual Studio solution all_qp.sln for building all QP/C++ libraries from the IDE. Three build configurations (Debug, Release, and Spy) are supported.</li>
<li>Added Win32 port with the MinGW comiler (ports/80x86/win32/mingw). This directory contains the Makefile for building all QP/C++ libraries. Three build configurations (dbg, rel, and spy) are supported. NOTE: the Makefile assumes that the MinGW/bin directory is added to the PATH.</li>
<li>Added Win32 examples for Visual C++ 2008 (examples/80x86/win32/ vc2008/dpp and examples/80x86/win32/vc2008/qhsmtst). Visual Studio soultions are provides for all build configurations.</li>
<li>Added Win32 examples for MinGW (examples/80x86/win32/mingw/dpp and examples/80x86/win32/mingw/qhsmtst). Eclipse-compatible makefiles are provided for all build configurations. NOTE: the Makefiles assume that the MinGW/bin directory is added to the PATH.</li>
<li>Removed memory alignment correction in the file qmp_init.c. This correction required casting of pointers to integers and was problematic on 64-bit targets (such as 64-bit Linux).</li>
<li>Upgraded the examples for ARM Cortex with CodeSourcery to the latest Sourcery G++ 2011.02-2.</li>
</ol>
<h1><a class="anchor" id="qpcpp_4_1_06"></a>
Version 4.1.06, 2011-01-07</h1>
<ol type="1">
<li>Fixed a bug in the software tracing instrumentation in the function <a class="el" href="class_q_p_1_1_q_f.html#ab6a218983992967bbb96680a5b45136f" title="Remove the active object from the framework.">QF::remove_()</a>, file <a class="el" href="qf__act_8cpp.html" title="QP::QActive services and QF support code.">qf_act.cpp</a>.</li>
<li>Made cosmetic improvements to the example QM models of the "Fly 'n' Shoot" game.</li>
<li>Made improvements in make.bat files for building the examples for DOS/Open Watcom to run better in DosBox on Linux.</li>
<li>Upgraded the examples for ARM Cortex with IAR to the latest IAR EWARM version 6.10.</li>
<li>Upgraded the examples for ARM Cortex with CodeSourcery to the latest Sourcery G++ 2010.09-66.</li>
</ol>
<h1><a class="anchor" id="qpcpp_4_1_05"></a>
Version 4.1.05, 2010-11-01</h1>
<p>This release is adds examples for the QM (<a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> Modeler) graphical modeling and code generation tool. The examples are based on the "Fly 'n' Shoot" game described in the QP/C++ Tutorial and in Chapter 1 of the PSiCC2 book.</p>
<p>Specifically, the directory &lt;qpcpp&gt;/examples/80x86/dos/watcom/l/game-qm/ contains the "Fly 'n' Shoot" game model file "game.qm". This model, when opened in the QM tool contains all state machine diagrams and generates code into the subdirectory qm_code/. This code can then be built and executed on any 80x86 machine (newer versions of Windows or Linux require the DOSbox application, see <a href="http://www.dosbox.com">http://www.dosbox.com</a>).</p>
<p>The directory &lt;qpcpp&gt;/examples/arm-cortex/vanilla/iar/game-ev-lm3s811-qm/ contains the version of the game for the EV-LM3S811 ARM Cortex-M3 board. This directory contains the model file "game.qm", which is actually identical as the model in the DOS version. The LM3S811 version needs to be compiled with the IAR compiler and executed on the EV-LM3S811 board.</p>
<p>Additionally, the QP/C++ baseline code has been slighlty modified for better conformance to the MISRA C++ 2008 rules and the latest PC-Lint 9.x.</p>
<h1><a class="anchor" id="qpcpp_4_1_04"></a>
Version 4.1.04, 2010-05-16</h1>
<p>This release is adds compatibility of all examples for DOS with the DOSBox emulator (<a href="http://www.dosbox.com/">http://www.dosbox.com/</a>) that recreates a MS-DOS compatible environment on all versions of Windows, including 64-bit Windows that don't run 16-bit DOS applications anymore.</p>
<p>Also, this release includes <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> ports and examples for EV-LM3S811 board with the GNU-based Code Sourcery G++ toolset. Support for Sourcery G++ provides a very cost-effective option for developing <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> applications for ARM Cortex MCUs.</p>
<p>Finally, this release improves the Cortex Microcontroller Software Interface Standard (CMSIS) for the whole family of the Stellaris LM3Sxxx MCUs. The improvement extends the CMSIS from Sandstorm to Fury, DustDevil, and Tempest Stellaris families.</p>
<h1><a class="anchor" id="qpcpp_4_1_03"></a>
Version 4.1.03, 2010-01-21</h1>
<p>This release is concerned with the ARM Cortex ports and examples. Specifically, this release contains the following improvements:</p>
<ol type="1">
<li>Unified source code for ARM Cortex-M3 and the new ARM Cortex-M0 cores, including the code for the preemptive <a class="el" href="class_q_p_1_1_q_k.html" title="QK services.">QK</a> kernel.</li>
<li>Compliance with the Cortex Microcontroller Software Interface Standard (CMSIS) in all ARM Cortex examples.</li>
<li>Backward-compatible support for the new LM3S811 EVAL Rev C board with different OLED display than previous revisions. (NOTE: The OSRAM 96x16x1 OLED used in REV A-B boards has been replaced RITEK 96x16x1 OLED used in Rev C.)</li>
</ol>
<p>In the process of making the examples CMSIS-compliant, the dependency on the Luminary Micro driver library (driverlib.a) has been completely removed.</p>
<p>Additionally, the screen saver of the "Fly 'n' Shoot" game has been improved to periodically switch off the power of the OLED display, which better protects the display from burn-in. The affected file is tunnel.cpp.</p>
<p>Finally, this release introduces the QP_VERSION macro, which identifies the <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> version. Otherwise, this maintenance release does not change the QP/C API in any way, so the release has NO IMPACT on the QP/C applications except for the ARM Cortex ports and applications.</p>
<h1><a class="anchor" id="qpcpp_4_1_02"></a>
Version 4.1.02, 2010-01-14</h1>
<p>The purpose of this minor maintenance release is the change in the directory structure for the ARM Cortex ports and examples. As new ARM Cortex cores are becoming available, the old port name "cortex-m3" could be misleading, because it actually applies to wider range of ARM Cortex cores. Consequently, all ARM Cortex ports and examples are hosted in the directory tree called "arm-cortex".</p>
<p>This maintenance release does not change the QP/C++ API in any way, so the release has NO IMPACT on the QP/C++ applications except for the ARM Cortex ports.</p>
<h1><a class="anchor" id="qpcpp_4_1_01"></a>
Version 4.1.01, 2009-11-05</h1>
<p>The main purpose of this release is to replace the Turbo C++ 1.01 toolset with the Open Watcom C/C++ toolset, because Turbo C++ 1.01 is no longer available for a free download. In contrast, Open Watcom is distributed under an OSI-certified open source license, which permits free commercial and non-commercial use. Open Watcom can be downloaded from www.openwatcom.org.</p>
<p>All 80x86/DOS and 80x86/qk ports and examples for Turbo C++ 1.01 have been replaced with ports and examples for Open Watcom. The make.bat scripts are provided to build the QP/C++ libraries and examples.</p>
<p>In the process of converting the examples to Open Watcom two new examples have been added to the standard QP/C++ distribution. The Calc2 example located in &lt;qpcpp&gt;/examples/80x86/dos/watcom/l/calc2 shows how to derive state machine classes with <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> 4.x. The SLS example located in &lt;qpcpp&gt;/examples/80x86/dos/watcom/l/sls shows the implemenation of the new State-Local Storage state design pattern.</p>
<h1><a class="anchor" id="qpcpp_4_1_00"></a>
Version 4.1.00, 2009-10-09</h1>
<p>The release provides brings a number of improvements to QP/C++ and updates the QP/C++ ARM Cortex-M3 examples for the EK-LM3S811 board to the latest IAR EWARM 5.40. Due to the acquisition of Liminary Micro by Texas Instruments the directory IAR structure for the examples and drivers has changed and the <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> examples had to be changed accordingly.</p>
<p>This maintenance release does not change the QP/C++ API in any way, so the release has NO IMPACT on the QP/C++ applications.</p>
<p>The main changes in <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> v4.1.00 with respect to earlier versions are as follows:</p>
<ul>
<li>in qs.h added a new trace record QS_QEP_DISPATCH logged when an event is dispatched to a state machine. This timestamped trace record marks the beginning of an RTC step. The end of the RTC step is marked by the existing timestamped trace records QS_QEP_INTERN_TRAN, QS_QEP_INIT_TRAN, and QS_QEP_IGNORED, depending on how the event is handled. The new QS_QEP_DISPATCH record facilitates measurement of the RTC step lengths.</li>
<li>in qhsm_dis.cpp added generation of the QS_QEP_DISPATCH trace record.</li>
<li>in the tools/qspy/ sub-directory added output of the new trace record to the Q-SPY host application.</li>
<li>in the tools/qspy/matlab/ sub-directory added processing of the new trace record to the qspy.m script.</li>
<li>in qpset.h changed the implementation of the Priority Set. In particular, the QPSet64 now derives from QPSet8, which enables a common way of testing for non-empty set (e.g., useful in assembly). Also, the findMax() functions in QPSet8 and QPSet64 now can work with an empty set, in which case they return 0.</li>
<li>in qk_sched.cpp simplified the QK_schedule_() function to skip the testing of the ready-set for non-empty condition. Such test is no longer necessary. The test can still be performed outside the QK_schedule_() function (e.g., in assembly) to avoid calling the scheduler if the ready set is empty.</li>
<li>in qk_ext.cpp simplified the QK_scheduleExt_() function in the same way as QK_schedule_().</li>
<li>modified make.bat files for building <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> libraries in the ports/ directory to use the externally defined environment variables for the location of the toolchains. The defaults are applied only when the environment variable is not defined. This enables greater flexibility in installing the development tools in different directories than those chosen by Quantum Leaps.</li>
<li>modified the ARM Cortex-M3 examples for the new IAR EWARM 5.40.</li>
<li>modified slighlty the Calculator example to allow extensibility.</li>
<li>in the ARM Cortex-M3 port file qk_port.s added explicit testing of the QK_readySet_ set for empty condition. This test allows avoiding calling the <a class="el" href="class_q_p_1_1_q_k.html" title="QK services.">QK</a> scheduler and two contex-switches if the ready-set is empty.</li>
<li>in the game example moved setting up the <a class="el" href="class_q_p_1_1_q_s.html" title="QS logging facilities.">QS</a> filters from main.cpp to bsp.cpp.</li>
</ul>
<h1><a class="anchor" id="qpcpp_4_0_04"></a>
Version 4.0.04 (Product) Apr 09, 2009</h1>
<p>The maintenance release introduces the virtual destructor in the <a class="el" href="class_q_p_1_1_q_hsm.html" title="Hierarchical State Machine base class.">QHsm</a> and QFsm base classes. This is done to allow proper handling of virtual functions in the subclasses of <a class="el" href="class_q_p_1_1_q_hsm.html" title="Hierarchical State Machine base class.">QHsm</a> or QFsm. Please note, however, that the change increases the size of every state machine object by the additional (hidden) virtual pointer (vptr).</p>
<p>Also, this release provides a fix for the compile-time assertions, which did not work correctly for the GNU compiler family.</p>
<p>Finally, the ARM Cortex-M3 examples have been recompiled with the newer IAR EWARM v5.30.</p>
<p>This maintenance release does not change the QP/C++ API in any way, so the release has NO IMPACT on the QP/C++ applications.</p>
<p>The main changes in <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> v4.0.04 with respect to earlier version are as follows:</p>
<ul>
<li>in qep.h file, virtual destructors have been added to QFsm and <a class="el" href="class_q_p_1_1_q_hsm.html" title="Hierarchical State Machine base class.">QHsm</a>.</li>
<li>in <a class="el" href="qassert_8h.html" title="Customizable and memory-efficient assertions for embedded systems.">qassert.h</a> file the <a class="el" href="qassert_8h.html#a17f551ed8492f013d533f27353c091a3">Q_ASSERT_COMPILE</a> macro has been modified to render a negative array dimension when the asserted condition is not TRUE.</li>
</ul>
<h1><a class="anchor" id="qpcpp_4_0_03"></a>
Version 4.0.03, 2008-12-27</h1>
<p>The main purpose of this release is to fix a bug in the <a class="el" href="class_q_p_1_1_q_k.html" title="QK services.">QK</a> preemptive kernel, which occurs only when the advanced <a class="el" href="class_q_p_1_1_q_k.html" title="QK services.">QK</a> features are used. Specifically, the <a class="el" href="class_q_p_1_1_q_k.html" title="QK services.">QK</a> priority-ceiling mutex could interfere with <a class="el" href="class_q_p_1_1_q_k.html" title="QK services.">QK</a> thread-local storage (TLS) or <a class="el" href="class_q_p_1_1_q_k.html" title="QK services.">QK</a> extended context switch. When the <a class="el" href="class_q_p_1_1_q_k.html" title="QK services.">QK</a> mutex is in use, the TLS or the extended context for this task could get saved to an incorrect priority level.</p>
<p>The release 4.0.03 fixes the bug by strictly preserving the semantics of QK_currPrio_ variable. The mutex locking now uses a different variable QK_ceilingPrio_, which represents the ceiling-priority locked by the mutex. The <a class="el" href="class_q_p_1_1_q_k.html" title="QK services.">QK</a> scheduler and extended scheduler now perform an additional check to make sure that only tasks with priorities above the ceiling can run. To avoid that additional overhead, the user can define the macro QK_NO_MUTEX, which eliminates the <a class="el" href="class_q_p_1_1_q_k.html" title="QK services.">QK</a> mutex API and eliminates the additional tests in the <a class="el" href="class_q_p_1_1_q_k.html" title="QK services.">QK</a> schedulers.</p>
<p>This maintenance release does not change the QP/C++ API in any way, so the release has NO IMPACT on the QP/C++ applications.</p>
<p>The main changes in <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> v4.0.03 with respect to earlier version are as follows:</p>
<ul>
<li>in qk.h file, made the <a class="el" href="class_q_p_1_1_q_k.html" title="QK services.">QK</a> mutex API only visible when the macro QK_NO_MUTEX is <em>not</em> defined.</li>
<li>in qk_pkg.h file, added the QK_ceilingPrio_ external declaration when the macro QK_NO_MUTEX is not defined.</li>
<li>in qk_mutex.cpp file, changed priority-ceiling mutex implementation to use the QK_ceilingPrio_ instead of QK_currPrio_. Also, added compiler error when the macro QK_NO_MUTEX is definedthis and this file is included in the build.</li>
<li>in qk_sched.cpp file added testing priority against the QK_ceilingPrio_, when the macro QK_NO_MUTEX is not defined.</li>
<li>in qk_ext.cpp file added testing priority against the QK_ceilingPrio_, when the macro QK_NO_MUTEX is not defined.</li>
</ul>
<h1><a class="anchor" id="qpcpp_4_0_02"></a>
Version 4.0.02, 2008-11-15</h1>
<p>This maintenance release does not change the QP/C API in any way, so the release has NO IMPACT on the QP/C++ applications.</p>
<p>The main changes in <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> v4.0.02 with respect to earlier version are as follows:</p>
<ul>
<li>in qep.h file, added comments to macros <a class="el" href="qpcpp_8hpp.html#a8f06cd90ba5060780fc61a4810e3eb50">Q_TRAN()</a> and <a class="el" href="qpcpp_8hpp.html#a7a348bc187076a0e9cdb7fc780c3831e">Q_SUPER()</a> to suppress the PC-lint warining about using the comma-operator (MISRA rule 42).</li>
<li>in qhsm_in.cpp file, fixed a bug in the <a class="el" href="class_q_p_1_1_q_hsm.html#ad723869e5257b9977d917593a38bdf56" title="Tests if a given state is part of the current active state configuration.">QHsm::isIn()</a> function. - fixed a bug in tunnel.cpp file ("Fly 'n' Shoot" game). The constant event HIT_WALL was not declared static.</li>
</ul>
<h1><a class="anchor" id="qpcpp_4_0_01"></a>
Version 4.0.01, 2008-06-09</h1>
<p>This maintenace release is made to allow using <a class="el" href="class_q_p_1_1_q_s.html" title="QS logging facilities.">QS</a> software tracing with the GNU compiler for AVR (WinAVR). Specifically, the output of the strings residing in ROM has been fixed.</p>
<p>This maintenance release does not change the QP/C++ API in any way, so the release has NO IMPACT on the QP/C++ applications.</p>
<p>The main changes in <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> v4.0.01 with respect to earlier version are as follows:</p>
<ul>
<li>in qs_.cpp file, updated the function QS::str_ROM_().</li>
<li>in qs_str.cpp file, updated the function QS::str_ROM().</li>
<li>in qvanilla.cpp file, funciton <a class="el" href="class_q_p_1_1_q_f.html#a55052cc4c69d89ac25491bd744b3f5cc" title="Transfers control to QF to run the application.">QF::run()</a>, declared the temporary variables as static to save stack space, because <a class="el" href="class_q_p_1_1_q_f.html#a55052cc4c69d89ac25491bd744b3f5cc" title="Transfers control to QF to run the application.">QF::run()</a> never returns and is not reentrant.</li>
</ul>
<h1><a class="anchor" id="qpcpp_4_0_00"></a>
Version 4.0.00, 2008-04-07</h1>
<p>This milestone release is made for the book /ref PSiCC2. The book describes in great detail this new release. The older "QP Programmer's Manual" is now phased out and is replaced with this hyper-linked /ref main_page "QP/C++ Reference Manual", which provides very detailed, easily searchable reference to the software. The book /ref PSiCC2 provies in-depth discussion of the relevant concepts as well as the design study of <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> v4.0.</p>
<p>The main changes in <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> v4.0 with respect to earlier versions are as follows:</p>
<ul>
<li>the coding techniques for hierarchical state machines (HSMs) and the simpler finite state machines (FSMs) have changed. While the changes are quite simple, the backward compatibility with <a class="el" href="class_q_p_1_1_q_e_p.html" title="Provides miscellaneous QEP services.">QEP</a> 3.x has been broken, meaning that some manual changes to the state machines implemented with earlier versions are necessary. Please refer to the "QP/C++ Tutorial" Section /ref coding_hsm for more information about coding state machines with <a class="el" href="class_q_p_1_1_q_e_p.html" title="Provides miscellaneous QEP services.">QEP</a> 4.x.<ul>
<li>The main change is the signature of a state-handler function, which now returns simply a byte. This return type (typedef'ed as QState) is the status of the event-handling that the state handler conveys to the <a class="el" href="class_q_p_1_1_q_e_p.html" title="Provides miscellaneous QEP services.">QEP</a> event processor.</li>
<li>The macro <a class="el" href="qpcpp_8hpp.html#a8f06cd90ba5060780fc61a4810e3eb50">Q_TRAN()</a> must now always follow the return statement.</li>
<li>The new macro <a class="el" href="qpcpp_8hpp.html#a7a348bc187076a0e9cdb7fc780c3831e">Q_SUPER()</a> designates the superstate of the given state. Again, this macro must follow the return statement.</li>
<li>Then two new macros <a class="el" href="qep_8hpp.html#a54b2da5e70ef983cfa7ca74deac237a3" title="Macro to specify that the event was handled.">Q_HANDLED()</a> and #Q_IGNORED() have been added to return the status of event handled and event ignored, respectively.</li>
</ul>
</li>
<li>all callback functions are now consistently called /c XXX_onYYY() or /c XXX::onYYY():<ul>
<li>Q_assert_handler() is now <a class="el" href="qassert_8h.html#a641001e43708d975152996c9229a7afc" title="Callback function invoked in case of any assertion failure.">Q_onAssert()</a></li>
<li>QF::start() is now <a class="el" href="class_q_p_1_1_q_f.html#a160bdfe6ab5352827cae176d905ec3aa" title="Startup QF callback.">QF::onStartup()</a></li>
<li>QF::cleanup() is now <a class="el" href="class_q_p_1_1_q_f.html#a30d8a524f6a45b2cf7cc3d476c0a24a9" title="Cleanup QF callback.">QF::onCleanup()</a></li>
</ul>
</li>
<li>the new header file qevent.h has been broken off the qep.h header file. qevent.h contains the QEvent class and other basic facilities used in the whole <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a>. This new file allows easier replacement of the entire <a class="el" href="class_q_p_1_1_q_e_p.html" title="Provides miscellaneous QEP services.">QEP</a> event processor with custom event processors, if you wish do so.</li>
<li>the macro QEP_SIGNAL_SIZE is renamed to <a class="el" href="qep_8hpp.html#afdaa94c40e947b0340b4259eddce3561" title="The size (in bytes) of the signal of an event. Valid values: 1U, 2U, or 4U; default 2U.">Q_SIGNAL_SIZE</a>.</li>
<li>the data type QSTATE is now deprecated. Please use <a class="el" href="namespace_q_p.html#a12b7ba71c9618c6aa0e435ab8607f81f" title="Type returned from state-handler functions.">QP::QState</a>.</li>
<li>the #QF_FSM_ACTIVE macro is now deprecated. Instead, please define #QF_ACTIVE_SUPER_ to the base class of <a class="el" href="class_q_p_1_1_q_active.html" title="QActive active object (based on QP::QHsm implementation)">QP::QActive</a> and #QF_ACTIVE_STATE_ to the data type represented state. By default, these macros are defined to use the <a class="el" href="class_q_p_1_1_q_hsm.html" title="Hierarchical State Machine base class.">QP::QHsm</a> base class from the <a class="el" href="class_q_p_1_1_q_e_p.html" title="Provides miscellaneous QEP services.">QEP</a> hierarchical event processor, but you can replace the event processor, if you wish.</li>
<li>the internal macro QACTIVE_OSOBJECT_WAIT_() is now <a class="el" href="macros_8hpp.html#ae2426ed9b8543cbbccde98023d7773a7" title="Platform-dependent macro defining how QF should block the calling task when the QF native queue is em...">QACTIVE_EQUEUE_WAIT_()</a>.</li>
<li>the internal macro QACTIVE_OSOBJECT_SIGNAL_() is now <a class="el" href="macros_8hpp.html#ad4ad4a29e36b9ad8e2aff0e7074c2a68" title="Platform-dependent macro defining how QF should signal the active object task that an event has just ...">QACTIVE_EQUEUE_SIGNAL_()</a>.</li>
<li>the internal macro QACTIVE_OSOBJECT_ONIDLE_() is now #QACTIVE_EQUEUE_ONEMPTY_().</li>
<li>the data mebers QActive::m_osObject and QActive::m_thread are now present only if the macros <a class="el" href="qxk_8hpp.html#a7afba9d8bef1f7eab181e7fb3f74eb5e">QF_OS_OBJECT_TYPE</a> and <a class="el" href="qxk_8hpp.html#ae5bd9d2bd80006cdbcd21d2acdb91d86">QF_THREAD_TYPE</a> are defined.</li>
<li>the <a class="el" href="struct_q_p_1_1_q_p_set.html" title="Priority Set of up to 32 elements *â€/.">QP::QPSet</a> class has been renamed to QP::QPSet64.</li>
<li>the QPSet::hasElements() has been renamed QPSet64::notEmpty()</li>
<li>the <a class="el" href="class_q_p_1_1_q_s.html" title="QS logging facilities.">QS</a> software tracing is now better integrated with all <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> components. You no longer need to explicitly include <a class="el" href="qs__port_8h.html" title="QS/C port to a 32-bit CPU and a generic C compiler.">qs_port.h</a>, because it is automatically included when you define the macro <a class="el" href="macros_8hpp.html#a668b5df6d955d0b1c77227192078689b" title="The preprocessor switch to activate the QS software tracing instrumentation in the code.">Q_SPY</a>. Also the file qs_dummy.h is included automatically when the macro <a class="el" href="macros_8hpp.html#a668b5df6d955d0b1c77227192078689b" title="The preprocessor switch to activate the QS software tracing instrumentation in the code.">Q_SPY</a> is <b>not</b> defined.</li>
<li>the new header file qvanilla.h now replaces the file qsched.h.</li>
<li>the macros QF_SCHED_LOCK() and QF_SCHED_UNLOCK() are now obsolete.</li>
<li>the native <a class="el" href="class_q_p_1_1_q_f.html" title="QF services.">QF</a> event queues (both the active object event queues and the "raw" thread-safe queues) are slightly more efficient by counting down the /c head and /c tail pointers rather than up. This leads to wrap-around at zero, which is easier (faster) to test than any other wrap-around point. Also the native <a class="el" href="class_q_p_1_1_q_f.html" title="QF services.">QF</a> event queues maintain the minimum of the free events in the queue rather the maximum of used events.</li>
<li>the data member of QEQueue::nTot class is removed.</li>
<li>the QF::publish() function has been re-written so that <a class="el" href="class_q_p_1_1_q_f.html" title="QF services.">QF</a> no does <b>not need to lock the scheduler</b>. The QF::publish() function posts events to active objects with scheduler unlocked starting from the highest-priority active objects. However, the event is protected from inadvertent recycling by incrementing its reference counter before the publish operation. After the event is posted to all subscribers, the garbage collector <a class="el" href="class_q_p_1_1_q_f.html#a7d5f70fa40bdb5a9ed3524c5309be685" title="Recycle a dynamic event.">QF::gc()</a> is called to decrement the reference counter and recycle the event, if necessary.</li>
<li>the qf_run.cpp file is obsolete. The <a class="el" href="class_q_p_1_1_q_f.html#a55052cc4c69d89ac25491bd744b3f5cc" title="Transfers control to QF to run the application.">QF::run()</a> function for the cooperative "vanilla" kernel is now implemented in the file qvanilla.cpp.</li>
<li>the QF::tick() function has been rewritten to allow calling QF::tick() from the task context as well as from the interrupt context. The nested critical section around QF::tick() is no longer needed when it is called from the task level. Among others, this re-design <b>eliminates the need for the recursive</b> mutex in the POSIX <a class="el" href="class_q_p_1_1_q_f.html" title="QF services.">QF</a> port.</li>
<li>the <a class="el" href="class_q_p_1_1_q_m_pool.html#a5c9795bf9d76d4a6c30c2e341c182dfa" title="Initializes the native QF event pool.">QMPool::init()</a> function has been re-designed to optimally align the memory buffer in a portable and platform-independent way. This should bring some performance improvements on some CPUs (e.g., 80x86).</li>
<li>the extended <a class="el" href="class_q_p_1_1_q_k.html" title="QK services.">QK</a> scheduler has been re-designed to save stack space. The extended context (e.g., coprocessor registers) are no longer saved on the precious stack, but rather in the active object.</li>
<li>a bug has been fixed in handling of Thread-Local Storage (TLS) in the <a class="el" href="class_q_p_1_1_q_k.html" title="QK services.">QK</a> scheduler and extended scheduler.</li>
<li>the -q (quiet) flag has been added to the QSPY host application.</li>
<li>the support for two new compilers for Windows has been added for the QSPY host application. The application can now be build with the MinGW GNU compiler for Windows as well as the Microsoft Visual C++ 2005.</li>
<li>the <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> port to Linux has been improved by eliminating the need for recursive P-Thread mutex.</li>
<li>the <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> port to MicroC/OS-II has been upgraded to the latest version 2.86.</li>
<li>all examples in the standard <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> distribution have been cleaned up and updated to the latest <a class="el" href="namespace_q_p.html" title="namespace associated with the QP/C++ framework">QP</a> API changes.</li>
<li>all examples that use <a class="el" href="class_q_p_1_1_q_f.html" title="QF services.">QF</a> now contain the <a class="el" href="class_q_p_1_1_q_s.html" title="QS logging facilities.">QS</a> software tracing support. </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
    <div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
      <ul>
        <li class="footer">
<a title="Quantum Leaps: Modern Embedded Software" href="https://www.state-machine.com">&copy; 2005-2021 Quantum Leaps</a> &nbsp;| &nbsp; <a title="help" href="help.html">Using Online Help</a>&nbsp;| &nbsp;<a title="Doxygen" href="http://www.doxygen.nl">Generated with Doxygen</a>&nbsp; | &nbsp;<b>QP/C++ 6.9.3</b>
<hr class="footer"/><address class="footer"><small>
<a title="Quantum Leaps: Modern Embedded Software" href="https://www.state-machine.com">&copy; Quantum Leaps 2020</a> &nbsp;| &nbsp; <a title="help" href="help.html">Using Online Help</a>&nbsp;| &nbsp;<a title="Doxygen" href="http://www.doxygen.nl">Generated with Doxygen</a>&nbsp; | &nbsp;<b>QP/C++ 6.9.3</b>
</small></address>
        </li>
      </ul>
    </div>
    <script src="custom.js"></script>
  </body>
</html>
